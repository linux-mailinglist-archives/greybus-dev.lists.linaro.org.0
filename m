Return-Path: <greybus-dev-bounces@lists.linaro.org>
X-Original-To: lists+greybus-dev@lfdr.de
Delivered-To: lists+greybus-dev@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id ACD0C1EB511
	for <lists+greybus-dev@lfdr.de>; Tue,  2 Jun 2020 07:22:43 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id D9F1C618F6
	for <lists+greybus-dev@lfdr.de>; Tue,  2 Jun 2020 05:22:42 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id CD00D6192C; Tue,  2 Jun 2020 05:22:42 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,DKIM_ADSP_CUSTOM_MED,
	FREEMAIL_FROM,MAILING_LIST_MULTI,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H3,
	RCVD_IN_MSPIKE_WL,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 84BCF61945;
	Tue,  2 Jun 2020 05:22:07 +0000 (UTC)
X-Original-To: greybus-dev@lists.linaro.org
Delivered-To: greybus-dev@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id B7BE2618D3
 for <greybus-dev@lists.linaro.org>; Tue,  2 Jun 2020 05:22:00 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id AA99B618DF; Tue,  2 Jun 2020 05:22:00 +0000 (UTC)
Received: from mail-pl1-f193.google.com (mail-pl1-f193.google.com
 [209.85.214.193])
 by lists.linaro.org (Postfix) with ESMTPS id B9A6A618F4
 for <greybus-dev@lists.linaro.org>; Tue,  2 Jun 2020 05:21:58 +0000 (UTC)
Received: by mail-pl1-f193.google.com with SMTP id n9so889544plk.1
 for <greybus-dev@lists.linaro.org>; Mon, 01 Jun 2020 22:21:58 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=6w49s8vASLEohgXCuLWOT610sDy/W13BVCsIn1lkugE=;
 b=b58aCDMLntZ2AVLeC40zzlo1ut5m/rENsXjoFN1uP8z2mdqyZyubjtpJz1Nfexv9DR
 5tSY0G9bQB2LvBcO1XLAZCvYUlV7bHvj/gFyJtGEm3/LMQFA+n6TOBFP/zirPZkYRwEO
 23j7JmdINjCdfnv51MuoLJpkqscOpxZj9iIE2JpwbJa1MrZX4sIwiaj4cqv2ph5SkDjD
 HWjCipnWqb9xsd8r4HckbL2/wMosMwbl+gi9AKmGhRrUl9H5+oxgPmtfPGLcsKLcyA3w
 bHwmeXN4qpsFS+D+8+ZhZbmQHRyX5iFxr0bOadV6vxdCwMGFl5B1Gs4B3Y0A4JZK4bjD
 odLQ==
X-Gm-Message-State: AOAM530GQ6slXajfZufhkRM567c+xGR0PqziA5iCQXXScC8baq5Hatn/
 HOpKVGCUmmhEGu4Dx63NimA=
X-Google-Smtp-Source: ABdhPJxbspGz7qP61diRakcvcAkIj5uoqUpw3niU51tUCw17/TaHluyeihPQsMQrg+wSJwzWsqeBBA==
X-Received: by 2002:a17:90a:32ee:: with SMTP id
 l101mr3561025pjb.213.1591075317759; 
 Mon, 01 Jun 2020 22:21:57 -0700 (PDT)
Received: from cvds-vagarw7.iind.intel.com ([192.55.55.41])
 by smtp.googlemail.com with ESMTPSA id f18sm1004764pga.75.2020.06.01.22.21.47
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Mon, 01 Jun 2020 22:21:57 -0700 (PDT)
From: Vaibhav Agarwal <vaibhav.sr@gmail.com>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Alex Elder <elder@kernel.org>, Johan Hovold <johan@kernel.org>,
 Mark Greer <mgreer@animalcreek.com>, Takashi Iwai <tiwai@suse.com>,
 Jaroslav Kysela <perex@perex.cz>, Mark Brown <broonie@kernel.org>,
 Liam Girdwood <lgirdwood@gmail.com>
Date: Tue,  2 Jun 2020 10:51:11 +0530
Message-Id: <ccb39352a30ab39df1534efafc9415aa89b156fa.1591040859.git.vaibhav.sr@gmail.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <cover.1591040859.git.vaibhav.sr@gmail.com>
References: <cover.1591040859.git.vaibhav.sr@gmail.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: devel@driverdev.osuosl.org, alsa-devel@alsa-project.org,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 linux-kernel@vger.kernel.org, greybus-dev@lists.linaro.org
Subject: [greybus-dev] [RESEND PATCH v1 2/6] staging: greybus: audio:
	Maintain jack list within GB Audio module
X-BeenThere: greybus-dev@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: Greybus Development Mail List <greybus-dev.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/greybus-dev/>
List-Post: <mailto:greybus-dev@lists.linaro.org>
List-Help: <mailto:greybus-dev-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: greybus-dev-bounces@lists.linaro.org
Sender: "greybus-dev" <greybus-dev-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

QXMgcGVyIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIGZvciBHQiBjb2RlYyBkcml2ZXIsIGEg
amFjayBsaXN0IGlzCm1haW50YWluZWQgZm9yIGVhY2ggbW9kdWxlLiBBbmQgaXQgZXhwZWN0cyB0
aGUgbGlzdCB0byBiZSBwb3B1bGF0ZWQgYnkKdGhlIHNuZF9zb2NfamFjayBzdHJ1Y3R1cmUgd2hp
Y2ggd291bGQgcmVxdWlyZSBtb2RpZmljYXRpb25zIGluCm1haW5zdHJlYW0gY29kZS4KCkhvd2V2
ZXIsIHRoaXMgaXMgbm90IGEgbmVjZXNzYXJ5IHJlcXVpcmVtZW50IGFuZCB0aGUgbGlzdCBjYW4g
YmUgZWFzaWx5Cm1haW50YWluZWQgd2l0aGluIGdiYXVkaW9fbW9kdWxlX2luZm8gYXMgd2VsbC4g
VGhpcyBwYXRjaCBwcm92aWRlcyB0aGUKcmVsZXZhbnQgY2hhbmdlcyBmb3IgdGhlIHNhbWUuCgpT
aWduZWQtb2ZmLWJ5OiBWYWliaGF2IEFnYXJ3YWwgPHZhaWJoYXYuc3JAZ21haWwuY29tPgotLS0K
IGRyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMgIHwgNzYgKysrKysrKysrKysr
KystLS0tLS0tLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmggIHwg
MTAgKysrLQogZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fbW9kdWxlLmMgfCAyMCArKysr
LS0tCiAzIGZpbGVzIGNoYW5nZWQsIDYwIGluc2VydGlvbnMoKyksIDQ2IGRlbGV0aW9ucygtKQoK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMgYi9kcml2
ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5jCmluZGV4IGViZjg0ODRmMGFlNy4uYTJl
ZTU4N2U1YTc5IDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2Rl
Yy5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMKQEAgLTcxMiw3
ICs3MTIsNyBAQCBzdGF0aWMgaW50IGdiYXVkaW9faW5pdF9qYWNrKHN0cnVjdCBnYmF1ZGlvX21v
ZHVsZV9pbmZvICptb2R1bGUsCiAJCQkgICAgIHN0cnVjdCBzbmRfc29jX2NhcmQgKmNhcmQpCiB7
CiAJaW50IHJldDsKLQorCXN0cnVjdCBnYmF1ZGlvX2phY2sgKmdiYV9qYWNrLCAqbjsKIAlzdHJ1
Y3Qgc25kX3NvY19qYWNrICpqYWNrOwogCXN0cnVjdCBzbmRfc29jX2phY2tfcGluICpoZWFkc2V0
LCAqYnV0dG9uOwogCkBAIC03MjgsNyArNzI4LDggQEAgc3RhdGljIGludCBnYmF1ZGlvX2luaXRf
amFjayhzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlLAogCiAJaGVhZHNldC0+cGlu
ID0gbW9kdWxlLT5qYWNrX25hbWU7CiAJaGVhZHNldC0+bWFzayA9IG1vZHVsZS0+amFja19tYXNr
OwotCWphY2sgPSAmbW9kdWxlLT5oZWFkc2V0X2phY2s7CisJZ2JhX2phY2sgPSAmbW9kdWxlLT5o
ZWFkc2V0OworCWphY2sgPSAmZ2JhX2phY2stPmphY2s7CiAKIAlyZXQgPSBzbmRfc29jX2NhcmRf
amFja19uZXcoY2FyZCwgbW9kdWxlLT5qYWNrX25hbWUsIG1vZHVsZS0+amFja19tYXNrLAogCQkJ
CSAgICBqYWNrLCBoZWFkc2V0LCAxKTsKQEAgLTczNyw2ICs3MzgsOSBAQCBzdGF0aWMgaW50IGdi
YXVkaW9faW5pdF9qYWNrKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUsCiAJCXJl
dHVybiByZXQ7CiAJfQogCisJLyogQWRkIHRvIG1vZHVsZSdzIGphY2sgbGlzdCAqLworCWxpc3Rf
YWRkKCZnYmFfamFjay0+bGlzdCwgJm1vZHVsZS0+amFja19saXN0KTsKKwogCWlmICghbW9kdWxl
LT5idXR0b25fbWFzaykKIAkJcmV0dXJuIDA7CiAKQEAgLTc0NSwyMCArNzQ5LDI0IEBAIHN0YXRp
YyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVs
ZSwKIAlidXR0b24gPSBkZXZtX2t6YWxsb2MobW9kdWxlLT5kZXYsIHNpemVvZigqaGVhZHNldCks
IEdGUF9LRVJORUwpOwogCWlmICghYnV0dG9uKSB7CiAJCXJldCA9IC1FTk9NRU07Ci0JCWdvdG8g
ZnJlZV9oZWFkc2V0OworCQlnb3RvIGZyZWVfamFjazsKIAl9CiAKIAlidXR0b24tPnBpbiA9IG1v
ZHVsZS0+YnV0dG9uX25hbWU7CiAJYnV0dG9uLT5tYXNrID0gbW9kdWxlLT5idXR0b25fbWFzazsK
LQlqYWNrID0gJm1vZHVsZS0+YnV0dG9uX2phY2s7CisJZ2JhX2phY2sgPSAmbW9kdWxlLT5idXR0
b247CisJamFjayA9ICZnYmFfamFjay0+amFjazsKIAogCXJldCA9IHNuZF9zb2NfY2FyZF9qYWNr
X25ldyhjYXJkLCBtb2R1bGUtPmJ1dHRvbl9uYW1lLAogCQkJCSAgICBtb2R1bGUtPmJ1dHRvbl9t
YXNrLCBqYWNrLCBidXR0b24sIDEpOwogCWlmIChyZXQpIHsKIAkJZGV2X2Vycihtb2R1bGUtPmRl
diwgIkZhaWxlZCB0byBjcmVhdGUgYnV0dG9uIGphY2tcbiIpOwotCQlnb3RvIGZyZWVfaGVhZHNl
dDsKKwkJZ290byBmcmVlX2phY2s7CiAJfQogCisJLyogQWRkIHRvIG1vZHVsZSdzIGphY2sgbGlz
dCAqLworCWxpc3RfYWRkKCZnYmFfamFjay0+bGlzdCwgJm1vZHVsZS0+amFja19saXN0KTsKKwog
CS8qCiAJICogQ3VycmVudGx5LCBtYXggNCBidXR0b25zIGFyZSBzdXBwb3J0ZWQgd2l0aCBmb2xs
b3dpbmcga2V5IG1hcHBpbmcKIAkgKiBCVE5fMCA9IEtFWV9NRURJQQpAQCAtNzY4LDU4ICs3NzYs
NTUgQEAgc3RhdGljIGludCBnYmF1ZGlvX2luaXRfamFjayhzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVf
aW5mbyAqbW9kdWxlLAogCSAqLwogCiAJaWYgKG1vZHVsZS0+YnV0dG9uX21hc2sgJiBTTkRfSkFD
S19CVE5fMCkgewotCQlyZXQgPSBzbmRfamFja19zZXRfa2V5KG1vZHVsZS0+YnV0dG9uX2phY2su
amFjaywgU05EX0pBQ0tfQlROXzAsCisJCXJldCA9IHNuZF9qYWNrX3NldF9rZXkoamFjay0+amFj
aywgU05EX0pBQ0tfQlROXzAsCiAJCQkJICAgICAgIEtFWV9NRURJQSk7CiAJCWlmIChyZXQpIHsK
IAkJCWRldl9lcnIobW9kdWxlLT5kZXYsICJGYWlsZWQgdG8gc2V0IEJUTl8wXG4iKTsKLQkJCWdv
dG8gZnJlZV9idXR0b247CisJCQlnb3RvIGZyZWVfamFjazsKIAkJfQogCX0KIAogCWlmIChtb2R1
bGUtPmJ1dHRvbl9tYXNrICYgU05EX0pBQ0tfQlROXzEpIHsKLQkJcmV0ID0gc25kX2phY2tfc2V0
X2tleShtb2R1bGUtPmJ1dHRvbl9qYWNrLmphY2ssIFNORF9KQUNLX0JUTl8xLAorCQlyZXQgPSBz
bmRfamFja19zZXRfa2V5KGphY2stPmphY2ssIFNORF9KQUNLX0JUTl8xLAogCQkJCSAgICAgICBL
RVlfVk9JQ0VDT01NQU5EKTsKIAkJaWYgKHJldCkgewogCQkJZGV2X2Vycihtb2R1bGUtPmRldiwg
IkZhaWxlZCB0byBzZXQgQlROXzFcbiIpOwotCQkJZ290byBmcmVlX2J1dHRvbjsKKwkJCWdvdG8g
ZnJlZV9qYWNrOwogCQl9CiAJfQogCiAJaWYgKG1vZHVsZS0+YnV0dG9uX21hc2sgJiBTTkRfSkFD
S19CVE5fMikgewotCQlyZXQgPSBzbmRfamFja19zZXRfa2V5KG1vZHVsZS0+YnV0dG9uX2phY2su
amFjaywgU05EX0pBQ0tfQlROXzIsCisJCXJldCA9IHNuZF9qYWNrX3NldF9rZXkoamFjay0+amFj
aywgU05EX0pBQ0tfQlROXzIsCiAJCQkJICAgICAgIEtFWV9WT0xVTUVVUCk7CiAJCWlmIChyZXQp
IHsKIAkJCWRldl9lcnIobW9kdWxlLT5kZXYsICJGYWlsZWQgdG8gc2V0IEJUTl8yXG4iKTsKLQkJ
CWdvdG8gZnJlZV9idXR0b247CisJCQlnb3RvIGZyZWVfamFjazsKIAkJfQogCX0KIAogCWlmICht
b2R1bGUtPmJ1dHRvbl9tYXNrICYgU05EX0pBQ0tfQlROXzMpIHsKLQkJcmV0ID0gc25kX2phY2tf
c2V0X2tleShtb2R1bGUtPmJ1dHRvbl9qYWNrLmphY2ssIFNORF9KQUNLX0JUTl8zLAorCQlyZXQg
PSBzbmRfamFja19zZXRfa2V5KGphY2stPmphY2ssIFNORF9KQUNLX0JUTl8zLAogCQkJCSAgICAg
ICBLRVlfVk9MVU1FRE9XTik7CiAJCWlmIChyZXQpIHsKIAkJCWRldl9lcnIobW9kdWxlLT5kZXYs
ICJGYWlsZWQgdG8gc2V0IEJUTl8wXG4iKTsKLQkJCWdvdG8gZnJlZV9idXR0b247CisJCQlnb3Rv
IGZyZWVfamFjazsKIAkJfQogCX0KIAogCS8qIEZJWE1FCiAJICogdmVyaWZ5IGlmIHRoaXMgaXMg
cmVhbGx5IHJlcXVpcmVkCiAJc2V0X2JpdChJTlBVVF9QUk9QX05PX0RVTU1ZX1JFTEVBU0UsCi0J
CW1vZHVsZS0+YnV0dG9uX2phY2suamFjay0+aW5wdXRfZGV2LT5wcm9wYml0KTsKKwkJbW9kdWxl
LT5idXR0b24tPmphY2stPmphY2stPmlucHV0X2Rldi0+cHJvcGJpdCk7CiAJKi8KIAogCXJldHVy
biAwOwogCi1mcmVlX2J1dHRvbjoKLQlqYWNrID0gJm1vZHVsZS0+YnV0dG9uX2phY2s7Ci0Jc25k
X2RldmljZV9mcmVlKGNhcmQtPnNuZF9jYXJkLCBqYWNrLT5qYWNrKTsKLQlsaXN0X2RlbCgmamFj
ay0+bGlzdCk7Ci0KLWZyZWVfaGVhZHNldDoKLQlqYWNrID0gJm1vZHVsZS0+aGVhZHNldF9qYWNr
OwotCXNuZF9kZXZpY2VfZnJlZShjYXJkLT5zbmRfY2FyZCwgamFjay0+amFjayk7Ci0JbGlzdF9k
ZWwoJmphY2stPmxpc3QpOworZnJlZV9qYWNrOgorCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShn
YmFfamFjaywgbiwgJm1vZHVsZS0+amFja19saXN0LCBsaXN0KSB7CisJCWphY2sgPSAmZ2JhX2ph
Y2stPmphY2s7CisJCXNuZF9kZXZpY2VfZnJlZShjYXJkLT5zbmRfY2FyZCwgamFjay0+amFjayk7
CisJCWxpc3RfZGVsKCZnYmFfamFjay0+bGlzdCk7CisJfQogCiAJcmV0dXJuIHJldDsKIH0KQEAg
LTgyOSw2ICs4MzQsNyBAQCBpbnQgZ2JhdWRpb19yZWdpc3Rlcl9tb2R1bGUoc3RydWN0IGdiYXVk
aW9fbW9kdWxlX2luZm8gKm1vZHVsZSkKIAlpbnQgcmV0OwogCXN0cnVjdCBzbmRfc29jX2NvZGVj
ICpjb2RlYzsKIAlzdHJ1Y3Qgc25kX2NhcmQgKmNhcmQ7CisJc3RydWN0IGdiYXVkaW9famFjayAq
Z2JhX2phY2sgPSBOVUxMOwogCXN0cnVjdCBzbmRfc29jX2phY2sgKmphY2sgPSBOVUxMOwogCiAJ
aWYgKCFnYmNvZGVjKSB7CkBAIC04NzQsMTEgKzg4MCwxMCBAQCBpbnQgZ2JhdWRpb19yZWdpc3Rl
cl9tb2R1bGUoc3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSkKIAkJICogcmVnaXN0
ZXIgamFjayBkZXZpY2VzIGZvciB0aGlzIG1vZHVsZQogCQkgKiBmcm9tIGNvZGVjLT5qYWNrX2xp
c3QKIAkJICovCi0JCWxpc3RfZm9yX2VhY2hfZW50cnkoamFjaywgJmNvZGVjLT5qYWNrX2xpc3Qs
IGxpc3QpIHsKLQkJCWlmICgoamFjayA9PSAmbW9kdWxlLT5oZWFkc2V0X2phY2spIHx8Ci0JCQkg
ICAgKGphY2sgPT0gJm1vZHVsZS0+YnV0dG9uX2phY2spKQotCQkJCXNuZF9kZXZpY2VfcmVnaXN0
ZXIoY29kZWMtPmNhcmQtPnNuZF9jYXJkLAotCQkJCQkJICAgIGphY2stPmphY2spOworCQlsaXN0
X2Zvcl9lYWNoX2VudHJ5KGdiYV9qYWNrLCAmbW9kdWxlLT5qYWNrX2xpc3QsIGxpc3QpIHsKKwkJ
CWphY2sgPSAmZ2JhX2phY2stPmphY2s7CisJCQlzbmRfZGV2aWNlX3JlZ2lzdGVyKGNvZGVjLT5j
YXJkLT5zbmRfY2FyZCwKKwkJCQkJICAgIGphY2stPmphY2spOwogCQl9CiAjZW5kaWYKIAl9CkBA
IC05NjIsNyArOTY3LDggQEAgdm9pZCBnYmF1ZGlvX3VucmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBn
YmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUpCiB7CiAJc3RydWN0IHNuZF9zb2NfY29kZWMgKmNv
ZGVjID0gZ2Jjb2RlYy0+Y29kZWM7CiAJc3RydWN0IHNuZF9jYXJkICpjYXJkID0gY29kZWMtPmNh
cmQtPnNuZF9jYXJkOwotCXN0cnVjdCBzbmRfc29jX2phY2sgKmphY2ssICpuZXh0X2o7CisJc3Ry
dWN0IGdiYXVkaW9famFjayAqZ2JhX2phY2ssICpuOworCXN0cnVjdCBzbmRfc29jX2phY2sgKmph
Y2s7CiAJaW50IG1hc2s7CiAKIAlkZXZfZGJnKGNvZGVjLT5kZXYsICJVbnJlZ2lzdGVyICVzIG1v
ZHVsZVxuIiwgbW9kdWxlLT5uYW1lKTsKQEAgLTk3NSwyMSArOTgxLDIxIEBAIHZvaWQgZ2JhdWRp
b191bnJlZ2lzdGVyX21vZHVsZShzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlKQog
CW11dGV4X3VubG9jaygmZ2Jjb2RlYy0+bG9jayk7CiAKICNpZmRlZiBDT05GSUdfU05EX0pBQ0sK
LQkvKiBmcmVlIGphY2sgZGV2aWNlcyBmb3IgdGhpcyBtb2R1bGUgZnJvbSBjb2RlYy0+amFja19s
aXN0ICovCi0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGphY2ssIG5leHRfaiwgJmNvbXBvbmVu
dC0+Y2FyZC0+amFja19saXN0LAotCQkJCSBsaXN0KSB7Ci0JCWlmIChqYWNrID09ICZtb2R1bGUt
PmhlYWRzZXRfamFjaykKKwkvKiBmcmVlIGphY2sgZGV2aWNlcyBmb3IgdGhpcyBtb2R1bGUgamFj
a19saXN0ICovCisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGdiYV9qYWNrLCBuLCAmbW9kdWxl
LT5qYWNrX2xpc3QsIGxpc3QpIHsKKwkJaWYgKGdiYV9qYWNrID09ICZtb2R1bGUtPmhlYWRzZXQp
CiAJCQltYXNrID0gR0JDT0RFQ19KQUNLX01BU0s7Ci0JCWVsc2UgaWYgKGphY2sgPT0gJm1vZHVs
ZS0+YnV0dG9uX2phY2spCisJCWVsc2UgaWYgKGdiYV9qYWNrID09ICZtb2R1bGUtPmJ1dHRvbikK
IAkJCW1hc2sgPSBHQkNPREVDX0pBQ0tfQlVUVE9OX01BU0s7CiAJCWVsc2UKIAkJCW1hc2sgPSAw
OwogCQlpZiAobWFzaykgeworCQkJamFjayA9ICZnYmFfamFjay0+amFjazsKIAkJCWRldl9kYmco
bW9kdWxlLT5kZXYsICJSZXBvcnQgJXMgcmVtb3ZhbFxuIiwKIAkJCQlqYWNrLT5qYWNrLT5pZCk7
CiAJCQlzbmRfc29jX2phY2tfcmVwb3J0KGphY2ssIDAsIG1hc2spOwogCQkJc25kX2RldmljZV9m
cmVlKGNvZGVjLT5jYXJkLT5zbmRfY2FyZCwgamFjay0+amFjayk7Ci0JCQlsaXN0X2RlbCgmamFj
ay0+bGlzdCk7CisJCQlsaXN0X2RlbCgmZ2JhX2phY2stPmxpc3QpOwogCQl9CiAJfQogI2VuZGlm
CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5oIGIvZHJp
dmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuaAppbmRleCBjYjVkMjcxZGExYTUuLmFm
OTE5NWVjZWIzYSAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29k
ZWMuaAorKysgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5oCkBAIC0xMDYs
NiArMTA2LDExIEBAIGVudW0gZ2JhdWRpb19tb2R1bGVfc3RhdGUgewogCUdCQVVESU9fTU9EVUxF
X09OLAogfTsKIAorc3RydWN0IGdiYXVkaW9famFjayB7CisJc3RydWN0IHNuZF9zb2NfamFjayBq
YWNrOworCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsKK307CisKIHN0cnVjdCBnYmF1ZGlvX21vZHVs
ZV9pbmZvIHsKIAkvKiBtb2R1bGUgaW5mbyAqLwogCXN0cnVjdCBkZXZpY2UgKmRldjsKQEAgLTEz
MCw4ICsxMzUsOCBAQCBzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyB7CiAJaW50IGphY2tfbWFz
azsKIAlpbnQgYnV0dG9uX21hc2s7CiAJaW50IGJ1dHRvbl9zdGF0dXM7Ci0Jc3RydWN0IHNuZF9z
b2NfamFjayBoZWFkc2V0X2phY2s7Ci0Jc3RydWN0IHNuZF9zb2NfamFjayBidXR0b25famFjazsK
KwlzdHJ1Y3QgZ2JhdWRpb19qYWNrIGhlYWRzZXQ7CisJc3RydWN0IGdiYXVkaW9famFjayBidXR0
b247CiAKIAkvKiBjb25uZWN0aW9uIGluZm8gKi8KIAlzdHJ1Y3QgZ2JfY29ubmVjdGlvbiAqbWdt
dF9jb25uZWN0aW9uOwpAQCAtMTU1LDYgKzE2MCw3IEBAIHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9p
bmZvIHsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHdpZGdldF9saXN0OwogCXN0cnVjdCBsaXN0X2hlYWQg
Y3RsX2xpc3Q7CiAJc3RydWN0IGxpc3RfaGVhZCB3aWRnZXRfY3RsX2xpc3Q7CisJc3RydWN0IGxp
c3RfaGVhZCBqYWNrX2xpc3Q7CiAKIAlzdHJ1Y3QgZ2JfYXVkaW9fdG9wb2xvZ3kgKnRvcG9sb2d5
OwogfTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX21vZHVsZS5j
IGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fbW9kdWxlLmMKaW5kZXggMzAwYTJiNGYz
ZmM3Li5jZGQ0YjZiZTVlOWMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1
ZGlvX21vZHVsZS5jCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX21vZHVsZS5j
CkBAIC0yMSw4ICsyMSwxMCBAQCBzdGF0aWMgaW50IGdiYXVkaW9fcmVxdWVzdF9qYWNrKHN0cnVj
dCBnYmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUsCiAJCQkJc3RydWN0IGdiX2F1ZGlvX2phY2tf
ZXZlbnRfcmVxdWVzdCAqcmVxKQogewogCWludCByZXBvcnQ7Ci0Jc3RydWN0IHNuZF9qYWNrICpq
YWNrID0gbW9kdWxlLT5oZWFkc2V0X2phY2suamFjazsKLQlzdHJ1Y3Qgc25kX2phY2sgKmJ0bl9q
YWNrID0gbW9kdWxlLT5idXR0b25famFjay5qYWNrOworCXN0cnVjdCBzbmRfc29jX2phY2sgKmhz
ID0gJm1vZHVsZS0+aGVhZHNldC5qYWNrOworCXN0cnVjdCBzbmRfc29jX2phY2sgKmJ0biA9ICZt
b2R1bGUtPmJ1dHRvbi5qYWNrOworCXN0cnVjdCBzbmRfamFjayAqamFjayA9IGhzLT5qYWNrOwor
CXN0cnVjdCBzbmRfamFjayAqYnRuX2phY2sgPSBidG4tPmphY2s7CiAKIAlpZiAoIWphY2spIHsK
IAkJZGV2X2Vycl9yYXRlbGltaXRlZChtb2R1bGUtPmRldiwKQEAgLTM4LDEyICs0MCwxMCBAQCBz
dGF0aWMgaW50IGdiYXVkaW9fcmVxdWVzdF9qYWNrKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZv
ICptb2R1bGUsCiAJaWYgKHJlcS0+ZXZlbnQgPT0gR0JfQVVESU9fSkFDS19FVkVOVF9SRU1PVkFM
KSB7CiAJCW1vZHVsZS0+amFja190eXBlID0gMDsKIAkJaWYgKGJ0bl9qYWNrICYmIG1vZHVsZS0+
YnV0dG9uX3N0YXR1cykgewotCQkJc25kX3NvY19qYWNrX3JlcG9ydCgmbW9kdWxlLT5idXR0b25f
amFjaywgMCwKLQkJCQkJICAgIG1vZHVsZS0+YnV0dG9uX21hc2spOworCQkJc25kX3NvY19qYWNr
X3JlcG9ydChidG4sIDAsIG1vZHVsZS0+YnV0dG9uX21hc2spOwogCQkJbW9kdWxlLT5idXR0b25f
c3RhdHVzID0gMDsKIAkJfQotCQlzbmRfc29jX2phY2tfcmVwb3J0KCZtb2R1bGUtPmhlYWRzZXRf
amFjaywgMCwKLQkJCQkgICAgbW9kdWxlLT5qYWNrX21hc2spOworCQlzbmRfc29jX2phY2tfcmVw
b3J0KGhzLCAwLCBtb2R1bGUtPmphY2tfbWFzayk7CiAJCXJldHVybiAwOwogCX0KIApAQCAtNjEs
NyArNjEsNyBAQCBzdGF0aWMgaW50IGdiYXVkaW9fcmVxdWVzdF9qYWNrKHN0cnVjdCBnYmF1ZGlv
X21vZHVsZV9pbmZvICptb2R1bGUsCiAJCQkJICAgICBtb2R1bGUtPmphY2tfdHlwZSwgcmVwb3J0
KTsKIAogCW1vZHVsZS0+amFja190eXBlID0gcmVwb3J0OwotCXNuZF9zb2NfamFja19yZXBvcnQo
Jm1vZHVsZS0+aGVhZHNldF9qYWNrLCByZXBvcnQsIG1vZHVsZS0+amFja19tYXNrKTsKKwlzbmRf
c29jX2phY2tfcmVwb3J0KGhzLCByZXBvcnQsIG1vZHVsZS0+amFja19tYXNrKTsKIAogCXJldHVy
biAwOwogfQpAQCAtNzAsNyArNzAsOCBAQCBzdGF0aWMgaW50IGdiYXVkaW9fcmVxdWVzdF9idXR0
b24oc3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSwKIAkJCQkgIHN0cnVjdCBnYl9h
dWRpb19idXR0b25fZXZlbnRfcmVxdWVzdCAqcmVxKQogewogCWludCBzb2NfYnV0dG9uX2lkLCBy
ZXBvcnQ7Ci0Jc3RydWN0IHNuZF9qYWNrICpidG5famFjayA9IG1vZHVsZS0+YnV0dG9uX2phY2su
amFjazsKKwlzdHJ1Y3Qgc25kX3NvY19qYWNrICpidG4gPSAmbW9kdWxlLT5idXR0b24uamFjazsK
KwlzdHJ1Y3Qgc25kX2phY2sgKmJ0bl9qYWNrID0gYnRuLT5qYWNrOwogCiAJaWYgKCFidG5famFj
aykgewogCQlkZXZfZXJyX3JhdGVsaW1pdGVkKG1vZHVsZS0+ZGV2LApAQCAtMTI0LDcgKzEyNSw3
IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19yZXF1ZXN0X2J1dHRvbihzdHJ1Y3QgZ2JhdWRpb19tb2R1
bGVfaW5mbyAqbW9kdWxlLAogCiAJbW9kdWxlLT5idXR0b25fc3RhdHVzID0gcmVwb3J0OwogCi0J
c25kX3NvY19qYWNrX3JlcG9ydCgmbW9kdWxlLT5idXR0b25famFjaywgcmVwb3J0LCBtb2R1bGUt
PmJ1dHRvbl9tYXNrKTsKKwlzbmRfc29jX2phY2tfcmVwb3J0KGJ0biwgcmVwb3J0LCBtb2R1bGUt
PmJ1dHRvbl9tYXNrKTsKIAogCXJldHVybiAwOwogfQpAQCAtMjU4LDYgKzI1OSw3IEBAIHN0YXRp
YyBpbnQgZ2JfYXVkaW9fcHJvYmUoc3RydWN0IGdiX2J1bmRsZSAqYnVuZGxlLAogCUlOSVRfTElT
VF9IRUFEKCZnYm1vZHVsZS0+d2lkZ2V0X2xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZnYm1vZHVs
ZS0+Y3RsX2xpc3QpOwogCUlOSVRfTElTVF9IRUFEKCZnYm1vZHVsZS0+d2lkZ2V0X2N0bF9saXN0
KTsKKwlJTklUX0xJU1RfSEVBRCgmZ2Jtb2R1bGUtPmphY2tfbGlzdCk7CiAJZ2Jtb2R1bGUtPmRl
diA9IGRldjsKIAlzbnByaW50ZihnYm1vZHVsZS0+bmFtZSwgTkFNRV9TSVpFLCAiJXMuJXMiLCBk
ZXYtPmRyaXZlci0+bmFtZSwKIAkJIGRldl9uYW1lKGRldikpOwotLSAKMi4yNi4yCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpncmV5YnVzLWRldiBtYWls
aW5nIGxpc3QKZ3JleWJ1cy1kZXZAbGlzdHMubGluYXJvLm9yZwpodHRwczovL2xpc3RzLmxpbmFy
by5vcmcvbWFpbG1hbi9saXN0aW5mby9ncmV5YnVzLWRldgo=
