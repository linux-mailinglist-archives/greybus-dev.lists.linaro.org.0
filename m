Return-Path: <greybus-dev-bounces@lists.linaro.org>
X-Original-To: lists+greybus-dev@lfdr.de
Delivered-To: lists+greybus-dev@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id B6EDC1F5A83
	for <lists+greybus-dev@lfdr.de>; Wed, 10 Jun 2020 19:31:40 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id D500D61915
	for <lists+greybus-dev@lfdr.de>; Wed, 10 Jun 2020 17:31:39 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id C7C156197A; Wed, 10 Jun 2020 17:31:39 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,DKIM_ADSP_CUSTOM_MED,
	FREEMAIL_FROM,MAILING_LIST_MULTI,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H3,
	RCVD_IN_MSPIKE_WL,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 3D821664DE;
	Wed, 10 Jun 2020 17:30:49 +0000 (UTC)
X-Original-To: greybus-dev@lists.linaro.org
Delivered-To: greybus-dev@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 87AC761915
 for <greybus-dev@lists.linaro.org>; Wed, 10 Jun 2020 17:30:42 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 7451965F7D; Wed, 10 Jun 2020 17:30:42 +0000 (UTC)
Received: from mail-pl1-f195.google.com (mail-pl1-f195.google.com
 [209.85.214.195])
 by lists.linaro.org (Postfix) with ESMTPS id 3658061915
 for <greybus-dev@lists.linaro.org>; Wed, 10 Jun 2020 17:29:59 +0000 (UTC)
Received: by mail-pl1-f195.google.com with SMTP id y18so1214509plr.4
 for <greybus-dev@lists.linaro.org>; Wed, 10 Jun 2020 10:29:59 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=gfrlpGoTNXiGa/XXbeu+ihXhuIQgIacaCYzHi8L5ysc=;
 b=rdoK868GuDXHh17YKP5ZUV5ZbJtwJFcbIN5ARuzvZAIHcsCAlShRjnPnn5/r60P7mb
 8oHhhi5iv/f0SNH3hE8I0BKXdSVvNsWf0n0WVKcVM2lYa+FVIk+pMsQcjQcecG3bd3Tf
 ZSMbjtwy8G4seqvD6fg+RvGRIMwnnCifXpsWgP7vvQIcFcjrOYl2/EGb6ZIljU6uF9FO
 EtTWjSi0xlqjQURny+S3BhqtUG6/CC5qNELChpIMZRFB0adbgrlYIev6hM4huYX84JfX
 qS5OeB0Te4VTYjPIRo7XmkUQeZlA0nz+i2dP+EXQ6DV6g9G2i/gGP10jS1+ky8fRyV07
 8r3A==
X-Gm-Message-State: AOAM530O3aI/NB7TwjZ7gVdnzc3VJKgVz6D02Q8ZVlTheDSuKrGoDhxI
 XqLo2L/Q4HBvAPTGi3KCfw4=
X-Google-Smtp-Source: ABdhPJwF2vF5MXj45haRFW+WSg2dyKDatb5eRM1KRpGaJp0U9c/8W5cKIjBn+MgMZ40e0aOYh0O0LQ==
X-Received: by 2002:a17:90b:238d:: with SMTP id
 mr13mr4196123pjb.19.1591810198356; 
 Wed, 10 Jun 2020 10:29:58 -0700 (PDT)
Received: from cvds-vagarw7.iind.intel.com ([192.55.54.40])
 by smtp.googlemail.com with ESMTPSA id l83sm490470pfd.150.2020.06.10.10.29.48
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Wed, 10 Jun 2020 10:29:57 -0700 (PDT)
From: Vaibhav Agarwal <vaibhav.sr@gmail.com>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Alex Elder <elder@kernel.org>, Johan Hovold <johan@kernel.org>,
 Mark Greer <mgreer@animalcreek.com>, Takashi Iwai <tiwai@suse.com>,
 Jaroslav Kysela <perex@perex.cz>, Mark Brown <broonie@kernel.org>,
 Liam Girdwood <lgirdwood@gmail.com>
Date: Wed, 10 Jun 2020 22:58:29 +0530
Message-Id: <27bd84c86a2e71638d0ab78b717058063b45388f.1591802243.git.vaibhav.sr@gmail.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <cover.1591802243.git.vaibhav.sr@gmail.com>
References: <cover.1591802243.git.vaibhav.sr@gmail.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: devel@driverdev.osuosl.org, alsa-devel@alsa-project.org,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 linux-kernel@vger.kernel.org, greybus-dev@lists.linaro.org
Subject: [greybus-dev] [PATCH v2 5/6] staging: greybus: audio: Add helper
	APIs for dynamic audio modules
X-BeenThere: greybus-dev@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: Greybus Development Mail List <greybus-dev.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/greybus-dev/>
List-Post: <mailto:greybus-dev@lists.linaro.org>
List-Help: <mailto:greybus-dev-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: greybus-dev-bounces@lists.linaro.org
Sender: "greybus-dev" <greybus-dev-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

R3JleWJ1cyBDb2RlYyBkcml2ZXIgYWxsb3dzIG1vZHVsZXMgdG8gYmUgZHluYW1pY2FsbHkgYWRk
ZWQgYW5kIHJlbW92ZWQsCndoaWNoIGZ1cnRoZXIgcmVxdWlyZXMgdXBkYXRpbmcgdGhlIERBUE0g
Y29uZmlndXJhdGlvbnMgYXMgd2VsbC4KCldpdGggY3VycmVudCBzbmRfc29jIGFyY2hpdGVjdHVy
ZSwgZHluYW1pYyBhdWRpbyBtb2R1bGVzIGlzIG5vdCB5ZXQKc3VwcG9ydGVkLiBUaGlzIHBhdGNo
IHByb3ZpZGVzIGhlbHBlciBBUElzIHRvIHVwZGF0ZSBEQVBNIGNvbmZpZ3VyYXRpb25zCmluIHJl
c3BvbnNlIHRvIG1vZHVsZXMgd2hpY2ggYXJlIGR5bmFtaWNhbGx5IGFkZGVkIG9yIHJlbW92ZWQu
IFRoZQpzb3VyY2UgaXMgcHJpbWFyaWx5IGJhc2VkIG9uIHNuZF9kYXBtLmMKClNpZ25lZC1vZmYt
Ynk6IFZhaWJoYXYgQWdhcndhbCA8dmFpYmhhdi5zckBnbWFpbC5jb20+Ci0tLQogZHJpdmVycy9z
dGFnaW5nL2dyZXlidXMvTWFrZWZpbGUgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvc3RhZ2luZy9n
cmV5YnVzL2F1ZGlvX2NvZGVjLmMgIHwgIDEyICstCiBkcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9h
dWRpb19oZWxwZXIuYyB8IDE5NyArKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL3N0
YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaCB8ICAxNyArKysKIDQgZmlsZXMgY2hhbmdlZCwg
MjIzIGluc2VydGlvbnMoKyksIDUgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9faGVscGVyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaAoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvc3RhZ2luZy9ncmV5YnVzL01ha2VmaWxlIGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvTWFr
ZWZpbGUKaW5kZXggNjI3ZTQ0ZjJhOTgzLi4zYjRiNmNhYmZmMTkgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvc3RhZ2luZy9ncmV5YnVzL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVz
L01ha2VmaWxlCkBAIC0yOCw3ICsyOCw3IEBAIG9iai0kKENPTkZJR19HUkVZQlVTX1ZJQlJBVE9S
KQkrPSBnYi12aWJyYXRvci5vCiAKICMgR3JleWJ1cyBBdWRpbyBpcyBhIGJ1bmNoIG9mIG1vZHVs
ZXMKIGdiLWF1ZGlvLW1vZHVsZS15CTo9IGF1ZGlvX21vZHVsZS5vIGF1ZGlvX3RvcG9sb2d5Lm8K
LWdiLWF1ZGlvLWNvZGVjLXkJOj0gYXVkaW9fY29kZWMubworZ2ItYXVkaW8tY29kZWMteQk6PSBh
dWRpb19jb2RlYy5vIGF1ZGlvX2hlbHBlci5vCiBnYi1hdWRpby1nYi15CQk6PSBhdWRpb19nYi5v
CiBnYi1hdWRpby1hcGJyaWRnZWEteQk6PSBhdWRpb19hcGJyaWRnZWEubwogZ2ItYXVkaW8tbWFu
YWdlci15CTo9IGF1ZGlvX21hbmFnZXIubyBhdWRpb19tYW5hZ2VyX21vZHVsZS5vCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5jIGIvZHJpdmVycy9zdGFn
aW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYwppbmRleCAwZWNkYmEyNzA4NmIuLjc0NTM4ZjhjNWZh
NCAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYworKysg
Yi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5jCkBAIC0xNCw2ICsxNCw3IEBA
CiAjaW5jbHVkZSAiYXVkaW9fY29kZWMuaCIKICNpbmNsdWRlICJhdWRpb19hcGJyaWRnZWEuaCIK
ICNpbmNsdWRlICJhdWRpb19tYW5hZ2VyLmgiCisjaW5jbHVkZSAiYXVkaW9faGVscGVyLmgiCiAK
IHN0YXRpYyBzdHJ1Y3QgZ2JhdWRpb19jb2RlY19pbmZvICpnYmNvZGVjOwogCkBAIC04NjUsNyAr
ODY2LDcgQEAgaW50IGdiYXVkaW9fcmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1ZGlvX21vZHVs
ZV9pbmZvICptb2R1bGUpCiAKIAkvKiBjYXJkIGFscmVhZHkgaW5zdGFudGlhdGVkLCBjcmVhdGUg
d2lkZ2V0cyBoZXJlIG9ubHkgKi8KIAlpZiAoY29tcC0+Y2FyZC0+aW5zdGFudGlhdGVkKSB7Ci0J
CXNuZF9zb2NfZGFwbV9saW5rX2NvbXBvbmVudF9kYWlfd2lkZ2V0cyhjb21wLT5jYXJkLAorCQln
YmF1ZGlvX2RhcG1fbGlua19jb21wb25lbnRfZGFpX3dpZGdldHMoY29tcC0+Y2FyZCwKIAkJCQkJ
CQkmY29tcC0+ZGFwbSk7CiAjaWZkZWYgQ09ORklHX1NORF9KQUNLCiAJCS8qCkBAIC05OTksMTMg
KzEwMDAsMTYgQEAgdm9pZCBnYmF1ZGlvX3VucmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1ZGlv
X21vZHVsZV9pbmZvICptb2R1bGUpCiAJaWYgKG1vZHVsZS0+Y29udHJvbHMpIHsKIAkJZGV2X2Ri
Zyhjb21wLT5kZXYsICJSZW1vdmluZyAlZCBjb250cm9sc1xuIiwKIAkJCW1vZHVsZS0+bnVtX2Nv
bnRyb2xzKTsKLQkJc25kX3NvY19yZW1vdmVfY29kZWNfY29udHJvbHMoY29tcCwgbW9kdWxlLT5j
b250cm9scywKLQkJCQkJICAgICAgbW9kdWxlLT5udW1fY29udHJvbHMpOworCQkvKiByZWxlYXNl
IGNvbnRyb2wgc2VtYXBob3JlICovCisJCXVwX3dyaXRlKCZjYXJkLT5jb250cm9sc19yd3NlbSk7
CisJCWdiYXVkaW9fcmVtb3ZlX2NvbXBvbmVudF9jb250cm9scyhjb21wLCBtb2R1bGUtPmNvbnRy
b2xzLAorCQkJCQkJICBtb2R1bGUtPm51bV9jb250cm9scyk7CisJCWRvd25fd3JpdGUoJmNhcmQt
PmNvbnRyb2xzX3J3c2VtKTsKIAl9CiAJaWYgKG1vZHVsZS0+ZGFwbV93aWRnZXRzKSB7CiAJCWRl
dl9kYmcoY29tcC0+ZGV2LCAiUmVtb3ZpbmcgJWQgd2lkZ2V0c1xuIiwKIAkJCW1vZHVsZS0+bnVt
X2RhcG1fd2lkZ2V0cyk7Ci0JCXNuZF9zb2NfZGFwbV9mcmVlX2NvbnRyb2xzKCZjb21wLT5kYXBt
LCBtb2R1bGUtPmRhcG1fd2lkZ2V0cywKKwkJZ2JhdWRpb19kYXBtX2ZyZWVfY29udHJvbHMoJmNv
bXAtPmRhcG0sIG1vZHVsZS0+ZGFwbV93aWRnZXRzLAogCQkJCQkgICBtb2R1bGUtPm51bV9kYXBt
X3dpZGdldHMpOwogCX0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVk
aW9faGVscGVyLmMgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuYwpuZXcg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmZhYWEzOTcwODExOAotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2hlbHBlci5jCkBAIC0w
LDAgKzEsMTk3IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAorLyoKKyAq
IEdyZXlidXMgQXVkaW8gU291bmQgU29DIGhlbHBlciBBUElzCisgKi8KKworI2luY2x1ZGUgPGxp
bnV4L2RlYnVnZnMuaD4KKyNpbmNsdWRlIDxzb3VuZC9jb3JlLmg+CisjaW5jbHVkZSA8c291bmQv
c29jLmg+CisjaW5jbHVkZSA8c291bmQvc29jLWRhcG0uaD4KKworI2RlZmluZSBnYmF1ZGlvX2Rh
cG1fZm9yX2VhY2hfZGlyZWN0aW9uKGRpcikgXAorCWZvciAoKGRpcikgPSBTTkRfU09DX0RBUE1f
RElSX0lOOyAoZGlyKSA8PSBTTkRfU09DX0RBUE1fRElSX09VVDsgXAorCQkoZGlyKSsrKQorCitz
dGF0aWMgdm9pZCBnYmF1ZGlvX2RhcG1fbGlua19kYWlfd2lkZ2V0KHN0cnVjdCBzbmRfc29jX2Rh
cG1fd2lkZ2V0ICpkYWlfdywKKwkJCQkJIHN0cnVjdCBzbmRfc29jX2NhcmQgKmNhcmQpCit7CisJ
c3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKnc7CisJc3RydWN0IHNuZF9zb2NfZGFwbV93aWRn
ZXQgKnNyYywgKnNpbms7CisJc3RydWN0IHNuZF9zb2NfZGFpICpkYWkgPSBkYWlfdy0+cHJpdjsK
KworCS8qIC4uLmZpbmQgYWxsIHdpZGdldHMgd2l0aCB0aGUgc2FtZSBzdHJlYW0gYW5kIGxpbmsg
dGhlbSAqLworCWxpc3RfZm9yX2VhY2hfZW50cnkodywgJmNhcmQtPndpZGdldHMsIGxpc3QpIHsK
KwkJaWYgKHctPmRhcG0gIT0gZGFpX3ctPmRhcG0pCisJCQljb250aW51ZTsKKworCQlzd2l0Y2gg
KHctPmlkKSB7CisJCWNhc2Ugc25kX3NvY19kYXBtX2RhaV9pbjoKKwkJY2FzZSBzbmRfc29jX2Rh
cG1fZGFpX291dDoKKwkJCWNvbnRpbnVlOworCQlkZWZhdWx0OgorCQkJYnJlYWs7CisJCX0KKwor
CQlpZiAoIXctPnNuYW1lIHx8ICFzdHJzdHIody0+c25hbWUsIGRhaV93LT5zbmFtZSkpCisJCQlj
b250aW51ZTsKKworCQkvKgorCQkgKiBjaGVjayBpZiB3aWRnZXQgaXMgYWxyZWFkeSBsaW5rZWQs
CisJCSAqIGlmICh3LT5saW5rZWQpCisJCSAqCXJldHVybjsKKwkJICovCisKKwkJaWYgKGRhaV93
LT5pZCA9PSBzbmRfc29jX2RhcG1fZGFpX2luKSB7CisJCQlzcmMgPSBkYWlfdzsKKwkJCXNpbmsg
PSB3OworCQl9IGVsc2UgeworCQkJc3JjID0gdzsKKwkJCXNpbmsgPSBkYWlfdzsKKwkJfQorCQlk
ZXZfZGJnKGRhaS0+ZGV2LCAiJXMgLT4gJXNcbiIsIHNyYy0+bmFtZSwgc2luay0+bmFtZSk7CisJ
CS8qIEFkZCB0aGUgREFQTSBwYXRoIGFuZCBzZXQgd2lkZ2V0J3MgbGlua2VkIHN0YXR1cworCQkg
KiBzbmRfc29jX2RhcG1fYWRkX3BhdGgody0+ZGFwbSwgc3JjLCBzaW5rLCBOVUxMLCBOVUxMKTsK
KwkJICogdy0+bGlua2VkID0gMTsKKwkJICovCisJfQorfQorCitpbnQgZ2JhdWRpb19kYXBtX2xp
bmtfY29tcG9uZW50X2RhaV93aWRnZXRzKHN0cnVjdCBzbmRfc29jX2NhcmQgKmNhcmQsCisJCQkJ
CSAgICBzdHJ1Y3Qgc25kX3NvY19kYXBtX2NvbnRleHQgKmRhcG0pCit7CisJc3RydWN0IHNuZF9z
b2NfZGFwbV93aWRnZXQgKmRhaV93OworCisJLyogRm9yIGVhY2ggREFJIHdpZGdldC4uLiAqLwor
CWxpc3RfZm9yX2VhY2hfZW50cnkoZGFpX3csICZjYXJkLT53aWRnZXRzLCBsaXN0KSB7CisJCWlm
IChkYWlfdy0+ZGFwbSAhPSBkYXBtKQorCQkJY29udGludWU7CisJCXN3aXRjaCAoZGFpX3ctPmlk
KSB7CisJCWNhc2Ugc25kX3NvY19kYXBtX2RhaV9pbjoKKwkJY2FzZSBzbmRfc29jX2RhcG1fZGFp
X291dDoKKwkJCWJyZWFrOworCQlkZWZhdWx0OgorCQkJY29udGludWU7CisJCX0KKwkJZ2JhdWRp
b19kYXBtX2xpbmtfZGFpX3dpZGdldChkYWlfdywgY2FyZCk7CisJfQorCisJcmV0dXJuIDA7Cit9
CisKK3N0YXRpYyB2b2lkIGdiYXVkaW9fZGFwbV9mcmVlX3BhdGgoc3RydWN0IHNuZF9zb2NfZGFw
bV9wYXRoICpwYXRoKQoreworCWxpc3RfZGVsKCZwYXRoLT5saXN0X25vZGVbU05EX1NPQ19EQVBN
X0RJUl9JTl0pOworCWxpc3RfZGVsKCZwYXRoLT5saXN0X25vZGVbU05EX1NPQ19EQVBNX0RJUl9P
VVRdKTsKKwlsaXN0X2RlbCgmcGF0aC0+bGlzdF9rY29udHJvbCk7CisJbGlzdF9kZWwoJnBhdGgt
Pmxpc3QpOworCWtmcmVlKHBhdGgpOworfQorCitzdGF0aWMgdm9pZCBnYmF1ZGlvX2RhcG1fZnJl
ZV93aWRnZXQoc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKncpCit7CisJc3RydWN0IHNuZF9z
b2NfZGFwbV9wYXRoICpwLCAqbmV4dF9wOworCWVudW0gc25kX3NvY19kYXBtX2RpcmVjdGlvbiBk
aXI7CisKKwlsaXN0X2RlbCgmdy0+bGlzdCk7CisJLyoKKwkgKiByZW1vdmUgc291cmNlIGFuZCBz
aW5rIHBhdGhzIGFzc29jaWF0ZWQgdG8gdGhpcyB3aWRnZXQuCisJICogV2hpbGUgcmVtb3Zpbmcg
dGhlIHBhdGgsIHJlbW92ZSByZWZlcmVuY2UgdG8gaXQgZnJvbSBib3RoCisJICogc291cmNlIGFu
ZCBzaW5rIHdpZGdldHMgc28gdGhhdCBwYXRoIGlzIHJlbW92ZWQgb25seSBvbmNlLgorCSAqLwor
CWdiYXVkaW9fZGFwbV9mb3JfZWFjaF9kaXJlY3Rpb24oZGlyKSB7CisJCXNuZF9zb2NfZGFwbV93
aWRnZXRfZm9yX2VhY2hfcGF0aF9zYWZlKHcsIGRpciwgcCwgbmV4dF9wKQorCQkJZ2JhdWRpb19k
YXBtX2ZyZWVfcGF0aChwKTsKKwl9CisKKwlrZnJlZSh3LT5rY29udHJvbHMpOworCWtmcmVlX2Nv
bnN0KHctPm5hbWUpOworCWtmcmVlX2NvbnN0KHctPnNuYW1lKTsKKwlrZnJlZSh3KTsKK30KKwor
aW50IGdiYXVkaW9fZGFwbV9mcmVlX2NvbnRyb2xzKHN0cnVjdCBzbmRfc29jX2RhcG1fY29udGV4
dCAqZGFwbSwKKwkJCSAgICAgICBjb25zdCBzdHJ1Y3Qgc25kX3NvY19kYXBtX3dpZGdldCAqd2lk
Z2V0LAorCQkJICAgICAgIGludCBudW0pCit7CisJaW50IGk7CisJc3RydWN0IHNuZF9zb2NfZGFw
bV93aWRnZXQgKncsICpuZXh0X3c7CisjaWZkZWYgQ09ORklHX0RFQlVHX0ZTCisJc3RydWN0IGRl
bnRyeSAqcGFyZW50ID0gZGFwbS0+ZGVidWdmc19kYXBtOworCXN0cnVjdCBkZW50cnkgKmRlYnVn
ZnNfdyA9IE5VTEw7CisjZW5kaWYKKworCW11dGV4X2xvY2soJmRhcG0tPmNhcmQtPmRhcG1fbXV0
ZXgpOworCWZvciAoaSA9IDA7IGkgPCBudW07IGkrKykgeworCQkvKiBiZWxvdyBsb2dpYyBjYW4g
YmUgb3B0aW1pemVkIHRvIGlkZW50aWZ5IHdpZGdldCBwb2ludGVyICovCisJCWxpc3RfZm9yX2Vh
Y2hfZW50cnlfc2FmZSh3LCBuZXh0X3csICZkYXBtLT5jYXJkLT53aWRnZXRzLAorCQkJCQkgbGlz
dCkgeworCQkJaWYgKHctPmRhcG0gIT0gZGFwbSkKKwkJCQljb250aW51ZTsKKwkJCWlmICghc3Ry
Y21wKHctPm5hbWUsIHdpZGdldC0+bmFtZSkpCisJCQkJYnJlYWs7CisJCQl3ID0gTlVMTDsKKwkJ
fQorCQlpZiAoIXcpIHsKKwkJCWRldl9lcnIoZGFwbS0+ZGV2LCAiJXM6IHdpZGdldCBub3QgZm91
bmRcbiIsCisJCQkJd2lkZ2V0LT5uYW1lKTsKKwkJCXJldHVybiAtRUlOVkFMOworCQl9CisJCXdp
ZGdldCsrOworI2lmZGVmIENPTkZJR19ERUJVR19GUworCQlpZiAoIXBhcmVudCkKKwkJCWRlYnVn
ZnNfdyA9IGRlYnVnZnNfbG9va3VwKHctPm5hbWUsIHBhcmVudCk7CisJCWRlYnVnZnNfcmVtb3Zl
KGRlYnVnZnNfdyk7CisJCWRlYnVnZnNfdyA9IE5VTEw7CisjZW5kaWYKKwkJZ2JhdWRpb19kYXBt
X2ZyZWVfd2lkZ2V0KHcpOworCX0KKwltdXRleF91bmxvY2soJmRhcG0tPmNhcmQtPmRhcG1fbXV0
ZXgpOworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGdiYXVkaW9fcmVtb3ZlX2NvbnRyb2xz
KHN0cnVjdCBzbmRfY2FyZCAqY2FyZCwgc3RydWN0IGRldmljZSAqZGV2LAorCQkJCSAgIGNvbnN0
IHN0cnVjdCBzbmRfa2NvbnRyb2xfbmV3ICpjb250cm9scywKKwkJCQkgICBpbnQgbnVtX2NvbnRy
b2xzLCBjb25zdCBjaGFyICpwcmVmaXgpCit7CisJaW50IGksIGVycjsKKworCWZvciAoaSA9IDA7
IGkgPCBudW1fY29udHJvbHM7IGkrKykgeworCQljb25zdCBzdHJ1Y3Qgc25kX2tjb250cm9sX25l
dyAqY29udHJvbCA9ICZjb250cm9sc1tpXTsKKwkJc3RydWN0IHNuZF9jdGxfZWxlbV9pZCBpZDsK
KwkJc3RydWN0IHNuZF9rY29udHJvbCAqa2N0bDsKKworCQlpZiAocHJlZml4KQorCQkJc25wcmlu
dGYoaWQubmFtZSwgc2l6ZW9mKGlkLm5hbWUpLCAiJXMgJXMiLCBwcmVmaXgsCisJCQkJIGNvbnRy
b2wtPm5hbWUpOworCQllbHNlCisJCQlzdHJsY3B5KGlkLm5hbWUsIGNvbnRyb2wtPm5hbWUsIHNp
emVvZihpZC5uYW1lKSk7CisJCWlkLm51bWlkID0gMDsKKwkJaWQuaWZhY2UgPSBjb250cm9sLT5p
ZmFjZTsKKwkJaWQuZGV2aWNlID0gY29udHJvbC0+ZGV2aWNlOworCQlpZC5zdWJkZXZpY2UgPSBj
b250cm9sLT5zdWJkZXZpY2U7CisJCWlkLmluZGV4ID0gY29udHJvbC0+aW5kZXg7CisJCWtjdGwg
PSBzbmRfY3RsX2ZpbmRfaWQoY2FyZCwgJmlkKTsKKwkJaWYgKCFrY3RsKSB7CisJCQlkZXZfZXJy
KGRldiwgIiVkOiBGYWlsZWQgdG8gZmluZCAlc1xuIiwgZXJyLAorCQkJCWNvbnRyb2wtPm5hbWUp
OworCQkJY29udGludWU7CisJCX0KKwkJZXJyID0gc25kX2N0bF9yZW1vdmUoY2FyZCwga2N0bCk7
CisJCWlmIChlcnIgPCAwKSB7CisJCQlkZXZfZXJyKGRldiwgIiVkOiBGYWlsZWQgdG8gcmVtb3Zl
ICVzXG4iLCBlcnIsCisJCQkJY29udHJvbC0+bmFtZSk7CisJCQljb250aW51ZTsKKwkJfQorCX0K
KwlyZXR1cm4gMDsKK30KKworaW50IGdiYXVkaW9fcmVtb3ZlX2NvbXBvbmVudF9jb250cm9scyhz
dHJ1Y3Qgc25kX3NvY19jb21wb25lbnQgKmNvbXBvbmVudCwKKwkJCQkgICAgICBjb25zdCBzdHJ1
Y3Qgc25kX2tjb250cm9sX25ldyAqY29udHJvbHMsCisJCQkJICAgICAgdW5zaWduZWQgaW50IG51
bV9jb250cm9scykKK3sKKwlzdHJ1Y3Qgc25kX2NhcmQgKmNhcmQgPSBjb21wb25lbnQtPmNhcmQt
PnNuZF9jYXJkOworCisJcmV0dXJuIGdiYXVkaW9fcmVtb3ZlX2NvbnRyb2xzKGNhcmQsIGNvbXBv
bmVudC0+ZGV2LCBjb250cm9scywKKwkJCQkgICAgICAgbnVtX2NvbnRyb2xzLCBjb21wb25lbnQt
Pm5hbWVfcHJlZml4KTsKK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1
ZGlvX2hlbHBlci5oIGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9faGVscGVyLmgKbmV3
IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi41Y2YxYzZkN2QzZWEKLS0tIC9k
ZXYvbnVsbAorKysgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaApAQCAt
MCwwICsxLDE3IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLworLyoK
KyAqIEdyZXlidXMgQXVkaW8gU291bmQgU29DIGhlbHBlciBBUElzCisgKi8KKworI2lmbmRlZiBf
X0xJTlVYX0dCQVVESU9fSEVMUEVSX0gKKyNkZWZpbmUgX19MSU5VWF9HQkFVRElPX0hFTFBFUl9I
CisKK2ludCBnYmF1ZGlvX2RhcG1fbGlua19jb21wb25lbnRfZGFpX3dpZGdldHMoc3RydWN0IHNu
ZF9zb2NfY2FyZCAqY2FyZCwKKwkJCQkJICAgIHN0cnVjdCBzbmRfc29jX2RhcG1fY29udGV4dCAq
ZGFwbSk7CitpbnQgZ2JhdWRpb19kYXBtX2ZyZWVfY29udHJvbHMoc3RydWN0IHNuZF9zb2NfZGFw
bV9jb250ZXh0ICpkYXBtLAorCQkJICAgICAgIGNvbnN0IHN0cnVjdCBzbmRfc29jX2RhcG1fd2lk
Z2V0ICp3aWRnZXQsCisJCQkgICAgICAgaW50IG51bSk7CitpbnQgZ2JhdWRpb19yZW1vdmVfY29t
cG9uZW50X2NvbnRyb2xzKHN0cnVjdCBzbmRfc29jX2NvbXBvbmVudCAqY29tcG9uZW50LAorCQkJ
CSAgICAgIGNvbnN0IHN0cnVjdCBzbmRfa2NvbnRyb2xfbmV3ICpjb250cm9scywKKwkJCQkgICAg
ICB1bnNpZ25lZCBpbnQgbnVtX2NvbnRyb2xzKTsKKyNlbmRpZgotLSAKMi4yNi4yCgpfX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpncmV5YnVzLWRldiBtYWls
aW5nIGxpc3QKZ3JleWJ1cy1kZXZAbGlzdHMubGluYXJvLm9yZwpodHRwczovL2xpc3RzLmxpbmFy
by5vcmcvbWFpbG1hbi9saXN0aW5mby9ncmV5YnVzLWRldgo=
