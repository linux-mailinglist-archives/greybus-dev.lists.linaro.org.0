Return-Path: <greybus-dev-bounces@lists.linaro.org>
X-Original-To: lists+greybus-dev@lfdr.de
Delivered-To: lists+greybus-dev@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 4814C1EB518
	for <lists+greybus-dev@lfdr.de>; Tue,  2 Jun 2020 07:24:04 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 706AD618D3
	for <lists+greybus-dev@lfdr.de>; Tue,  2 Jun 2020 05:24:03 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 63254618DF; Tue,  2 Jun 2020 05:24:03 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,DKIM_ADSP_CUSTOM_MED,
	FREEMAIL_FROM,MAILING_LIST_MULTI,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H3,
	RCVD_IN_MSPIKE_WL,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 5FF6D61966;
	Tue,  2 Jun 2020 05:23:13 +0000 (UTC)
X-Original-To: greybus-dev@lists.linaro.org
Delivered-To: greybus-dev@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id A71F0618D3
 for <greybus-dev@lists.linaro.org>; Tue,  2 Jun 2020 05:22:51 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 983DA61915; Tue,  2 Jun 2020 05:22:51 +0000 (UTC)
Received: from mail-pj1-f67.google.com (mail-pj1-f67.google.com
 [209.85.216.67])
 by lists.linaro.org (Postfix) with ESMTPS id 2D869618D3
 for <greybus-dev@lists.linaro.org>; Tue,  2 Jun 2020 05:22:32 +0000 (UTC)
Received: by mail-pj1-f67.google.com with SMTP id h95so890080pje.4
 for <greybus-dev@lists.linaro.org>; Mon, 01 Jun 2020 22:22:32 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=cdsTla5NmX/8P5iE6VvBk0hZd39sy9358Y1bN31hsbc=;
 b=lsWj2sbYEXjo0YYEMEAgFGpG6XY+mOyUghHfFAy0O3LT7xvTB0+S2XodJMxKvwW/yf
 uJrPdxADdTuQ4cXvIPfFEFBLIe/cV8ASIkV+BOPJLVtXC06GAlkUZD13GSVY7wPid+5G
 WWgMwOq3EKKzJmvR22dIZpe5w0Rpo9Ibz+/D9DQ+pwAOWjBz91iLkmftrgG4xZlC8EfD
 SZavfbVGmIWtBdEBDa6h04EyFBCWCnXTFRU1ggRSHw0rPBg/qOIt8PiRBrZCJgubNm9H
 +Dazy2uoPKv0g/Jk2DYbCKjfhTqkt6dF9yQ+3wF8btOZn1K6SgL/mYImZNNkXviM7g7r
 1rlg==
X-Gm-Message-State: AOAM532veSBrBAI34iIFDj+Cwp2oe1ksZ1Cl9Tb80U6wzY7rXUCdrOYr
 v1Q7h7REAThnAmJy76O6ego=
X-Google-Smtp-Source: ABdhPJwDE8d/ZRpzNecvDr7OlzeXWIYhuyu5j9uBxuT2r/WF7QSVxe+JeALsvaIRC4fTrhRDhra98A==
X-Received: by 2002:a17:90b:f0e:: with SMTP id
 br14mr3283764pjb.78.1591075351126; 
 Mon, 01 Jun 2020 22:22:31 -0700 (PDT)
Received: from cvds-vagarw7.iind.intel.com ([192.55.55.41])
 by smtp.googlemail.com with ESMTPSA id f18sm1004764pga.75.2020.06.01.22.22.20
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Mon, 01 Jun 2020 22:22:29 -0700 (PDT)
From: Vaibhav Agarwal <vaibhav.sr@gmail.com>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Alex Elder <elder@kernel.org>, Johan Hovold <johan@kernel.org>,
 Mark Greer <mgreer@animalcreek.com>, Takashi Iwai <tiwai@suse.com>,
 Jaroslav Kysela <perex@perex.cz>, Mark Brown <broonie@kernel.org>,
 Liam Girdwood <lgirdwood@gmail.com>
Date: Tue,  2 Jun 2020 10:51:14 +0530
Message-Id: <c1339e4d57c8b39bd25197d4514fabd868b829b1.1591040859.git.vaibhav.sr@gmail.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <cover.1591040859.git.vaibhav.sr@gmail.com>
References: <cover.1591040859.git.vaibhav.sr@gmail.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: devel@driverdev.osuosl.org, alsa-devel@alsa-project.org,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 linux-kernel@vger.kernel.org, greybus-dev@lists.linaro.org
Subject: [greybus-dev] [RESEND PATCH v1 5/6] staging: greybus: audio: Add
	helper APIs for dynamic audio modules
X-BeenThere: greybus-dev@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: Greybus Development Mail List <greybus-dev.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/greybus-dev/>
List-Post: <mailto:greybus-dev@lists.linaro.org>
List-Help: <mailto:greybus-dev-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: greybus-dev-bounces@lists.linaro.org
Sender: "greybus-dev" <greybus-dev-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

R3JleWJ1cyBDb2RlYyBkcml2ZXIgYWxsb3dzIG1vZHVsZXMgdG8gYmUgZHluYW1pY2FsbHkgYWRk
ZWQgYW5kIHJlbW92ZWQsCndoaWNoIGZ1cnRoZXIgcmVxdWlyZXMgdXBkYXRpbmcgdGhlIERBUE0g
Y29uZmlndXJhdGlvbnMgYXMgd2VsbC4KCldpdGggY3VycmVudCBzbmRfc29jIGFyY2hpdGVjdHVy
ZSwgZHluYW1pYyBhdWRpbyBtb2R1bGVzIGlzIG5vdCB5ZXQKc3VwcG9ydGVkLiBUaGlzIHBhdGNo
IHByb3ZpZGVzIGhlbHBlciBBUElzIHRvIHVwZGF0ZSBEQVBNIGNvbmZpZ3VyYXRpb25zCmluIHJl
c3BvbnNlIHRvIG1vZHVsZXMgd2hpY2ggYXJlIGR5bmFtaWNhbGx5IGFkZGVkIG9yIHJlbW92ZWQu
IFRoZQpzb3VyY2UgaXMgcHJpbWFyaWx5IGJhc2VkIG9uIHNuZF9kYXBtLmMKClNpZ25lZC1vZmYt
Ynk6IFZhaWJoYXYgQWdhcndhbCA8dmFpYmhhdi5zckBnbWFpbC5jb20+Ci0tLQogZHJpdmVycy9z
dGFnaW5nL2dyZXlidXMvTWFrZWZpbGUgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvc3RhZ2luZy9n
cmV5YnVzL2F1ZGlvX2NvZGVjLmMgIHwgIDEzICstCiBkcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9h
dWRpb19oZWxwZXIuYyB8IDE5NyArKysrKysrKysrKysrKysrKysrKysrKysrCiBkcml2ZXJzL3N0
YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaCB8ICAxNyArKysKIDQgZmlsZXMgY2hhbmdlZCwg
MjI0IGluc2VydGlvbnMoKyksIDUgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9faGVscGVyLmMKIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaAoKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvc3RhZ2luZy9ncmV5YnVzL01ha2VmaWxlIGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvTWFr
ZWZpbGUKaW5kZXggNjI3ZTQ0ZjJhOTgzLi4zYjRiNmNhYmZmMTkgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvc3RhZ2luZy9ncmV5YnVzL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVz
L01ha2VmaWxlCkBAIC0yOCw3ICsyOCw3IEBAIG9iai0kKENPTkZJR19HUkVZQlVTX1ZJQlJBVE9S
KQkrPSBnYi12aWJyYXRvci5vCiAKICMgR3JleWJ1cyBBdWRpbyBpcyBhIGJ1bmNoIG9mIG1vZHVs
ZXMKIGdiLWF1ZGlvLW1vZHVsZS15CTo9IGF1ZGlvX21vZHVsZS5vIGF1ZGlvX3RvcG9sb2d5Lm8K
LWdiLWF1ZGlvLWNvZGVjLXkJOj0gYXVkaW9fY29kZWMubworZ2ItYXVkaW8tY29kZWMteQk6PSBh
dWRpb19jb2RlYy5vIGF1ZGlvX2hlbHBlci5vCiBnYi1hdWRpby1nYi15CQk6PSBhdWRpb19nYi5v
CiBnYi1hdWRpby1hcGJyaWRnZWEteQk6PSBhdWRpb19hcGJyaWRnZWEubwogZ2ItYXVkaW8tbWFu
YWdlci15CTo9IGF1ZGlvX21hbmFnZXIubyBhdWRpb19tYW5hZ2VyX21vZHVsZS5vCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5jIGIvZHJpdmVycy9zdGFn
aW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYwppbmRleCBiYmQwNzJhY2RhNWMuLjg2NmIzMzQyNTE1
ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYworKysg
Yi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5jCkBAIC0xNCw2ICsxNCw3IEBA
CiAjaW5jbHVkZSAiYXVkaW9fY29kZWMuaCIKICNpbmNsdWRlICJhdWRpb19hcGJyaWRnZWEuaCIK
ICNpbmNsdWRlICJhdWRpb19tYW5hZ2VyLmgiCisjaW5jbHVkZSAiYXVkaW9faGVscGVyLmgiCiAK
IHN0YXRpYyBzdHJ1Y3QgZ2JhdWRpb19jb2RlY19pbmZvICpnYmNvZGVjOwogCkBAIC04NzQsNyAr
ODc1LDcgQEAgaW50IGdiYXVkaW9fcmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1ZGlvX21vZHVs
ZV9pbmZvICptb2R1bGUpCiAKIAkvKiBjYXJkIGFscmVhZHkgaW5zdGFudGlhdGVkLCBjcmVhdGUg
d2lkZ2V0cyBoZXJlIG9ubHkgKi8KIAlpZiAoY29tcG9uZW50LT5jYXJkLT5pbnN0YW50aWF0ZWQp
IHsKLQkJc25kX3NvY19kYXBtX2xpbmtfY29tcG9uZW50X2RhaV93aWRnZXRzKGNvbXBvbmVudC0+
Y2FyZCwKKwkJZ2JhdWRpb19kYXBtX2xpbmtfY29tcG9uZW50X2RhaV93aWRnZXRzKGNvbXBvbmVu
dC0+Y2FyZCwKIAkJCQkJCQkmY29tcG9uZW50LT5kYXBtKTsKICNpZmRlZiBDT05GSUdfU05EX0pB
Q0sKIAkJLyoKQEAgLTEwMDQsMTkgKzEwMDUsMjMgQEAgdm9pZCBnYmF1ZGlvX3VucmVnaXN0ZXJf
bW9kdWxlKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUpCiAJaWYgKG1vZHVsZS0+
ZGFwbV9yb3V0ZXMpIHsKIAkJZGV2X2RiZyhjb21wb25lbnQtPmRldiwgIlJlbW92aW5nICVkIHJv
dXRlc1xuIiwKIAkJCW1vZHVsZS0+bnVtX2RhcG1fcm91dGVzKTsKKwkJLyogdmVyaWZ5IHJvdXRl
cyB3aXRoIGNvbnRyb2xzIGFyZSByZW1vdmVkICovCiAJCXNuZF9zb2NfZGFwbV9kZWxfcm91dGVz
KCZjb21wb25lbnQtPmRhcG0sIG1vZHVsZS0+ZGFwbV9yb3V0ZXMsCiAJCQkJCW1vZHVsZS0+bnVt
X2RhcG1fcm91dGVzKTsKIAl9CiAJaWYgKG1vZHVsZS0+Y29udHJvbHMpIHsKIAkJZGV2X2RiZyhj
b21wb25lbnQtPmRldiwgIlJlbW92aW5nICVkIGNvbnRyb2xzXG4iLAogCQkJbW9kdWxlLT5udW1f
Y29udHJvbHMpOwotCQlzbmRfc29jX3JlbW92ZV9jb2RlY19jb250cm9scyhjb21wb25lbnQsIG1v
ZHVsZS0+Y29udHJvbHMsCi0JCQkJCSAgICAgIG1vZHVsZS0+bnVtX2NvbnRyb2xzKTsKKwkJLyog
cmVsZWFzZSBjb250cm9sIHNlbWFwaG9yZSAqLworCQl1cF93cml0ZSgmY2FyZC0+Y29udHJvbHNf
cndzZW0pOworCQlnYmF1ZGlvX3JlbW92ZV9jb21wb25lbnRfY29udHJvbHMoY29tcG9uZW50LCBt
b2R1bGUtPmNvbnRyb2xzLAorCQkJCQkJICBtb2R1bGUtPm51bV9jb250cm9scyk7CisJCWRvd25f
d3JpdGUoJmNhcmQtPmNvbnRyb2xzX3J3c2VtKTsKIAl9CiAJaWYgKG1vZHVsZS0+ZGFwbV93aWRn
ZXRzKSB7CiAJCWRldl9kYmcoY29tcG9uZW50LT5kZXYsICJSZW1vdmluZyAlZCB3aWRnZXRzXG4i
LAogCQkJbW9kdWxlLT5udW1fZGFwbV93aWRnZXRzKTsKLQkJc25kX3NvY19kYXBtX2ZyZWVfY29u
dHJvbHMoJmNvbXBvbmVudC0+ZGFwbSwKKwkJZ2JhdWRpb19kYXBtX2ZyZWVfY29udHJvbHMoJmNv
bXBvbmVudC0+ZGFwbSwKIAkJCQkJICAgbW9kdWxlLT5kYXBtX3dpZGdldHMsCiAJCQkJCSAgIG1v
ZHVsZS0+bnVtX2RhcG1fd2lkZ2V0cyk7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5n
L2dyZXlidXMvYXVkaW9faGVscGVyLmMgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19o
ZWxwZXIuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmUyZjExM2E4
MTFlZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2hl
bHBlci5jCkBAIC0wLDAgKzEsMTk3IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BM
LTIuMAorLyoKKyAqIEdyZXlidXMgQXVkaW8gU291bmQgU29DIGhlbHBlciBBUElzCisgKi8KKwor
I2luY2x1ZGUgPGxpbnV4L2RlYnVnZnMuaD4KKyNpbmNsdWRlIDxzb3VuZC9jb3JlLmg+CisjaW5j
bHVkZSA8c291bmQvc29jLmg+CisjaW5jbHVkZSA8c291bmQvc29jLWRhcG0uaD4KKworI2RlZmlu
ZSBnYmF1ZGlvX2RhcG1fZm9yX2VhY2hfZGlyZWN0aW9uKGRpcikgXAorCWZvciAoKGRpcikgPSBT
TkRfU09DX0RBUE1fRElSX0lOOyAoZGlyKSA8PSBTTkRfU09DX0RBUE1fRElSX09VVDsgXAorCQko
ZGlyKSsrKQorCitzdGF0aWMgdm9pZCBnYmF1ZGlvX2RhcG1fbGlua19kYWlfd2lkZ2V0KHN0cnVj
dCBzbmRfc29jX2RhcG1fd2lkZ2V0ICpkYWlfdywKKwkJCQkJIHN0cnVjdCBzbmRfc29jX2NhcmQg
KmNhcmQpCit7CisJc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKnc7CisJc3RydWN0IHNuZF9z
b2NfZGFwbV93aWRnZXQgKnNyYywgKnNpbms7CisJc3RydWN0IHNuZF9zb2NfZGFpICpkYWkgPSBk
YWlfdy0+cHJpdjsKKworCS8qIC4uLmZpbmQgYWxsIHdpZGdldHMgd2l0aCB0aGUgc2FtZSBzdHJl
YW0gYW5kIGxpbmsgdGhlbSAqLworCWxpc3RfZm9yX2VhY2hfZW50cnkodywgJmNhcmQtPndpZGdl
dHMsIGxpc3QpIHsKKwkJaWYgKHctPmRhcG0gIT0gZGFpX3ctPmRhcG0pCisJCQljb250aW51ZTsK
KworCQlzd2l0Y2ggKHctPmlkKSB7CisJCWNhc2Ugc25kX3NvY19kYXBtX2RhaV9pbjoKKwkJY2Fz
ZSBzbmRfc29jX2RhcG1fZGFpX291dDoKKwkJCWNvbnRpbnVlOworCQlkZWZhdWx0OgorCQkJYnJl
YWs7CisJCX0KKworCQlpZiAoIXctPnNuYW1lIHx8ICFzdHJzdHIody0+c25hbWUsIGRhaV93LT5z
bmFtZSkpCisJCQljb250aW51ZTsKKworCQkvKgorCQkgKiBjaGVjayBpZiB3aWRnZXQgaXMgYWxy
ZWFkeSBsaW5rZWQsCisJCSAqIGlmICh3LT5saW5rZWQpCisJCSAqCXJldHVybjsKKwkJICovCisK
KwkJaWYgKGRhaV93LT5pZCA9PSBzbmRfc29jX2RhcG1fZGFpX2luKSB7CisJCQlzcmMgPSBkYWlf
dzsKKwkJCXNpbmsgPSB3OworCQl9IGVsc2UgeworCQkJc3JjID0gdzsKKwkJCXNpbmsgPSBkYWlf
dzsKKwkJfQorCQlkZXZfZGJnKGRhaS0+ZGV2LCAiJXMgLT4gJXNcbiIsIHNyYy0+bmFtZSwgc2lu
ay0+bmFtZSk7CisJCS8qIEFkZCB0aGUgREFQTSBwYXRoIGFuZCBzZXQgd2lkZ2V0J3MgbGlua2Vk
IHN0YXR1cworCQkgKiBzbmRfc29jX2RhcG1fYWRkX3BhdGgody0+ZGFwbSwgc3JjLCBzaW5rLCBO
VUxMLCBOVUxMKTsKKwkJICogdy0+bGlua2VkID0gMTsKKwkJICovCisJfQorfQorCitpbnQgZ2Jh
dWRpb19kYXBtX2xpbmtfY29tcG9uZW50X2RhaV93aWRnZXRzKHN0cnVjdCBzbmRfc29jX2NhcmQg
KmNhcmQsCisJCQkJCSAgICBzdHJ1Y3Qgc25kX3NvY19kYXBtX2NvbnRleHQgKmRhcG0pCit7CisJ
c3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKmRhaV93OworCisJLyogRm9yIGVhY2ggREFJIHdp
ZGdldC4uLiAqLworCWxpc3RfZm9yX2VhY2hfZW50cnkoZGFpX3csICZjYXJkLT53aWRnZXRzLCBs
aXN0KSB7CisJCWlmIChkYWlfdy0+ZGFwbSAhPSBkYXBtKQorCQkJY29udGludWU7CisJCXN3aXRj
aCAoZGFpX3ctPmlkKSB7CisJCWNhc2Ugc25kX3NvY19kYXBtX2RhaV9pbjoKKwkJY2FzZSBzbmRf
c29jX2RhcG1fZGFpX291dDoKKwkJCWJyZWFrOworCQlkZWZhdWx0OgorCQkJY29udGludWU7CisJ
CX0KKwkJZ2JhdWRpb19kYXBtX2xpbmtfZGFpX3dpZGdldChkYWlfdywgY2FyZCk7CisJfQorCisJ
cmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGdiYXVkaW9fZGFwbV9mcmVlX3BhdGgoc3RydWN0
IHNuZF9zb2NfZGFwbV9wYXRoICpwYXRoKQoreworCWxpc3RfZGVsKCZwYXRoLT5saXN0X25vZGVb
U05EX1NPQ19EQVBNX0RJUl9JTl0pOworCWxpc3RfZGVsKCZwYXRoLT5saXN0X25vZGVbU05EX1NP
Q19EQVBNX0RJUl9PVVRdKTsKKwlsaXN0X2RlbCgmcGF0aC0+bGlzdF9rY29udHJvbCk7CisJbGlz
dF9kZWwoJnBhdGgtPmxpc3QpOworCWtmcmVlKHBhdGgpOworfQorCitzdGF0aWMgdm9pZCBnYmF1
ZGlvX2RhcG1fZnJlZV93aWRnZXQoc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKncpCit7CisJ
c3RydWN0IHNuZF9zb2NfZGFwbV9wYXRoICpwLCAqbmV4dF9wOworCWVudW0gc25kX3NvY19kYXBt
X2RpcmVjdGlvbiBkaXI7CisKKwlsaXN0X2RlbCgmdy0+bGlzdCk7CisJLyoKKwkgKiByZW1vdmUg
c291cmNlIGFuZCBzaW5rIHBhdGhzIGFzc29jaWF0ZWQgdG8gdGhpcyB3aWRnZXQuCisJICogV2hp
bGUgcmVtb3ZpbmcgdGhlIHBhdGgsIHJlbW92ZSByZWZlcmVuY2UgdG8gaXQgZnJvbSBib3RoCisJ
ICogc291cmNlIGFuZCBzaW5rIHdpZGdldHMgc28gdGhhdCBwYXRoIGlzIHJlbW92ZWQgb25seSBv
bmNlLgorCSAqLworCWdiYXVkaW9fZGFwbV9mb3JfZWFjaF9kaXJlY3Rpb24oZGlyKSB7CisJCXNu
ZF9zb2NfZGFwbV93aWRnZXRfZm9yX2VhY2hfcGF0aF9zYWZlKHcsIGRpciwgcCwgbmV4dF9wKQor
CQkJZ2JhdWRpb19kYXBtX2ZyZWVfcGF0aChwKTsKKwl9CisKKwlrZnJlZSh3LT5rY29udHJvbHMp
OworCWtmcmVlX2NvbnN0KHctPm5hbWUpOworCWtmcmVlX2NvbnN0KHctPnNuYW1lKTsKKwlrZnJl
ZSh3KTsKK30KKworaW50IGdiYXVkaW9fZGFwbV9mcmVlX2NvbnRyb2xzKHN0cnVjdCBzbmRfc29j
X2RhcG1fY29udGV4dCAqZGFwbSwKKwkJCSAgICAgICBjb25zdCBzdHJ1Y3Qgc25kX3NvY19kYXBt
X3dpZGdldCAqd2lkZ2V0LAorCQkJICAgICAgIGludCBudW0pCit7CisJaW50IGk7CisJc3RydWN0
IHNuZF9zb2NfZGFwbV93aWRnZXQgKncsICpuZXh0X3c7CisjaWZkZWYgQ09ORklHX0RFQlVHX0ZT
CisJc3RydWN0IGRlbnRyeSAqcGFyZW50ID0gZGFwbS0+ZGVidWdmc19kYXBtOworCXN0cnVjdCBk
ZW50cnkgKmRlYnVnZnNfdyA9IE5VTEw7CisjZW5kaWYKKworCW11dGV4X2xvY2soJmRhcG0tPmNh
cmQtPmRhcG1fbXV0ZXgpOworCWZvciAoaSA9IDA7IGkgPCBudW07IGkrKykgeworCQkvKiBiZWxv
dyBsb2dpYyBjYW4gYmUgb3B0aW1pemVkIHRvIGlkZW50aWZ5IHdpZGdldCBwb2ludGVyICovCisJ
CWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZSh3LCBuZXh0X3csICZkYXBtLT5jYXJkLT53aWRnZXRz
LAorCQkJCQkgbGlzdCkgeworCQkJaWYgKHctPmRhcG0gIT0gZGFwbSkKKwkJCQljb250aW51ZTsK
KwkJCWlmICghc3RyY21wKHctPm5hbWUsIHdpZGdldC0+bmFtZSkpCisJCQkJYnJlYWs7CisJCQl3
ID0gTlVMTDsKKwkJfQorCQlpZiAoIXcpIHsKKwkJCWRldl9lcnIoZGFwbS0+ZGV2LCAiJXM6IHdp
ZGdldCBub3QgZm91bmRcbiIsCisJCQkJd2lkZ2V0LT5uYW1lKTsKKwkJCXJldHVybiAtRUlOVkFM
OworCQl9CisJCXdpZGdldCsrOworI2lmZGVmIENPTkZJR19ERUJVR19GUworCQlpZiAoIXBhcmVu
dCkKKwkJCWRlYnVnZnNfdyA9IGRlYnVnZnNfbG9va3VwKHctPm5hbWUsIHBhcmVudCk7CisJCWRl
YnVnZnNfcmVtb3ZlKGRlYnVnZnNfdyk7CisJCWRlYnVnZnNfdyA9IE5VTEw7CisjZW5kaWYKKwkJ
Z2JhdWRpb19kYXBtX2ZyZWVfd2lkZ2V0KHcpOworCX0KKwltdXRleF91bmxvY2soJmRhcG0tPmNh
cmQtPmRhcG1fbXV0ZXgpOworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGdiYXVkaW9fcmVt
b3ZlX2NvbnRyb2xzKHN0cnVjdCBzbmRfY2FyZCAqY2FyZCwgc3RydWN0IGRldmljZSAqZGV2LAor
CQkJCSAgIGNvbnN0IHN0cnVjdCBzbmRfa2NvbnRyb2xfbmV3ICpjb250cm9scywKKwkJCQkgICBp
bnQgbnVtX2NvbnRyb2xzLCBjb25zdCBjaGFyICpwcmVmaXgpCit7CisJaW50IGksIGVycjsKKwor
CWZvciAoaSA9IDA7IGkgPCBudW1fY29udHJvbHM7IGkrKykgeworCQljb25zdCBzdHJ1Y3Qgc25k
X2tjb250cm9sX25ldyAqY29udHJvbCA9ICZjb250cm9sc1tpXTsKKwkJc3RydWN0IHNuZF9jdGxf
ZWxlbV9pZCBpZDsKKwkJc3RydWN0IHNuZF9rY29udHJvbCAqa2N0bDsKKworCQlpZiAocHJlZml4
KQorCQkJc25wcmludGYoaWQubmFtZSwgc2l6ZW9mKGlkLm5hbWUpLCAiJXMgJXMiLCBwcmVmaXgs
CisJCQkJIGNvbnRyb2wtPm5hbWUpOworCQllbHNlCisJCQlzdHJsY3B5KGlkLm5hbWUsIGNvbnRy
b2wtPm5hbWUsIHNpemVvZihpZC5uYW1lKSk7CisJCWlkLm51bWlkID0gMDsKKwkJaWQuaWZhY2Ug
PSBjb250cm9sLT5pZmFjZTsKKwkJaWQuZGV2aWNlID0gY29udHJvbC0+ZGV2aWNlOworCQlpZC5z
dWJkZXZpY2UgPSBjb250cm9sLT5zdWJkZXZpY2U7CisJCWlkLmluZGV4ID0gY29udHJvbC0+aW5k
ZXg7CisJCWtjdGwgPSBzbmRfY3RsX2ZpbmRfaWQoY2FyZCwgJmlkKTsKKwkJaWYgKCFrY3RsKSB7
CisJCQlkZXZfZXJyKGRldiwgIiVkOiBGYWlsZWQgdG8gZmluZCAlc1xuIiwgZXJyLAorCQkJCWNv
bnRyb2wtPm5hbWUpOworCQkJcmV0dXJuIC1FTk9FTlQ7CisJCX0KKwkJZXJyID0gc25kX2N0bF9y
ZW1vdmUoY2FyZCwga2N0bCk7CisJCWlmIChlcnIgPCAwKSB7CisJCQlkZXZfZXJyKGRldiwgIiVk
OiBGYWlsZWQgdG8gcmVtb3ZlICVzXG4iLCBlcnIsCisJCQkJY29udHJvbC0+bmFtZSk7CisJCQly
ZXR1cm4gZXJyOworCQl9CisJfQorCXJldHVybiAwOworfQorCitpbnQgZ2JhdWRpb19yZW1vdmVf
Y29tcG9uZW50X2NvbnRyb2xzKHN0cnVjdCBzbmRfc29jX2NvbXBvbmVudCAqY29tcG9uZW50LAor
CQkJCSAgICAgIGNvbnN0IHN0cnVjdCBzbmRfa2NvbnRyb2xfbmV3ICpjb250cm9scywKKwkJCQkg
ICAgICB1bnNpZ25lZCBpbnQgbnVtX2NvbnRyb2xzKQoreworCXN0cnVjdCBzbmRfY2FyZCAqY2Fy
ZCA9IGNvbXBvbmVudC0+Y2FyZC0+c25kX2NhcmQ7CisKKwlyZXR1cm4gZ2JhdWRpb19yZW1vdmVf
Y29udHJvbHMoY2FyZCwgY29tcG9uZW50LT5kZXYsIGNvbnRyb2xzLAorCQkJCSAgICAgICBudW1f
Y29udHJvbHMsIGNvbXBvbmVudC0+bmFtZV9wcmVmaXgpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9zdGFnaW5nL2dyZXlidXMvYXVkaW9faGVscGVyLmggYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1
cy9hdWRpb19oZWxwZXIuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LjVjZjFjNmQ3ZDNlYQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVz
L2F1ZGlvX2hlbHBlci5oCkBAIC0wLDAgKzEsMTcgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wICovCisvKgorICogR3JleWJ1cyBBdWRpbyBTb3VuZCBTb0MgaGVscGVyIEFQ
SXMKKyAqLworCisjaWZuZGVmIF9fTElOVVhfR0JBVURJT19IRUxQRVJfSAorI2RlZmluZSBfX0xJ
TlVYX0dCQVVESU9fSEVMUEVSX0gKKworaW50IGdiYXVkaW9fZGFwbV9saW5rX2NvbXBvbmVudF9k
YWlfd2lkZ2V0cyhzdHJ1Y3Qgc25kX3NvY19jYXJkICpjYXJkLAorCQkJCQkgICAgc3RydWN0IHNu
ZF9zb2NfZGFwbV9jb250ZXh0ICpkYXBtKTsKK2ludCBnYmF1ZGlvX2RhcG1fZnJlZV9jb250cm9s
cyhzdHJ1Y3Qgc25kX3NvY19kYXBtX2NvbnRleHQgKmRhcG0sCisJCQkgICAgICAgY29uc3Qgc3Ry
dWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKndpZGdldCwKKwkJCSAgICAgICBpbnQgbnVtKTsKK2lu
dCBnYmF1ZGlvX3JlbW92ZV9jb21wb25lbnRfY29udHJvbHMoc3RydWN0IHNuZF9zb2NfY29tcG9u
ZW50ICpjb21wb25lbnQsCisJCQkJICAgICAgY29uc3Qgc3RydWN0IHNuZF9rY29udHJvbF9uZXcg
KmNvbnRyb2xzLAorCQkJCSAgICAgIHVuc2lnbmVkIGludCBudW1fY29udHJvbHMpOworI2VuZGlm
Ci0tIAoyLjI2LjIKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmdyZXlidXMtZGV2IG1haWxpbmcgbGlzdApncmV5YnVzLWRldkBsaXN0cy5saW5hcm8ub3Jn
Cmh0dHBzOi8vbGlzdHMubGluYXJvLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2dyZXlidXMtZGV2Cg==
