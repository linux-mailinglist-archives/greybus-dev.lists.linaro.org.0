Return-Path: <greybus-dev-bounces@lists.linaro.org>
X-Original-To: lists+greybus-dev@lfdr.de
Delivered-To: lists+greybus-dev@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 988011F5A6F
	for <lists+greybus-dev@lfdr.de>; Wed, 10 Jun 2020 19:30:10 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id AE7B6664F9
	for <lists+greybus-dev@lfdr.de>; Wed, 10 Jun 2020 17:30:09 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 9AF1F664E8; Wed, 10 Jun 2020 17:30:09 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,DKIM_ADSP_CUSTOM_MED,
	FREEMAIL_FROM,MAILING_LIST_MULTI,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H3,
	RCVD_IN_MSPIKE_WL,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 7BB026197A;
	Wed, 10 Jun 2020 17:29:48 +0000 (UTC)
X-Original-To: greybus-dev@lists.linaro.org
Delivered-To: greybus-dev@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 9007361963
 for <greybus-dev@lists.linaro.org>; Wed, 10 Jun 2020 17:29:45 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 826106192B; Wed, 10 Jun 2020 17:29:45 +0000 (UTC)
Received: from mail-pl1-f194.google.com (mail-pl1-f194.google.com
 [209.85.214.194])
 by lists.linaro.org (Postfix) with ESMTPS id B60676198E
 for <greybus-dev@lists.linaro.org>; Wed, 10 Jun 2020 17:29:27 +0000 (UTC)
Received: by mail-pl1-f194.google.com with SMTP id x11so1205443plv.9
 for <greybus-dev@lists.linaro.org>; Wed, 10 Jun 2020 10:29:27 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=NtbNmsonDMoekdi5axaMguk/gVcbR6PjQHj/vYuOxjU=;
 b=V2Z0uyN3ZNjFejV+s8/gkzLLul5Mi2S9Ua7RJ2WIncBEn5a4AVhl6/GWhj265yluzS
 0k2t5D8iHJGbh6Y1SiRzWoA/Rl1zPgX6PWuID46P8TP5AOLSAzeU54y5R/guplxUC/XY
 Z+sjtF8xK8SiK057qTn08xRLpE/016yPhojshBIbBpgp1nP/lJrMtmDavqdznivPspgs
 5X4laZAtdJ+2S/QOE4qZfU+2uCAA6cv+gTZr04RIMvGuP8EYntZ86UG0yaqzxvvFn7Rv
 ZwcU/WMpr3dnF+8xyHfylZnwO2F7c59I5Xjic8VF/l+RMg5NIHJR695FxgNUbucd7vJE
 p3qQ==
X-Gm-Message-State: AOAM530ZciyVauxvvZpFU8FFgAXh8Fse5xmUlr5aRQNwLgFaYR5JGiXM
 5DK9ZqtIHgormZTrcxoDeCQ=
X-Google-Smtp-Source: ABdhPJwkzJ7/R5LBy0d9NtZ4D2amddsknI0JxJCpfrvGpTDPcyZcSxuoBTOwnuz8K6+OT5WdH0OVhQ==
X-Received: by 2002:a17:90a:7bc3:: with SMTP id
 d3mr3943890pjl.98.1591810166766; 
 Wed, 10 Jun 2020 10:29:26 -0700 (PDT)
Received: from cvds-vagarw7.iind.intel.com ([192.55.54.40])
 by smtp.googlemail.com with ESMTPSA id l83sm490470pfd.150.2020.06.10.10.29.16
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Wed, 10 Jun 2020 10:29:25 -0700 (PDT)
From: Vaibhav Agarwal <vaibhav.sr@gmail.com>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Alex Elder <elder@kernel.org>, Johan Hovold <johan@kernel.org>,
 Mark Greer <mgreer@animalcreek.com>, Takashi Iwai <tiwai@suse.com>,
 Jaroslav Kysela <perex@perex.cz>, Mark Brown <broonie@kernel.org>,
 Liam Girdwood <lgirdwood@gmail.com>
Date: Wed, 10 Jun 2020 22:58:26 +0530
Message-Id: <af932176026ef8f7940cb35f515c9e1b7e5dc69f.1591802243.git.vaibhav.sr@gmail.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <cover.1591802243.git.vaibhav.sr@gmail.com>
References: <cover.1591802243.git.vaibhav.sr@gmail.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: devel@driverdev.osuosl.org, alsa-devel@alsa-project.org,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 linux-kernel@vger.kernel.org, greybus-dev@lists.linaro.org
Subject: [greybus-dev] [PATCH v2 2/6] staging: greybus: audio: Maintain jack
	list within GB Audio module
X-BeenThere: greybus-dev@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: Greybus Development Mail List <greybus-dev.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/greybus-dev/>
List-Post: <mailto:greybus-dev@lists.linaro.org>
List-Help: <mailto:greybus-dev-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: greybus-dev-bounces@lists.linaro.org
Sender: "greybus-dev" <greybus-dev-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

QXMgcGVyIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIGZvciBHQiBjb2RlYyBkcml2ZXIsIGEg
amFjayBsaXN0IGlzCm1haW50YWluZWQgZm9yIGVhY2ggbW9kdWxlLiBBbmQgaXQgZXhwZWN0cyB0
aGUgbGlzdCB0byBiZSBwb3B1bGF0ZWQgYnkKdGhlIHNuZF9zb2NfamFjayBzdHJ1Y3R1cmUgd2hp
Y2ggd291bGQgcmVxdWlyZSBtb2RpZmljYXRpb25zIGluCm1haW5zdHJlYW0gY29kZS4KCkhvd2V2
ZXIsIHRoaXMgaXMgbm90IGEgbmVjZXNzYXJ5IHJlcXVpcmVtZW50IGFuZCB0aGUgbGlzdCBjYW4g
YmUgZWFzaWx5Cm1haW50YWluZWQgd2l0aGluIGdiYXVkaW9fbW9kdWxlX2luZm8gYXMgd2VsbC4g
VGhpcyBwYXRjaCBwcm92aWRlcyB0aGUKcmVsZXZhbnQgY2hhbmdlcyBmb3IgdGhlIHNhbWUuCgpT
aWduZWQtb2ZmLWJ5OiBWYWliaGF2IEFnYXJ3YWwgPHZhaWJoYXYuc3JAZ21haWwuY29tPgotLS0K
IGRyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMgIHwgNzQgKysrKysrKysrKysr
Ky0tLS0tLS0tLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmggIHwg
MTAgKysrLQogZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fbW9kdWxlLmMgfCAxNSArKyst
LS0KIDMgZmlsZXMgY2hhbmdlZCwgNTMgaW5zZXJ0aW9ucygrKSwgNDYgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYyBiL2RyaXZl
cnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMKaW5kZXggNWQzYTVlNmE4ZmU2Li42ZGM0
ZWUyYmZiMzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVj
LmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYwpAQCAtNzEyLDYg
KzcxMiw3IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0IGdiYXVkaW9fbW9k
dWxlX2luZm8gKm1vZHVsZSwKIAkJCSAgICAgc3RydWN0IHNuZF9zb2NfY2FyZCAqY2FyZCkKIHsK
IAlpbnQgcmV0OworCXN0cnVjdCBnYmF1ZGlvX2phY2sgKmphY2ssICpuOwogCXN0cnVjdCBzbmRf
c29jX2phY2tfcGluICpoZWFkc2V0LCAqYnV0dG9uOwogCiAJaWYgKCFtb2R1bGUtPmphY2tfbWFz
aykKQEAgLTcyNiwxNCArNzI3LDE2IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3Ry
dWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSwKIAogCWhlYWRzZXQtPnBpbiA9IG1vZHVs
ZS0+amFja19uYW1lOwogCWhlYWRzZXQtPm1hc2sgPSBtb2R1bGUtPmphY2tfbWFzazsKLQogCXJl
dCA9IHNuZF9zb2NfY2FyZF9qYWNrX25ldyhjYXJkLCBtb2R1bGUtPmphY2tfbmFtZSwgbW9kdWxl
LT5qYWNrX21hc2ssCi0JCQkJICAgICZtb2R1bGUtPmhlYWRzZXRfamFjaywgaGVhZHNldCwgMSk7
CisJCQkJICAgICZtb2R1bGUtPmhlYWRzZXQuamFjaywgaGVhZHNldCwgMSk7CiAJaWYgKHJldCkg
ewogCQlkZXZfZXJyKG1vZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIGNyZWF0ZSBuZXcgamFja1xuIik7
CiAJCXJldHVybiByZXQ7CiAJfQogCisJLyogQWRkIHRvIG1vZHVsZSdzIGphY2sgbGlzdCAqLwor
CWxpc3RfYWRkKCZtb2R1bGUtPmhlYWRzZXQubGlzdCwgJm1vZHVsZS0+amFja19saXN0KTsKKwog
CWlmICghbW9kdWxlLT5idXR0b25fbWFzaykKIAkJcmV0dXJuIDA7CiAKQEAgLTc0MiwyMCArNzQ1
LDIyIEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0IGdiYXVkaW9fbW9kdWxl
X2luZm8gKm1vZHVsZSwKIAlidXR0b24gPSBkZXZtX2t6YWxsb2MobW9kdWxlLT5kZXYsIHNpemVv
ZigqYnV0dG9uKSwgR0ZQX0tFUk5FTCk7CiAJaWYgKCFidXR0b24pIHsKIAkJcmV0ID0gLUVOT01F
TTsKLQkJZ290byBmcmVlX2hlYWRzZXQ7CisJCWdvdG8gZnJlZV9qYWNrczsKIAl9CiAKIAlidXR0
b24tPnBpbiA9IG1vZHVsZS0+YnV0dG9uX25hbWU7CiAJYnV0dG9uLT5tYXNrID0gbW9kdWxlLT5i
dXR0b25fbWFzazsKLQogCXJldCA9IHNuZF9zb2NfY2FyZF9qYWNrX25ldyhjYXJkLCBtb2R1bGUt
PmJ1dHRvbl9uYW1lLAotCQkJCSAgICBtb2R1bGUtPmJ1dHRvbl9tYXNrLCAmbW9kdWxlLT5idXR0
b25famFjaywKKwkJCQkgICAgbW9kdWxlLT5idXR0b25fbWFzaywgJm1vZHVsZS0+YnV0dG9uLmph
Y2ssCiAJCQkJICAgIGJ1dHRvbiwgMSk7CiAJaWYgKHJldCkgewogCQlkZXZfZXJyKG1vZHVsZS0+
ZGV2LCAiRmFpbGVkIHRvIGNyZWF0ZSBidXR0b24gamFja1xuIik7Ci0JCWdvdG8gZnJlZV9oZWFk
c2V0OworCQlnb3RvIGZyZWVfamFja3M7CiAJfQogCisJLyogQWRkIHRvIG1vZHVsZSdzIGphY2sg
bGlzdCAqLworCWxpc3RfYWRkKCZtb2R1bGUtPmJ1dHRvbi5saXN0LCAmbW9kdWxlLT5qYWNrX2xp
c3QpOworCiAJLyoKIAkgKiBDdXJyZW50bHksIG1heCA0IGJ1dHRvbnMgYXJlIHN1cHBvcnRlZCB3
aXRoIGZvbGxvd2luZyBrZXkgbWFwcGluZwogCSAqIEJUTl8wID0gS0VZX01FRElBCkBAIC03NjUs
NTYgKzc3MCw1NCBAQCBzdGF0aWMgaW50IGdiYXVkaW9faW5pdF9qYWNrKHN0cnVjdCBnYmF1ZGlv
X21vZHVsZV9pbmZvICptb2R1bGUsCiAJICovCiAKIAlpZiAobW9kdWxlLT5idXR0b25fbWFzayAm
IFNORF9KQUNLX0JUTl8wKSB7Ci0JCXJldCA9IHNuZF9qYWNrX3NldF9rZXkobW9kdWxlLT5idXR0
b25famFjay5qYWNrLCBTTkRfSkFDS19CVE5fMCwKKwkJcmV0ID0gc25kX2phY2tfc2V0X2tleSht
b2R1bGUtPmJ1dHRvbi5qYWNrLmphY2ssIFNORF9KQUNLX0JUTl8wLAogCQkJCSAgICAgICBLRVlf
TUVESUEpOwogCQlpZiAocmV0KSB7CiAJCQlkZXZfZXJyKG1vZHVsZS0+ZGV2LCAiRmFpbGVkIHRv
IHNldCBCVE5fMFxuIik7Ci0JCQlnb3RvIGZyZWVfYnV0dG9uOworCQkJZ290byBmcmVlX2phY2tz
OwogCQl9CiAJfQogCiAJaWYgKG1vZHVsZS0+YnV0dG9uX21hc2sgJiBTTkRfSkFDS19CVE5fMSkg
ewotCQlyZXQgPSBzbmRfamFja19zZXRfa2V5KG1vZHVsZS0+YnV0dG9uX2phY2suamFjaywgU05E
X0pBQ0tfQlROXzEsCisJCXJldCA9IHNuZF9qYWNrX3NldF9rZXkobW9kdWxlLT5idXR0b24uamFj
ay5qYWNrLCBTTkRfSkFDS19CVE5fMSwKIAkJCQkgICAgICAgS0VZX1ZPSUNFQ09NTUFORCk7CiAJ
CWlmIChyZXQpIHsKIAkJCWRldl9lcnIobW9kdWxlLT5kZXYsICJGYWlsZWQgdG8gc2V0IEJUTl8x
XG4iKTsKLQkJCWdvdG8gZnJlZV9idXR0b247CisJCQlnb3RvIGZyZWVfamFja3M7CiAJCX0KIAl9
CiAKIAlpZiAobW9kdWxlLT5idXR0b25fbWFzayAmIFNORF9KQUNLX0JUTl8yKSB7Ci0JCXJldCA9
IHNuZF9qYWNrX3NldF9rZXkobW9kdWxlLT5idXR0b25famFjay5qYWNrLCBTTkRfSkFDS19CVE5f
MiwKKwkJcmV0ID0gc25kX2phY2tfc2V0X2tleShtb2R1bGUtPmJ1dHRvbi5qYWNrLmphY2ssIFNO
RF9KQUNLX0JUTl8yLAogCQkJCSAgICAgICBLRVlfVk9MVU1FVVApOwogCQlpZiAocmV0KSB7CiAJ
CQlkZXZfZXJyKG1vZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIHNldCBCVE5fMlxuIik7Ci0JCQlnb3Rv
IGZyZWVfYnV0dG9uOworCQkJZ290byBmcmVlX2phY2tzOwogCQl9CiAJfQogCiAJaWYgKG1vZHVs
ZS0+YnV0dG9uX21hc2sgJiBTTkRfSkFDS19CVE5fMykgewotCQlyZXQgPSBzbmRfamFja19zZXRf
a2V5KG1vZHVsZS0+YnV0dG9uX2phY2suamFjaywgU05EX0pBQ0tfQlROXzMsCisJCXJldCA9IHNu
ZF9qYWNrX3NldF9rZXkobW9kdWxlLT5idXR0b24uamFjay5qYWNrLCBTTkRfSkFDS19CVE5fMywK
IAkJCQkgICAgICAgS0VZX1ZPTFVNRURPV04pOwogCQlpZiAocmV0KSB7CiAJCQlkZXZfZXJyKG1v
ZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIHNldCBCVE5fMFxuIik7Ci0JCQlnb3RvIGZyZWVfYnV0dG9u
OworCQkJZ290byBmcmVlX2phY2tzOwogCQl9CiAJfQogCiAJLyogRklYTUUKIAkgKiB2ZXJpZnkg
aWYgdGhpcyBpcyByZWFsbHkgcmVxdWlyZWQKIAlzZXRfYml0KElOUFVUX1BST1BfTk9fRFVNTVlf
UkVMRUFTRSwKLQkJbW9kdWxlLT5idXR0b25famFjay5qYWNrLT5pbnB1dF9kZXYtPnByb3BiaXQp
OworCQltb2R1bGUtPmJ1dHRvbi5qYWNrLmphY2stPmlucHV0X2Rldi0+cHJvcGJpdCk7CiAJKi8K
IAogCXJldHVybiAwOwogCi1mcmVlX2J1dHRvbjoKLQlzbmRfZGV2aWNlX2ZyZWUoY2FyZC0+c25k
X2NhcmQsIG1vZHVsZS0+YnV0dG9uX2phY2suamFjayk7Ci0JbGlzdF9kZWwoJm1vZHVsZS0+YnV0
dG9uX2phY2subGlzdCk7Ci0KLWZyZWVfaGVhZHNldDoKLQlzbmRfZGV2aWNlX2ZyZWUoY2FyZC0+
c25kX2NhcmQsIG1vZHVsZS0+aGVhZHNldF9qYWNrLmphY2spOwotCWxpc3RfZGVsKCZtb2R1bGUt
PmhlYWRzZXRfamFjay5saXN0KTsKK2ZyZWVfamFja3M6CisJbGlzdF9mb3JfZWFjaF9lbnRyeV9z
YWZlKGphY2ssIG4sICZtb2R1bGUtPmphY2tfbGlzdCwgbGlzdCkgeworCQlzbmRfZGV2aWNlX2Zy
ZWUoY2FyZC0+c25kX2NhcmQsIGphY2stPmphY2suamFjayk7CisJCWxpc3RfZGVsKCZqYWNrLT5s
aXN0KTsKKwl9CiAKIAlyZXR1cm4gcmV0OwogfQpAQCAtODI0LDcgKzgyNyw3IEBAIGludCBnYmF1
ZGlvX3JlZ2lzdGVyX21vZHVsZShzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlKQog
CWludCByZXQ7CiAJc3RydWN0IHNuZF9zb2NfY29kZWMgKmNvZGVjOwogCXN0cnVjdCBzbmRfY2Fy
ZCAqY2FyZDsKLQlzdHJ1Y3Qgc25kX3NvY19qYWNrICpqYWNrID0gTlVMTDsKKwlzdHJ1Y3QgZ2Jh
dWRpb19qYWNrICpqYWNrID0gTlVMTDsKIAogCWlmICghZ2Jjb2RlYykgewogCQlkZXZfZXJyKG1v
ZHVsZS0+ZGV2LCAiR0IgQ29kZWMgbm90IHlldCBwcm9iZWRcbiIpOwpAQCAtODY5LDExICs4NzIs
OSBAQCBpbnQgZ2JhdWRpb19yZWdpc3Rlcl9tb2R1bGUoc3RydWN0IGdiYXVkaW9fbW9kdWxlX2lu
Zm8gKm1vZHVsZSkKIAkJICogcmVnaXN0ZXIgamFjayBkZXZpY2VzIGZvciB0aGlzIG1vZHVsZQog
CQkgKiBmcm9tIGNvZGVjLT5qYWNrX2xpc3QKIAkJICovCi0JCWxpc3RfZm9yX2VhY2hfZW50cnko
amFjaywgJmNvZGVjLT5qYWNrX2xpc3QsIGxpc3QpIHsKLQkJCWlmICgoamFjayA9PSAmbW9kdWxl
LT5oZWFkc2V0X2phY2spIHx8Ci0JCQkgICAgKGphY2sgPT0gJm1vZHVsZS0+YnV0dG9uX2phY2sp
KQotCQkJCXNuZF9kZXZpY2VfcmVnaXN0ZXIoY29kZWMtPmNhcmQtPnNuZF9jYXJkLAotCQkJCQkJ
ICAgIGphY2stPmphY2spOworCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGphY2ssICZtb2R1bGUtPmph
Y2tfbGlzdCwgbGlzdCkgeworCQkJc25kX2RldmljZV9yZWdpc3Rlcihjb2RlYy0+Y2FyZC0+c25k
X2NhcmQsCisJCQkJCSAgICBqYWNrLT5qYWNrLmphY2spOwogCQl9CiAjZW5kaWYKIAl9CkBAIC05
NTcsNyArOTU4LDcgQEAgdm9pZCBnYmF1ZGlvX3VucmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1
ZGlvX21vZHVsZV9pbmZvICptb2R1bGUpCiB7CiAJc3RydWN0IHNuZF9zb2NfY29kZWMgKmNvZGVj
ID0gZ2Jjb2RlYy0+Y29kZWM7CiAJc3RydWN0IHNuZF9jYXJkICpjYXJkID0gY29kZWMtPmNhcmQt
PnNuZF9jYXJkOwotCXN0cnVjdCBzbmRfc29jX2phY2sgKmphY2ssICpuZXh0X2o7CisJc3RydWN0
IGdiYXVkaW9famFjayAqamFjaywgKm47CiAJaW50IG1hc2s7CiAKIAlkZXZfZGJnKGNvZGVjLT5k
ZXYsICJVbnJlZ2lzdGVyICVzIG1vZHVsZVxuIiwgbW9kdWxlLT5uYW1lKTsKQEAgLTk3MCwyMCAr
OTcxLDE5IEBAIHZvaWQgZ2JhdWRpb191bnJlZ2lzdGVyX21vZHVsZShzdHJ1Y3QgZ2JhdWRpb19t
b2R1bGVfaW5mbyAqbW9kdWxlKQogCW11dGV4X3VubG9jaygmZ2Jjb2RlYy0+bG9jayk7CiAKICNp
ZmRlZiBDT05GSUdfU05EX0pBQ0sKLQkvKiBmcmVlIGphY2sgZGV2aWNlcyBmb3IgdGhpcyBtb2R1
bGUgZnJvbSBjb2RlYy0+amFja19saXN0ICovCi0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGph
Y2ssIG5leHRfaiwgJmNvbXBvbmVudC0+Y2FyZC0+amFja19saXN0LAotCQkJCSBsaXN0KSB7Ci0J
CWlmIChqYWNrID09ICZtb2R1bGUtPmhlYWRzZXRfamFjaykKKwkvKiBmcmVlIGphY2sgZGV2aWNl
cyBmb3IgdGhpcyBtb2R1bGUgamFja19saXN0ICovCisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZl
KGphY2ssIG4sICZtb2R1bGUtPmphY2tfbGlzdCwgbGlzdCkgeworCQlpZiAoamFjayA9PSAmbW9k
dWxlLT5oZWFkc2V0KQogCQkJbWFzayA9IEdCQ09ERUNfSkFDS19NQVNLOwotCQllbHNlIGlmIChq
YWNrID09ICZtb2R1bGUtPmJ1dHRvbl9qYWNrKQorCQllbHNlIGlmIChqYWNrID09ICZtb2R1bGUt
PmJ1dHRvbikKIAkJCW1hc2sgPSBHQkNPREVDX0pBQ0tfQlVUVE9OX01BU0s7CiAJCWVsc2UKIAkJ
CW1hc2sgPSAwOwogCQlpZiAobWFzaykgewogCQkJZGV2X2RiZyhtb2R1bGUtPmRldiwgIlJlcG9y
dCAlcyByZW1vdmFsXG4iLAotCQkJCWphY2stPmphY2stPmlkKTsKLQkJCXNuZF9zb2NfamFja19y
ZXBvcnQoamFjaywgMCwgbWFzayk7Ci0JCQlzbmRfZGV2aWNlX2ZyZWUoY29kZWMtPmNhcmQtPnNu
ZF9jYXJkLCBqYWNrLT5qYWNrKTsKKwkJCQlqYWNrLT5qYWNrLmphY2stPmlkKTsKKwkJCXNuZF9z
b2NfamFja19yZXBvcnQoJmphY2stPmphY2ssIDAsIG1hc2spOworCQkJc25kX2RldmljZV9mcmVl
KGNvZGVjLT5jYXJkLT5zbmRfY2FyZCwgamFjay0+amFjay5qYWNrKTsKIAkJCWxpc3RfZGVsKCZq
YWNrLT5saXN0KTsKIAkJfQogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVz
L2F1ZGlvX2NvZGVjLmggYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5oCmlu
ZGV4IGNiNWQyNzFkYTFhNS4uYWY5MTk1ZWNlYjNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdp
bmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5oCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1
ZGlvX2NvZGVjLmgKQEAgLTEwNiw2ICsxMDYsMTEgQEAgZW51bSBnYmF1ZGlvX21vZHVsZV9zdGF0
ZSB7CiAJR0JBVURJT19NT0RVTEVfT04sCiB9OwogCitzdHJ1Y3QgZ2JhdWRpb19qYWNrIHsKKwlz
dHJ1Y3Qgc25kX3NvY19qYWNrIGphY2s7CisJc3RydWN0IGxpc3RfaGVhZCBsaXN0OworfTsKKwog
c3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gewogCS8qIG1vZHVsZSBpbmZvICovCiAJc3RydWN0
IGRldmljZSAqZGV2OwpAQCAtMTMwLDggKzEzNSw4IEBAIHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9p
bmZvIHsKIAlpbnQgamFja19tYXNrOwogCWludCBidXR0b25fbWFzazsKIAlpbnQgYnV0dG9uX3N0
YXR1czsKLQlzdHJ1Y3Qgc25kX3NvY19qYWNrIGhlYWRzZXRfamFjazsKLQlzdHJ1Y3Qgc25kX3Nv
Y19qYWNrIGJ1dHRvbl9qYWNrOworCXN0cnVjdCBnYmF1ZGlvX2phY2sgaGVhZHNldDsKKwlzdHJ1
Y3QgZ2JhdWRpb19qYWNrIGJ1dHRvbjsKIAogCS8qIGNvbm5lY3Rpb24gaW5mbyAqLwogCXN0cnVj
dCBnYl9jb25uZWN0aW9uICptZ210X2Nvbm5lY3Rpb247CkBAIC0xNTUsNiArMTYwLDcgQEAgc3Ry
dWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gewogCXN0cnVjdCBsaXN0X2hlYWQgd2lkZ2V0X2xpc3Q7
CiAJc3RydWN0IGxpc3RfaGVhZCBjdGxfbGlzdDsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHdpZGdldF9j
dGxfbGlzdDsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGphY2tfbGlzdDsKIAogCXN0cnVjdCBnYl9hdWRp
b190b3BvbG9neSAqdG9wb2xvZ3k7CiB9OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2dy
ZXlidXMvYXVkaW9fbW9kdWxlLmMgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19tb2R1
bGUuYwppbmRleCAzMDBhMmI0ZjNmYzcuLjE2ZjYwMjU2YWRiMiAxMDA2NDQKLS0tIGEvZHJpdmVy
cy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fbW9kdWxlLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL2dy
ZXlidXMvYXVkaW9fbW9kdWxlLmMKQEAgLTIxLDggKzIxLDggQEAgc3RhdGljIGludCBnYmF1ZGlv
X3JlcXVlc3RfamFjayhzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlLAogCQkJCXN0
cnVjdCBnYl9hdWRpb19qYWNrX2V2ZW50X3JlcXVlc3QgKnJlcSkKIHsKIAlpbnQgcmVwb3J0Owot
CXN0cnVjdCBzbmRfamFjayAqamFjayA9IG1vZHVsZS0+aGVhZHNldF9qYWNrLmphY2s7Ci0Jc3Ry
dWN0IHNuZF9qYWNrICpidG5famFjayA9IG1vZHVsZS0+YnV0dG9uX2phY2suamFjazsKKwlzdHJ1
Y3Qgc25kX2phY2sgKmphY2sgPSBtb2R1bGUtPmhlYWRzZXQuamFjay5qYWNrOworCXN0cnVjdCBz
bmRfamFjayAqYnRuX2phY2sgPSBtb2R1bGUtPmJ1dHRvbi5qYWNrLmphY2s7CiAKIAlpZiAoIWph
Y2spIHsKIAkJZGV2X2Vycl9yYXRlbGltaXRlZChtb2R1bGUtPmRldiwKQEAgLTM4LDExICszOCwx
MSBAQCBzdGF0aWMgaW50IGdiYXVkaW9fcmVxdWVzdF9qYWNrKHN0cnVjdCBnYmF1ZGlvX21vZHVs
ZV9pbmZvICptb2R1bGUsCiAJaWYgKHJlcS0+ZXZlbnQgPT0gR0JfQVVESU9fSkFDS19FVkVOVF9S
RU1PVkFMKSB7CiAJCW1vZHVsZS0+amFja190eXBlID0gMDsKIAkJaWYgKGJ0bl9qYWNrICYmIG1v
ZHVsZS0+YnV0dG9uX3N0YXR1cykgewotCQkJc25kX3NvY19qYWNrX3JlcG9ydCgmbW9kdWxlLT5i
dXR0b25famFjaywgMCwKKwkJCXNuZF9zb2NfamFja19yZXBvcnQoJm1vZHVsZS0+YnV0dG9uLmph
Y2ssIDAsCiAJCQkJCSAgICBtb2R1bGUtPmJ1dHRvbl9tYXNrKTsKIAkJCW1vZHVsZS0+YnV0dG9u
X3N0YXR1cyA9IDA7CiAJCX0KLQkJc25kX3NvY19qYWNrX3JlcG9ydCgmbW9kdWxlLT5oZWFkc2V0
X2phY2ssIDAsCisJCXNuZF9zb2NfamFja19yZXBvcnQoJm1vZHVsZS0+aGVhZHNldC5qYWNrLCAw
LAogCQkJCSAgICBtb2R1bGUtPmphY2tfbWFzayk7CiAJCXJldHVybiAwOwogCX0KQEAgLTYxLDcg
KzYxLDcgQEAgc3RhdGljIGludCBnYmF1ZGlvX3JlcXVlc3RfamFjayhzdHJ1Y3QgZ2JhdWRpb19t
b2R1bGVfaW5mbyAqbW9kdWxlLAogCQkJCSAgICAgbW9kdWxlLT5qYWNrX3R5cGUsIHJlcG9ydCk7
CiAKIAltb2R1bGUtPmphY2tfdHlwZSA9IHJlcG9ydDsKLQlzbmRfc29jX2phY2tfcmVwb3J0KCZt
b2R1bGUtPmhlYWRzZXRfamFjaywgcmVwb3J0LCBtb2R1bGUtPmphY2tfbWFzayk7CisJc25kX3Nv
Y19qYWNrX3JlcG9ydCgmbW9kdWxlLT5oZWFkc2V0LmphY2ssIHJlcG9ydCwgbW9kdWxlLT5qYWNr
X21hc2spOwogCiAJcmV0dXJuIDA7CiB9CkBAIC03MCw3ICs3MCw3IEBAIHN0YXRpYyBpbnQgZ2Jh
dWRpb19yZXF1ZXN0X2J1dHRvbihzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlLAog
CQkJCSAgc3RydWN0IGdiX2F1ZGlvX2J1dHRvbl9ldmVudF9yZXF1ZXN0ICpyZXEpCiB7CiAJaW50
IHNvY19idXR0b25faWQsIHJlcG9ydDsKLQlzdHJ1Y3Qgc25kX2phY2sgKmJ0bl9qYWNrID0gbW9k
dWxlLT5idXR0b25famFjay5qYWNrOworCXN0cnVjdCBzbmRfamFjayAqYnRuX2phY2sgPSBtb2R1
bGUtPmJ1dHRvbi5qYWNrLmphY2s7CiAKIAlpZiAoIWJ0bl9qYWNrKSB7CiAJCWRldl9lcnJfcmF0
ZWxpbWl0ZWQobW9kdWxlLT5kZXYsCkBAIC0xMjQsNyArMTI0LDcgQEAgc3RhdGljIGludCBnYmF1
ZGlvX3JlcXVlc3RfYnV0dG9uKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUsCiAK
IAltb2R1bGUtPmJ1dHRvbl9zdGF0dXMgPSByZXBvcnQ7CiAKLQlzbmRfc29jX2phY2tfcmVwb3J0
KCZtb2R1bGUtPmJ1dHRvbl9qYWNrLCByZXBvcnQsIG1vZHVsZS0+YnV0dG9uX21hc2spOworCXNu
ZF9zb2NfamFja19yZXBvcnQoJm1vZHVsZS0+YnV0dG9uLmphY2ssIHJlcG9ydCwgbW9kdWxlLT5i
dXR0b25fbWFzayk7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTI1OCw2ICsyNTgsNyBAQCBzdGF0aWMg
aW50IGdiX2F1ZGlvX3Byb2JlKHN0cnVjdCBnYl9idW5kbGUgKmJ1bmRsZSwKIAlJTklUX0xJU1Rf
SEVBRCgmZ2Jtb2R1bGUtPndpZGdldF9saXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmZ2Jtb2R1bGUt
PmN0bF9saXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmZ2Jtb2R1bGUtPndpZGdldF9jdGxfbGlzdCk7
CisJSU5JVF9MSVNUX0hFQUQoJmdibW9kdWxlLT5qYWNrX2xpc3QpOwogCWdibW9kdWxlLT5kZXYg
PSBkZXY7CiAJc25wcmludGYoZ2Jtb2R1bGUtPm5hbWUsIE5BTUVfU0laRSwgIiVzLiVzIiwgZGV2
LT5kcml2ZXItPm5hbWUsCiAJCSBkZXZfbmFtZShkZXYpKTsKLS0gCjIuMjYuMgoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZ3JleWJ1cy1kZXYgbWFpbGlu
ZyBsaXN0CmdyZXlidXMtZGV2QGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6Ly9saXN0cy5saW5hcm8u
b3JnL21haWxtYW4vbGlzdGluZm8vZ3JleWJ1cy1kZXYK
