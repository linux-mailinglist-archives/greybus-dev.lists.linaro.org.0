Return-Path: <greybus-dev-bounces@lists.linaro.org>
X-Original-To: lists+greybus-dev@lfdr.de
Delivered-To: lists+greybus-dev@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 967571D6B60
	for <lists+greybus-dev@lfdr.de>; Sun, 17 May 2020 19:20:23 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id BF831607F9
	for <lists+greybus-dev@lfdr.de>; Sun, 17 May 2020 17:20:22 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id B48966083B; Sun, 17 May 2020 17:20:22 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-7.9 required=5.0 tests=BAYES_00,DKIM_ADSP_CUSTOM_MED,
	FREEMAIL_FROM,MAILING_LIST_MULTI,RCVD_IN_DNSWL_HI,RCVD_IN_MSPIKE_H3,
	RCVD_IN_MSPIKE_WL,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 1C5F86173E;
	Sun, 17 May 2020 17:19:07 +0000 (UTC)
X-Original-To: greybus-dev@lists.linaro.org
Delivered-To: greybus-dev@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id A428B60988
 for <greybus-dev@lists.linaro.org>; Sun, 17 May 2020 17:18:48 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 97D1B6083B; Sun, 17 May 2020 17:18:48 +0000 (UTC)
Received: from mail-pj1-f66.google.com (mail-pj1-f66.google.com
 [209.85.216.66])
 by lists.linaro.org (Postfix) with ESMTPS id 830DB60A78
 for <greybus-dev@lists.linaro.org>; Sun, 17 May 2020 17:18:16 +0000 (UTC)
Received: by mail-pj1-f66.google.com with SMTP id a5so3754017pjh.2
 for <greybus-dev@lists.linaro.org>; Sun, 17 May 2020 10:18:16 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:in-reply-to:references;
 bh=RKdhnFcOC5TVG/BAO4zflTRA8bOp2S6+ekpq+ExBLDk=;
 b=ooT7q1w1ccJSk3fA+KPggC8ysOYNYAsjqSPJOWxuN0kRiTksil6ZjTTB7DvJBhRhwH
 AESUdWh9gsUGmATvkQVY9+K1hPWkNrGQ84D0UnFbuzU/FjKVFEWQO0JlWq5Ze+9TssIm
 GbUiw1dbNYi3fW1mC8hHQOLsVkAaWeTIGP2iKvc4KM01ZRW5b/TTR4f8SLatPcHXoaAE
 GqFBhf9XeU+icmqTKPmbKvmgfhO9GnjHw4gbrJ/03J9ocuhYWhmFaHaCzVPKl9cEQN/D
 GdpQSXgCKXDLZalTt0rdRMgpCefw1mMjBUsQ4GVm5KfHbNF0ro15Z8cGa44X+f6xd5pl
 4Xlg==
X-Gm-Message-State: AOAM53066pmYwKeBsR0TKTJ76kgYftvF/EDZdsTSSiqAUxaX+Y0BDUwg
 FiE100oUrSMbwfPkAi6H/14=
X-Google-Smtp-Source: ABdhPJxGsVFmwEjNidWlik7m5mV/Tu7zIeL1vftotkNOr5jb4FUMlyranjvPMTUss3iKHk+goA968Q==
X-Received: by 2002:a17:902:a58b:: with SMTP id
 az11mr2770987plb.172.1589735895601; 
 Sun, 17 May 2020 10:18:15 -0700 (PDT)
Received: from cvds-vagarw7.iind.intel.com (fmdmzpr03-ext.fm.intel.com.
 [192.55.54.38])
 by smtp.googlemail.com with ESMTPSA id n69sm6513900pjc.8.2020.05.17.10.18.08
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Sun, 17 May 2020 10:18:14 -0700 (PDT)
From: Vaibhav Agarwal <vaibhav.sr@gmail.com>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Alex Elder <elder@kernel.org>, Johan Hovold <johan@kernel.org>,
 Mark Greer <mgreer@animalcreek.com>
Date: Sun, 17 May 2020 22:47:20 +0530
Message-Id: <c1339e4d57c8b39bd25197d4514fabd868b829b1.1589734179.git.vaibhav.sr@gmail.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <cover.1589734179.git.vaibhav.sr@gmail.com>
References: <cover.1589734179.git.vaibhav.sr@gmail.com>
In-Reply-To: <cover.1589734179.git.vaibhav.sr@gmail.com>
References: <cover.1589734179.git.vaibhav.sr@gmail.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: devel@driverdev.osuosl.org, greybus-dev@lists.linaro.org,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 linux-kernel@vger.kernel.org
Subject: [greybus-dev] [PATCH V1 5/6] staging: greybus: audio: Add helper
	APIs for dynamic audio modules
X-BeenThere: greybus-dev@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: Greybus Development Mail List <greybus-dev.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/greybus-dev/>
List-Post: <mailto:greybus-dev@lists.linaro.org>
List-Help: <mailto:greybus-dev-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: greybus-dev-bounces@lists.linaro.org
Sender: "greybus-dev" <greybus-dev-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

R3JleWJ1cyBDb2RlYyBkcml2ZXIgYWxsb3dzIG1vZHVsZXMgdG8gYmUgZHluYW1pY2FsbHkgYWRk
ZWQgYW5kIHJlbW92ZWQsCndoaWNoIGZ1cnRoZXIgcmVxdWlyZXMgdXBkYXRpbmcgdGhlIERBUE0g
Y29uZmlndXJhdGlvbnMgYXMgd2VsbC4KCldpdGggY3VycmVudCBzbmRfc29jIGFyY2hpdGVjdHVy
ZSwgZHluYW1pYyBhdWRpbyBtb2R1bGVzIGlzIG5vdCB5ZXQKc3VwcG9ydGVkLiBUaGlzIHBhdGNo
IHByb3ZpZGVzIGhlbHBlciBBUElzIHRvIHVwZGF0ZSBEQVBNIGNvbmZpZ3VyYXRpb25zCmluIHJl
c3BvbnNlIHRvIG1vZHVsZXMgd2hpY2ggYXJlIGR5bmFtaWNhbGx5IGFkZGVkIG9yIHJlbW92ZWQu
IFRoZQpzb3VyY2UgaXMgcHJpbWFyaWx5IGJhc2VkIG9uIHNuZF9kYXBtLmMKClNpZ25lZC1vZmYt
Ynk6IFZhaWJoYXYgQWdhcndhbCA8dmFpYmhhdi5zckBnbWFpbC5jb20+Ci0tLQogZHJpdmVycy9z
dGFnaW5nL2dyZXlidXMvTWFrZWZpbGUgICAgICAgfCAgIDIgKy0KIGRyaXZlcnMvc3RhZ2luZy9n
cmV5YnVzL2F1ZGlvX2NvZGVjLmMgIHwgIDEzICsrLQogZHJpdmVycy9zdGFnaW5nL2dyZXlidXMv
YXVkaW9faGVscGVyLmMgfCAxOTcgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiBk
cml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaCB8ICAxNyArKysKIDQgZmlsZXMg
Y2hhbmdlZCwgMjI0IGluc2VydGlvbnMoKyksIDUgZGVsZXRpb25zKC0pCiBjcmVhdGUgbW9kZSAx
MDA2NDQgZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9faGVscGVyLmMKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaAoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL01ha2VmaWxlIGIvZHJpdmVycy9zdGFnaW5nL2dy
ZXlidXMvTWFrZWZpbGUKaW5kZXggNjI3ZTQ0ZjJhOTgzLi4zYjRiNmNhYmZmMTkgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvc3RhZ2lu
Zy9ncmV5YnVzL01ha2VmaWxlCkBAIC0yOCw3ICsyOCw3IEBAIG9iai0kKENPTkZJR19HUkVZQlVT
X1ZJQlJBVE9SKQkrPSBnYi12aWJyYXRvci5vCiAKICMgR3JleWJ1cyBBdWRpbyBpcyBhIGJ1bmNo
IG9mIG1vZHVsZXMKIGdiLWF1ZGlvLW1vZHVsZS15CTo9IGF1ZGlvX21vZHVsZS5vIGF1ZGlvX3Rv
cG9sb2d5Lm8KLWdiLWF1ZGlvLWNvZGVjLXkJOj0gYXVkaW9fY29kZWMubworZ2ItYXVkaW8tY29k
ZWMteQk6PSBhdWRpb19jb2RlYy5vIGF1ZGlvX2hlbHBlci5vCiBnYi1hdWRpby1nYi15CQk6PSBh
dWRpb19nYi5vCiBnYi1hdWRpby1hcGJyaWRnZWEteQk6PSBhdWRpb19hcGJyaWRnZWEubwogZ2It
YXVkaW8tbWFuYWdlci15CTo9IGF1ZGlvX21hbmFnZXIubyBhdWRpb19tYW5hZ2VyX21vZHVsZS5v
CmRpZmYgLS1naXQgYS9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5jIGIvZHJp
dmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYwppbmRleCBiYmQwNzJhY2RhNWMuLjg2
NmIzMzQyNTE1ZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29k
ZWMuYworKysgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5jCkBAIC0xNCw2
ICsxNCw3IEBACiAjaW5jbHVkZSAiYXVkaW9fY29kZWMuaCIKICNpbmNsdWRlICJhdWRpb19hcGJy
aWRnZWEuaCIKICNpbmNsdWRlICJhdWRpb19tYW5hZ2VyLmgiCisjaW5jbHVkZSAiYXVkaW9faGVs
cGVyLmgiCiAKIHN0YXRpYyBzdHJ1Y3QgZ2JhdWRpb19jb2RlY19pbmZvICpnYmNvZGVjOwogCkBA
IC04NzQsNyArODc1LDcgQEAgaW50IGdiYXVkaW9fcmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1
ZGlvX21vZHVsZV9pbmZvICptb2R1bGUpCiAKIAkvKiBjYXJkIGFscmVhZHkgaW5zdGFudGlhdGVk
LCBjcmVhdGUgd2lkZ2V0cyBoZXJlIG9ubHkgKi8KIAlpZiAoY29tcG9uZW50LT5jYXJkLT5pbnN0
YW50aWF0ZWQpIHsKLQkJc25kX3NvY19kYXBtX2xpbmtfY29tcG9uZW50X2RhaV93aWRnZXRzKGNv
bXBvbmVudC0+Y2FyZCwKKwkJZ2JhdWRpb19kYXBtX2xpbmtfY29tcG9uZW50X2RhaV93aWRnZXRz
KGNvbXBvbmVudC0+Y2FyZCwKIAkJCQkJCQkmY29tcG9uZW50LT5kYXBtKTsKICNpZmRlZiBDT05G
SUdfU05EX0pBQ0sKIAkJLyoKQEAgLTEwMDQsMTkgKzEwMDUsMjMgQEAgdm9pZCBnYmF1ZGlvX3Vu
cmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUpCiAJaWYg
KG1vZHVsZS0+ZGFwbV9yb3V0ZXMpIHsKIAkJZGV2X2RiZyhjb21wb25lbnQtPmRldiwgIlJlbW92
aW5nICVkIHJvdXRlc1xuIiwKIAkJCW1vZHVsZS0+bnVtX2RhcG1fcm91dGVzKTsKKwkJLyogdmVy
aWZ5IHJvdXRlcyB3aXRoIGNvbnRyb2xzIGFyZSByZW1vdmVkICovCiAJCXNuZF9zb2NfZGFwbV9k
ZWxfcm91dGVzKCZjb21wb25lbnQtPmRhcG0sIG1vZHVsZS0+ZGFwbV9yb3V0ZXMsCiAJCQkJCW1v
ZHVsZS0+bnVtX2RhcG1fcm91dGVzKTsKIAl9CiAJaWYgKG1vZHVsZS0+Y29udHJvbHMpIHsKIAkJ
ZGV2X2RiZyhjb21wb25lbnQtPmRldiwgIlJlbW92aW5nICVkIGNvbnRyb2xzXG4iLAogCQkJbW9k
dWxlLT5udW1fY29udHJvbHMpOwotCQlzbmRfc29jX3JlbW92ZV9jb2RlY19jb250cm9scyhjb21w
b25lbnQsIG1vZHVsZS0+Y29udHJvbHMsCi0JCQkJCSAgICAgIG1vZHVsZS0+bnVtX2NvbnRyb2xz
KTsKKwkJLyogcmVsZWFzZSBjb250cm9sIHNlbWFwaG9yZSAqLworCQl1cF93cml0ZSgmY2FyZC0+
Y29udHJvbHNfcndzZW0pOworCQlnYmF1ZGlvX3JlbW92ZV9jb21wb25lbnRfY29udHJvbHMoY29t
cG9uZW50LCBtb2R1bGUtPmNvbnRyb2xzLAorCQkJCQkJICBtb2R1bGUtPm51bV9jb250cm9scyk7
CisJCWRvd25fd3JpdGUoJmNhcmQtPmNvbnRyb2xzX3J3c2VtKTsKIAl9CiAJaWYgKG1vZHVsZS0+
ZGFwbV93aWRnZXRzKSB7CiAJCWRldl9kYmcoY29tcG9uZW50LT5kZXYsICJSZW1vdmluZyAlZCB3
aWRnZXRzXG4iLAogCQkJbW9kdWxlLT5udW1fZGFwbV93aWRnZXRzKTsKLQkJc25kX3NvY19kYXBt
X2ZyZWVfY29udHJvbHMoJmNvbXBvbmVudC0+ZGFwbSwKKwkJZ2JhdWRpb19kYXBtX2ZyZWVfY29u
dHJvbHMoJmNvbXBvbmVudC0+ZGFwbSwKIAkJCQkJICAgbW9kdWxlLT5kYXBtX3dpZGdldHMsCiAJ
CQkJCSAgIG1vZHVsZS0+bnVtX2RhcG1fd2lkZ2V0cyk7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9zdGFnaW5nL2dyZXlidXMvYXVkaW9faGVscGVyLmMgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1
cy9hdWRpb19oZWxwZXIuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LmUyZjExM2E4MTFlZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVz
L2F1ZGlvX2hlbHBlci5jCkBAIC0wLDAgKzEsMTk3IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMAorLyoKKyAqIEdyZXlidXMgQXVkaW8gU291bmQgU29DIGhlbHBlciBBUElz
CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2RlYnVnZnMuaD4KKyNpbmNsdWRlIDxzb3VuZC9jb3Jl
Lmg+CisjaW5jbHVkZSA8c291bmQvc29jLmg+CisjaW5jbHVkZSA8c291bmQvc29jLWRhcG0uaD4K
KworI2RlZmluZSBnYmF1ZGlvX2RhcG1fZm9yX2VhY2hfZGlyZWN0aW9uKGRpcikgXAorCWZvciAo
KGRpcikgPSBTTkRfU09DX0RBUE1fRElSX0lOOyAoZGlyKSA8PSBTTkRfU09DX0RBUE1fRElSX09V
VDsgXAorCQkoZGlyKSsrKQorCitzdGF0aWMgdm9pZCBnYmF1ZGlvX2RhcG1fbGlua19kYWlfd2lk
Z2V0KHN0cnVjdCBzbmRfc29jX2RhcG1fd2lkZ2V0ICpkYWlfdywKKwkJCQkJIHN0cnVjdCBzbmRf
c29jX2NhcmQgKmNhcmQpCit7CisJc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKnc7CisJc3Ry
dWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKnNyYywgKnNpbms7CisJc3RydWN0IHNuZF9zb2NfZGFp
ICpkYWkgPSBkYWlfdy0+cHJpdjsKKworCS8qIC4uLmZpbmQgYWxsIHdpZGdldHMgd2l0aCB0aGUg
c2FtZSBzdHJlYW0gYW5kIGxpbmsgdGhlbSAqLworCWxpc3RfZm9yX2VhY2hfZW50cnkodywgJmNh
cmQtPndpZGdldHMsIGxpc3QpIHsKKwkJaWYgKHctPmRhcG0gIT0gZGFpX3ctPmRhcG0pCisJCQlj
b250aW51ZTsKKworCQlzd2l0Y2ggKHctPmlkKSB7CisJCWNhc2Ugc25kX3NvY19kYXBtX2RhaV9p
bjoKKwkJY2FzZSBzbmRfc29jX2RhcG1fZGFpX291dDoKKwkJCWNvbnRpbnVlOworCQlkZWZhdWx0
OgorCQkJYnJlYWs7CisJCX0KKworCQlpZiAoIXctPnNuYW1lIHx8ICFzdHJzdHIody0+c25hbWUs
IGRhaV93LT5zbmFtZSkpCisJCQljb250aW51ZTsKKworCQkvKgorCQkgKiBjaGVjayBpZiB3aWRn
ZXQgaXMgYWxyZWFkeSBsaW5rZWQsCisJCSAqIGlmICh3LT5saW5rZWQpCisJCSAqCXJldHVybjsK
KwkJICovCisKKwkJaWYgKGRhaV93LT5pZCA9PSBzbmRfc29jX2RhcG1fZGFpX2luKSB7CisJCQlz
cmMgPSBkYWlfdzsKKwkJCXNpbmsgPSB3OworCQl9IGVsc2UgeworCQkJc3JjID0gdzsKKwkJCXNp
bmsgPSBkYWlfdzsKKwkJfQorCQlkZXZfZGJnKGRhaS0+ZGV2LCAiJXMgLT4gJXNcbiIsIHNyYy0+
bmFtZSwgc2luay0+bmFtZSk7CisJCS8qIEFkZCB0aGUgREFQTSBwYXRoIGFuZCBzZXQgd2lkZ2V0
J3MgbGlua2VkIHN0YXR1cworCQkgKiBzbmRfc29jX2RhcG1fYWRkX3BhdGgody0+ZGFwbSwgc3Jj
LCBzaW5rLCBOVUxMLCBOVUxMKTsKKwkJICogdy0+bGlua2VkID0gMTsKKwkJICovCisJfQorfQor
CitpbnQgZ2JhdWRpb19kYXBtX2xpbmtfY29tcG9uZW50X2RhaV93aWRnZXRzKHN0cnVjdCBzbmRf
c29jX2NhcmQgKmNhcmQsCisJCQkJCSAgICBzdHJ1Y3Qgc25kX3NvY19kYXBtX2NvbnRleHQgKmRh
cG0pCit7CisJc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKmRhaV93OworCisJLyogRm9yIGVh
Y2ggREFJIHdpZGdldC4uLiAqLworCWxpc3RfZm9yX2VhY2hfZW50cnkoZGFpX3csICZjYXJkLT53
aWRnZXRzLCBsaXN0KSB7CisJCWlmIChkYWlfdy0+ZGFwbSAhPSBkYXBtKQorCQkJY29udGludWU7
CisJCXN3aXRjaCAoZGFpX3ctPmlkKSB7CisJCWNhc2Ugc25kX3NvY19kYXBtX2RhaV9pbjoKKwkJ
Y2FzZSBzbmRfc29jX2RhcG1fZGFpX291dDoKKwkJCWJyZWFrOworCQlkZWZhdWx0OgorCQkJY29u
dGludWU7CisJCX0KKwkJZ2JhdWRpb19kYXBtX2xpbmtfZGFpX3dpZGdldChkYWlfdywgY2FyZCk7
CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGdiYXVkaW9fZGFwbV9mcmVlX3Bh
dGgoc3RydWN0IHNuZF9zb2NfZGFwbV9wYXRoICpwYXRoKQoreworCWxpc3RfZGVsKCZwYXRoLT5s
aXN0X25vZGVbU05EX1NPQ19EQVBNX0RJUl9JTl0pOworCWxpc3RfZGVsKCZwYXRoLT5saXN0X25v
ZGVbU05EX1NPQ19EQVBNX0RJUl9PVVRdKTsKKwlsaXN0X2RlbCgmcGF0aC0+bGlzdF9rY29udHJv
bCk7CisJbGlzdF9kZWwoJnBhdGgtPmxpc3QpOworCWtmcmVlKHBhdGgpOworfQorCitzdGF0aWMg
dm9pZCBnYmF1ZGlvX2RhcG1fZnJlZV93aWRnZXQoc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQg
KncpCit7CisJc3RydWN0IHNuZF9zb2NfZGFwbV9wYXRoICpwLCAqbmV4dF9wOworCWVudW0gc25k
X3NvY19kYXBtX2RpcmVjdGlvbiBkaXI7CisKKwlsaXN0X2RlbCgmdy0+bGlzdCk7CisJLyoKKwkg
KiByZW1vdmUgc291cmNlIGFuZCBzaW5rIHBhdGhzIGFzc29jaWF0ZWQgdG8gdGhpcyB3aWRnZXQu
CisJICogV2hpbGUgcmVtb3ZpbmcgdGhlIHBhdGgsIHJlbW92ZSByZWZlcmVuY2UgdG8gaXQgZnJv
bSBib3RoCisJICogc291cmNlIGFuZCBzaW5rIHdpZGdldHMgc28gdGhhdCBwYXRoIGlzIHJlbW92
ZWQgb25seSBvbmNlLgorCSAqLworCWdiYXVkaW9fZGFwbV9mb3JfZWFjaF9kaXJlY3Rpb24oZGly
KSB7CisJCXNuZF9zb2NfZGFwbV93aWRnZXRfZm9yX2VhY2hfcGF0aF9zYWZlKHcsIGRpciwgcCwg
bmV4dF9wKQorCQkJZ2JhdWRpb19kYXBtX2ZyZWVfcGF0aChwKTsKKwl9CisKKwlrZnJlZSh3LT5r
Y29udHJvbHMpOworCWtmcmVlX2NvbnN0KHctPm5hbWUpOworCWtmcmVlX2NvbnN0KHctPnNuYW1l
KTsKKwlrZnJlZSh3KTsKK30KKworaW50IGdiYXVkaW9fZGFwbV9mcmVlX2NvbnRyb2xzKHN0cnVj
dCBzbmRfc29jX2RhcG1fY29udGV4dCAqZGFwbSwKKwkJCSAgICAgICBjb25zdCBzdHJ1Y3Qgc25k
X3NvY19kYXBtX3dpZGdldCAqd2lkZ2V0LAorCQkJICAgICAgIGludCBudW0pCit7CisJaW50IGk7
CisJc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKncsICpuZXh0X3c7CisjaWZkZWYgQ09ORklH
X0RFQlVHX0ZTCisJc3RydWN0IGRlbnRyeSAqcGFyZW50ID0gZGFwbS0+ZGVidWdmc19kYXBtOwor
CXN0cnVjdCBkZW50cnkgKmRlYnVnZnNfdyA9IE5VTEw7CisjZW5kaWYKKworCW11dGV4X2xvY2so
JmRhcG0tPmNhcmQtPmRhcG1fbXV0ZXgpOworCWZvciAoaSA9IDA7IGkgPCBudW07IGkrKykgewor
CQkvKiBiZWxvdyBsb2dpYyBjYW4gYmUgb3B0aW1pemVkIHRvIGlkZW50aWZ5IHdpZGdldCBwb2lu
dGVyICovCisJCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZSh3LCBuZXh0X3csICZkYXBtLT5jYXJk
LT53aWRnZXRzLAorCQkJCQkgbGlzdCkgeworCQkJaWYgKHctPmRhcG0gIT0gZGFwbSkKKwkJCQlj
b250aW51ZTsKKwkJCWlmICghc3RyY21wKHctPm5hbWUsIHdpZGdldC0+bmFtZSkpCisJCQkJYnJl
YWs7CisJCQl3ID0gTlVMTDsKKwkJfQorCQlpZiAoIXcpIHsKKwkJCWRldl9lcnIoZGFwbS0+ZGV2
LCAiJXM6IHdpZGdldCBub3QgZm91bmRcbiIsCisJCQkJd2lkZ2V0LT5uYW1lKTsKKwkJCXJldHVy
biAtRUlOVkFMOworCQl9CisJCXdpZGdldCsrOworI2lmZGVmIENPTkZJR19ERUJVR19GUworCQlp
ZiAoIXBhcmVudCkKKwkJCWRlYnVnZnNfdyA9IGRlYnVnZnNfbG9va3VwKHctPm5hbWUsIHBhcmVu
dCk7CisJCWRlYnVnZnNfcmVtb3ZlKGRlYnVnZnNfdyk7CisJCWRlYnVnZnNfdyA9IE5VTEw7Cisj
ZW5kaWYKKwkJZ2JhdWRpb19kYXBtX2ZyZWVfd2lkZ2V0KHcpOworCX0KKwltdXRleF91bmxvY2so
JmRhcG0tPmNhcmQtPmRhcG1fbXV0ZXgpOworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGdi
YXVkaW9fcmVtb3ZlX2NvbnRyb2xzKHN0cnVjdCBzbmRfY2FyZCAqY2FyZCwgc3RydWN0IGRldmlj
ZSAqZGV2LAorCQkJCSAgIGNvbnN0IHN0cnVjdCBzbmRfa2NvbnRyb2xfbmV3ICpjb250cm9scywK
KwkJCQkgICBpbnQgbnVtX2NvbnRyb2xzLCBjb25zdCBjaGFyICpwcmVmaXgpCit7CisJaW50IGks
IGVycjsKKworCWZvciAoaSA9IDA7IGkgPCBudW1fY29udHJvbHM7IGkrKykgeworCQljb25zdCBz
dHJ1Y3Qgc25kX2tjb250cm9sX25ldyAqY29udHJvbCA9ICZjb250cm9sc1tpXTsKKwkJc3RydWN0
IHNuZF9jdGxfZWxlbV9pZCBpZDsKKwkJc3RydWN0IHNuZF9rY29udHJvbCAqa2N0bDsKKworCQlp
ZiAocHJlZml4KQorCQkJc25wcmludGYoaWQubmFtZSwgc2l6ZW9mKGlkLm5hbWUpLCAiJXMgJXMi
LCBwcmVmaXgsCisJCQkJIGNvbnRyb2wtPm5hbWUpOworCQllbHNlCisJCQlzdHJsY3B5KGlkLm5h
bWUsIGNvbnRyb2wtPm5hbWUsIHNpemVvZihpZC5uYW1lKSk7CisJCWlkLm51bWlkID0gMDsKKwkJ
aWQuaWZhY2UgPSBjb250cm9sLT5pZmFjZTsKKwkJaWQuZGV2aWNlID0gY29udHJvbC0+ZGV2aWNl
OworCQlpZC5zdWJkZXZpY2UgPSBjb250cm9sLT5zdWJkZXZpY2U7CisJCWlkLmluZGV4ID0gY29u
dHJvbC0+aW5kZXg7CisJCWtjdGwgPSBzbmRfY3RsX2ZpbmRfaWQoY2FyZCwgJmlkKTsKKwkJaWYg
KCFrY3RsKSB7CisJCQlkZXZfZXJyKGRldiwgIiVkOiBGYWlsZWQgdG8gZmluZCAlc1xuIiwgZXJy
LAorCQkJCWNvbnRyb2wtPm5hbWUpOworCQkJcmV0dXJuIC1FTk9FTlQ7CisJCX0KKwkJZXJyID0g
c25kX2N0bF9yZW1vdmUoY2FyZCwga2N0bCk7CisJCWlmIChlcnIgPCAwKSB7CisJCQlkZXZfZXJy
KGRldiwgIiVkOiBGYWlsZWQgdG8gcmVtb3ZlICVzXG4iLCBlcnIsCisJCQkJY29udHJvbC0+bmFt
ZSk7CisJCQlyZXR1cm4gZXJyOworCQl9CisJfQorCXJldHVybiAwOworfQorCitpbnQgZ2JhdWRp
b19yZW1vdmVfY29tcG9uZW50X2NvbnRyb2xzKHN0cnVjdCBzbmRfc29jX2NvbXBvbmVudCAqY29t
cG9uZW50LAorCQkJCSAgICAgIGNvbnN0IHN0cnVjdCBzbmRfa2NvbnRyb2xfbmV3ICpjb250cm9s
cywKKwkJCQkgICAgICB1bnNpZ25lZCBpbnQgbnVtX2NvbnRyb2xzKQoreworCXN0cnVjdCBzbmRf
Y2FyZCAqY2FyZCA9IGNvbXBvbmVudC0+Y2FyZC0+c25kX2NhcmQ7CisKKwlyZXR1cm4gZ2JhdWRp
b19yZW1vdmVfY29udHJvbHMoY2FyZCwgY29tcG9uZW50LT5kZXYsIGNvbnRyb2xzLAorCQkJCSAg
ICAgICBudW1fY29udHJvbHMsIGNvbXBvbmVudC0+bmFtZV9wcmVmaXgpOworfQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9faGVscGVyLmggYi9kcml2ZXJzL3N0YWdp
bmcvZ3JleWJ1cy9hdWRpb19oZWxwZXIuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAw
MDAwMDAwMDAuLjVjZjFjNmQ3ZDNlYQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvc3RhZ2lu
Zy9ncmV5YnVzL2F1ZGlvX2hlbHBlci5oCkBAIC0wLDAgKzEsMTcgQEAKKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCisvKgorICogR3JleWJ1cyBBdWRpbyBTb3VuZCBTb0Mg
aGVscGVyIEFQSXMKKyAqLworCisjaWZuZGVmIF9fTElOVVhfR0JBVURJT19IRUxQRVJfSAorI2Rl
ZmluZSBfX0xJTlVYX0dCQVVESU9fSEVMUEVSX0gKKworaW50IGdiYXVkaW9fZGFwbV9saW5rX2Nv
bXBvbmVudF9kYWlfd2lkZ2V0cyhzdHJ1Y3Qgc25kX3NvY19jYXJkICpjYXJkLAorCQkJCQkgICAg
c3RydWN0IHNuZF9zb2NfZGFwbV9jb250ZXh0ICpkYXBtKTsKK2ludCBnYmF1ZGlvX2RhcG1fZnJl
ZV9jb250cm9scyhzdHJ1Y3Qgc25kX3NvY19kYXBtX2NvbnRleHQgKmRhcG0sCisJCQkgICAgICAg
Y29uc3Qgc3RydWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKndpZGdldCwKKwkJCSAgICAgICBpbnQg
bnVtKTsKK2ludCBnYmF1ZGlvX3JlbW92ZV9jb21wb25lbnRfY29udHJvbHMoc3RydWN0IHNuZF9z
b2NfY29tcG9uZW50ICpjb21wb25lbnQsCisJCQkJICAgICAgY29uc3Qgc3RydWN0IHNuZF9rY29u
dHJvbF9uZXcgKmNvbnRyb2xzLAorCQkJCSAgICAgIHVuc2lnbmVkIGludCBudW1fY29udHJvbHMp
OworI2VuZGlmCi0tIAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KZ3JleWJ1cy1kZXYgbWFpbGluZyBsaXN0CmdyZXlidXMtZGV2QGxpc3RzLmxp
bmFyby5vcmcKaHR0cHM6Ly9saXN0cy5saW5hcm8ub3JnL21haWxtYW4vbGlzdGluZm8vZ3JleWJ1
cy1kZXYK
