Return-Path: <greybus-dev-bounces@lists.linaro.org>
X-Original-To: lists+greybus-dev@lfdr.de
Delivered-To: lists+greybus-dev@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 350FE1D6B5C
	for <lists+greybus-dev@lfdr.de>; Sun, 17 May 2020 19:18:42 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 5E2C76094E
	for <lists+greybus-dev@lfdr.de>; Sun, 17 May 2020 17:18:41 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 5278160C09; Sun, 17 May 2020 17:18:41 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,DKIM_ADSP_CUSTOM_MED,
	FREEMAIL_FROM,MAILING_LIST_MULTI,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H3,
	RCVD_IN_MSPIKE_WL,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 6693B60988;
	Sun, 17 May 2020 17:18:02 +0000 (UTC)
X-Original-To: greybus-dev@lists.linaro.org
Delivered-To: greybus-dev@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 9494D607F9
 for <greybus-dev@lists.linaro.org>; Sun, 17 May 2020 17:17:57 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 87092608C3; Sun, 17 May 2020 17:17:57 +0000 (UTC)
Received: from mail-pj1-f66.google.com (mail-pj1-f66.google.com
 [209.85.216.66])
 by lists.linaro.org (Postfix) with ESMTPS id 40FC56083B
 for <greybus-dev@lists.linaro.org>; Sun, 17 May 2020 17:17:53 +0000 (UTC)
Received: by mail-pj1-f66.google.com with SMTP id nu7so1210430pjb.0
 for <greybus-dev@lists.linaro.org>; Sun, 17 May 2020 10:17:53 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:in-reply-to:references;
 bh=Rh+BtxpQgxuee3rHBHuMexjfAjQ4Uh29XKClnpfBg5A=;
 b=ARIMoVS+ZmZopZf9Nooi97KHZQ6Gt9h+xdOc25bGme7aQEhe0ctlK4/Bx2EgeSTDQX
 Bg8VO2ithw6UQMw7IvQUocmSP0uQhxJQHAbQw8VoGuignAQNMZ1WkB748mr06fi+PED0
 UR9/hdxUqngUAfaisnwA1fMw2RdpayzghVa5ugfnY0WIAVH7hA782gnjjRvuiKcOn5OW
 7gvPlkra1DLfzQfe3t/XBSL2B/6zloH3uAcCBkB7mE0pgMcB1qe+UdATdB2qoMQrX+6X
 OnOGr42AVUwKple4XxFESRhSKGH+09Qomd/9rHSyo7NJDZFRYo6pGY/7o3cqIH0pXt9k
 lW/w==
X-Gm-Message-State: AOAM532jQtoIa3jf2PmWqQtoWB9imsJInED4nYQMPiKhe5V6blJhRQ6I
 og2URDu67drWGoudSPRJoYE=
X-Google-Smtp-Source: ABdhPJzjGDxKUZqiujPm5KZrdCVkSsEQAEsODGwIB75Z5IIyqPQQgr3qAFN1Tx8U2TOuO6aMbMsl5g==
X-Received: by 2002:a17:90a:20cf:: with SMTP id
 f73mr15190170pjg.86.1589735872335; 
 Sun, 17 May 2020 10:17:52 -0700 (PDT)
Received: from cvds-vagarw7.iind.intel.com (fmdmzpr03-ext.fm.intel.com.
 [192.55.54.38])
 by smtp.googlemail.com with ESMTPSA id n69sm6513900pjc.8.2020.05.17.10.17.45
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Sun, 17 May 2020 10:17:51 -0700 (PDT)
From: Vaibhav Agarwal <vaibhav.sr@gmail.com>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Alex Elder <elder@kernel.org>, Johan Hovold <johan@kernel.org>,
 Mark Greer <mgreer@animalcreek.com>
Date: Sun, 17 May 2020 22:47:17 +0530
Message-Id: <ccb39352a30ab39df1534efafc9415aa89b156fa.1589734179.git.vaibhav.sr@gmail.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <cover.1589734179.git.vaibhav.sr@gmail.com>
References: <cover.1589734179.git.vaibhav.sr@gmail.com>
In-Reply-To: <cover.1589734179.git.vaibhav.sr@gmail.com>
References: <cover.1589734179.git.vaibhav.sr@gmail.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: devel@driverdev.osuosl.org, greybus-dev@lists.linaro.org,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 linux-kernel@vger.kernel.org
Subject: [greybus-dev] [PATCH V1 2/6] staging: greybus: audio: Maintain jack
	list within GB Audio module
X-BeenThere: greybus-dev@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: Greybus Development Mail List <greybus-dev.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/greybus-dev/>
List-Post: <mailto:greybus-dev@lists.linaro.org>
List-Help: <mailto:greybus-dev-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: greybus-dev-bounces@lists.linaro.org
Sender: "greybus-dev" <greybus-dev-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

QXMgcGVyIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIGZvciBHQiBjb2RlYyBkcml2ZXIsIGEg
amFjayBsaXN0IGlzCm1haW50YWluZWQgZm9yIGVhY2ggbW9kdWxlLiBBbmQgaXQgZXhwZWN0cyB0
aGUgbGlzdCB0byBiZSBwb3B1bGF0ZWQgYnkKdGhlIHNuZF9zb2NfamFjayBzdHJ1Y3R1cmUgd2hp
Y2ggd291bGQgcmVxdWlyZSBtb2RpZmljYXRpb25zIGluCm1haW5zdHJlYW0gY29kZS4KCkhvd2V2
ZXIsIHRoaXMgaXMgbm90IGEgbmVjZXNzYXJ5IHJlcXVpcmVtZW50IGFuZCB0aGUgbGlzdCBjYW4g
YmUgZWFzaWx5Cm1haW50YWluZWQgd2l0aGluIGdiYXVkaW9fbW9kdWxlX2luZm8gYXMgd2VsbC4g
VGhpcyBwYXRjaCBwcm92aWRlcyB0aGUKcmVsZXZhbnQgY2hhbmdlcyBmb3IgdGhlIHNhbWUuCgpT
aWduZWQtb2ZmLWJ5OiBWYWliaGF2IEFnYXJ3YWwgPHZhaWJoYXYuc3JAZ21haWwuY29tPgotLS0K
IGRyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMgIHwgNzYgKysrKysrKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29k
ZWMuaCAgfCAxMCArKysrLQogZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fbW9kdWxlLmMg
fCAyMCArKysrKy0tLS0KIDMgZmlsZXMgY2hhbmdlZCwgNjAgaW5zZXJ0aW9ucygrKSwgNDYgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29k
ZWMuYyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMKaW5kZXggZWJmODQ4
NGYwYWU3Li5hMmVlNTg3ZTVhNzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVz
L2F1ZGlvX2NvZGVjLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMu
YwpAQCAtNzEyLDcgKzcxMiw3IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0
IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSwKIAkJCSAgICAgc3RydWN0IHNuZF9zb2NfY2Fy
ZCAqY2FyZCkKIHsKIAlpbnQgcmV0OwotCisJc3RydWN0IGdiYXVkaW9famFjayAqZ2JhX2phY2ss
ICpuOwogCXN0cnVjdCBzbmRfc29jX2phY2sgKmphY2s7CiAJc3RydWN0IHNuZF9zb2NfamFja19w
aW4gKmhlYWRzZXQsICpidXR0b247CiAKQEAgLTcyOCw3ICs3MjgsOCBAQCBzdGF0aWMgaW50IGdi
YXVkaW9faW5pdF9qYWNrKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUsCiAKIAlo
ZWFkc2V0LT5waW4gPSBtb2R1bGUtPmphY2tfbmFtZTsKIAloZWFkc2V0LT5tYXNrID0gbW9kdWxl
LT5qYWNrX21hc2s7Ci0JamFjayA9ICZtb2R1bGUtPmhlYWRzZXRfamFjazsKKwlnYmFfamFjayA9
ICZtb2R1bGUtPmhlYWRzZXQ7CisJamFjayA9ICZnYmFfamFjay0+amFjazsKIAogCXJldCA9IHNu
ZF9zb2NfY2FyZF9qYWNrX25ldyhjYXJkLCBtb2R1bGUtPmphY2tfbmFtZSwgbW9kdWxlLT5qYWNr
X21hc2ssCiAJCQkJICAgIGphY2ssIGhlYWRzZXQsIDEpOwpAQCAtNzM3LDYgKzczOCw5IEBAIHN0
YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1v
ZHVsZSwKIAkJcmV0dXJuIHJldDsKIAl9CiAKKwkvKiBBZGQgdG8gbW9kdWxlJ3MgamFjayBsaXN0
ICovCisJbGlzdF9hZGQoJmdiYV9qYWNrLT5saXN0LCAmbW9kdWxlLT5qYWNrX2xpc3QpOworCiAJ
aWYgKCFtb2R1bGUtPmJ1dHRvbl9tYXNrKQogCQlyZXR1cm4gMDsKIApAQCAtNzQ1LDIwICs3NDks
MjQgQEAgc3RhdGljIGludCBnYmF1ZGlvX2luaXRfamFjayhzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVf
aW5mbyAqbW9kdWxlLAogCWJ1dHRvbiA9IGRldm1fa3phbGxvYyhtb2R1bGUtPmRldiwgc2l6ZW9m
KCpoZWFkc2V0KSwgR0ZQX0tFUk5FTCk7CiAJaWYgKCFidXR0b24pIHsKIAkJcmV0ID0gLUVOT01F
TTsKLQkJZ290byBmcmVlX2hlYWRzZXQ7CisJCWdvdG8gZnJlZV9qYWNrOwogCX0KIAogCWJ1dHRv
bi0+cGluID0gbW9kdWxlLT5idXR0b25fbmFtZTsKIAlidXR0b24tPm1hc2sgPSBtb2R1bGUtPmJ1
dHRvbl9tYXNrOwotCWphY2sgPSAmbW9kdWxlLT5idXR0b25famFjazsKKwlnYmFfamFjayA9ICZt
b2R1bGUtPmJ1dHRvbjsKKwlqYWNrID0gJmdiYV9qYWNrLT5qYWNrOwogCiAJcmV0ID0gc25kX3Nv
Y19jYXJkX2phY2tfbmV3KGNhcmQsIG1vZHVsZS0+YnV0dG9uX25hbWUsCiAJCQkJICAgIG1vZHVs
ZS0+YnV0dG9uX21hc2ssIGphY2ssIGJ1dHRvbiwgMSk7CiAJaWYgKHJldCkgewogCQlkZXZfZXJy
KG1vZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIGNyZWF0ZSBidXR0b24gamFja1xuIik7Ci0JCWdvdG8g
ZnJlZV9oZWFkc2V0OworCQlnb3RvIGZyZWVfamFjazsKIAl9CiAKKwkvKiBBZGQgdG8gbW9kdWxl
J3MgamFjayBsaXN0ICovCisJbGlzdF9hZGQoJmdiYV9qYWNrLT5saXN0LCAmbW9kdWxlLT5qYWNr
X2xpc3QpOworCiAJLyoKIAkgKiBDdXJyZW50bHksIG1heCA0IGJ1dHRvbnMgYXJlIHN1cHBvcnRl
ZCB3aXRoIGZvbGxvd2luZyBrZXkgbWFwcGluZwogCSAqIEJUTl8wID0gS0VZX01FRElBCkBAIC03
NjgsNTggKzc3Niw1NSBAQCBzdGF0aWMgaW50IGdiYXVkaW9faW5pdF9qYWNrKHN0cnVjdCBnYmF1
ZGlvX21vZHVsZV9pbmZvICptb2R1bGUsCiAJICovCiAKIAlpZiAobW9kdWxlLT5idXR0b25fbWFz
ayAmIFNORF9KQUNLX0JUTl8wKSB7Ci0JCXJldCA9IHNuZF9qYWNrX3NldF9rZXkobW9kdWxlLT5i
dXR0b25famFjay5qYWNrLCBTTkRfSkFDS19CVE5fMCwKKwkJcmV0ID0gc25kX2phY2tfc2V0X2tl
eShqYWNrLT5qYWNrLCBTTkRfSkFDS19CVE5fMCwKIAkJCQkgICAgICAgS0VZX01FRElBKTsKIAkJ
aWYgKHJldCkgewogCQkJZGV2X2Vycihtb2R1bGUtPmRldiwgIkZhaWxlZCB0byBzZXQgQlROXzBc
biIpOwotCQkJZ290byBmcmVlX2J1dHRvbjsKKwkJCWdvdG8gZnJlZV9qYWNrOwogCQl9CiAJfQog
CiAJaWYgKG1vZHVsZS0+YnV0dG9uX21hc2sgJiBTTkRfSkFDS19CVE5fMSkgewotCQlyZXQgPSBz
bmRfamFja19zZXRfa2V5KG1vZHVsZS0+YnV0dG9uX2phY2suamFjaywgU05EX0pBQ0tfQlROXzEs
CisJCXJldCA9IHNuZF9qYWNrX3NldF9rZXkoamFjay0+amFjaywgU05EX0pBQ0tfQlROXzEsCiAJ
CQkJICAgICAgIEtFWV9WT0lDRUNPTU1BTkQpOwogCQlpZiAocmV0KSB7CiAJCQlkZXZfZXJyKG1v
ZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIHNldCBCVE5fMVxuIik7Ci0JCQlnb3RvIGZyZWVfYnV0dG9u
OworCQkJZ290byBmcmVlX2phY2s7CiAJCX0KIAl9CiAKIAlpZiAobW9kdWxlLT5idXR0b25fbWFz
ayAmIFNORF9KQUNLX0JUTl8yKSB7Ci0JCXJldCA9IHNuZF9qYWNrX3NldF9rZXkobW9kdWxlLT5i
dXR0b25famFjay5qYWNrLCBTTkRfSkFDS19CVE5fMiwKKwkJcmV0ID0gc25kX2phY2tfc2V0X2tl
eShqYWNrLT5qYWNrLCBTTkRfSkFDS19CVE5fMiwKIAkJCQkgICAgICAgS0VZX1ZPTFVNRVVQKTsK
IAkJaWYgKHJldCkgewogCQkJZGV2X2Vycihtb2R1bGUtPmRldiwgIkZhaWxlZCB0byBzZXQgQlRO
XzJcbiIpOwotCQkJZ290byBmcmVlX2J1dHRvbjsKKwkJCWdvdG8gZnJlZV9qYWNrOwogCQl9CiAJ
fQogCiAJaWYgKG1vZHVsZS0+YnV0dG9uX21hc2sgJiBTTkRfSkFDS19CVE5fMykgewotCQlyZXQg
PSBzbmRfamFja19zZXRfa2V5KG1vZHVsZS0+YnV0dG9uX2phY2suamFjaywgU05EX0pBQ0tfQlRO
XzMsCisJCXJldCA9IHNuZF9qYWNrX3NldF9rZXkoamFjay0+amFjaywgU05EX0pBQ0tfQlROXzMs
CiAJCQkJICAgICAgIEtFWV9WT0xVTUVET1dOKTsKIAkJaWYgKHJldCkgewogCQkJZGV2X2Vyciht
b2R1bGUtPmRldiwgIkZhaWxlZCB0byBzZXQgQlROXzBcbiIpOwotCQkJZ290byBmcmVlX2J1dHRv
bjsKKwkJCWdvdG8gZnJlZV9qYWNrOwogCQl9CiAJfQogCiAJLyogRklYTUUKIAkgKiB2ZXJpZnkg
aWYgdGhpcyBpcyByZWFsbHkgcmVxdWlyZWQKIAlzZXRfYml0KElOUFVUX1BST1BfTk9fRFVNTVlf
UkVMRUFTRSwKLQkJbW9kdWxlLT5idXR0b25famFjay5qYWNrLT5pbnB1dF9kZXYtPnByb3BiaXQp
OworCQltb2R1bGUtPmJ1dHRvbi0+amFjay0+amFjay0+aW5wdXRfZGV2LT5wcm9wYml0KTsKIAkq
LwogCiAJcmV0dXJuIDA7CiAKLWZyZWVfYnV0dG9uOgotCWphY2sgPSAmbW9kdWxlLT5idXR0b25f
amFjazsKLQlzbmRfZGV2aWNlX2ZyZWUoY2FyZC0+c25kX2NhcmQsIGphY2stPmphY2spOwotCWxp
c3RfZGVsKCZqYWNrLT5saXN0KTsKLQotZnJlZV9oZWFkc2V0OgotCWphY2sgPSAmbW9kdWxlLT5o
ZWFkc2V0X2phY2s7Ci0Jc25kX2RldmljZV9mcmVlKGNhcmQtPnNuZF9jYXJkLCBqYWNrLT5qYWNr
KTsKLQlsaXN0X2RlbCgmamFjay0+bGlzdCk7CitmcmVlX2phY2s6CisJbGlzdF9mb3JfZWFjaF9l
bnRyeV9zYWZlKGdiYV9qYWNrLCBuLCAmbW9kdWxlLT5qYWNrX2xpc3QsIGxpc3QpIHsKKwkJamFj
ayA9ICZnYmFfamFjay0+amFjazsKKwkJc25kX2RldmljZV9mcmVlKGNhcmQtPnNuZF9jYXJkLCBq
YWNrLT5qYWNrKTsKKwkJbGlzdF9kZWwoJmdiYV9qYWNrLT5saXN0KTsKKwl9CiAKIAlyZXR1cm4g
cmV0OwogfQpAQCAtODI5LDYgKzgzNCw3IEBAIGludCBnYmF1ZGlvX3JlZ2lzdGVyX21vZHVsZShz
dHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlKQogCWludCByZXQ7CiAJc3RydWN0IHNu
ZF9zb2NfY29kZWMgKmNvZGVjOwogCXN0cnVjdCBzbmRfY2FyZCAqY2FyZDsKKwlzdHJ1Y3QgZ2Jh
dWRpb19qYWNrICpnYmFfamFjayA9IE5VTEw7CiAJc3RydWN0IHNuZF9zb2NfamFjayAqamFjayA9
IE5VTEw7CiAKIAlpZiAoIWdiY29kZWMpIHsKQEAgLTg3NCwxMSArODgwLDEwIEBAIGludCBnYmF1
ZGlvX3JlZ2lzdGVyX21vZHVsZShzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlKQog
CQkgKiByZWdpc3RlciBqYWNrIGRldmljZXMgZm9yIHRoaXMgbW9kdWxlCiAJCSAqIGZyb20gY29k
ZWMtPmphY2tfbGlzdAogCQkgKi8KLQkJbGlzdF9mb3JfZWFjaF9lbnRyeShqYWNrLCAmY29kZWMt
PmphY2tfbGlzdCwgbGlzdCkgewotCQkJaWYgKChqYWNrID09ICZtb2R1bGUtPmhlYWRzZXRfamFj
aykgfHwKLQkJCSAgICAoamFjayA9PSAmbW9kdWxlLT5idXR0b25famFjaykpCi0JCQkJc25kX2Rl
dmljZV9yZWdpc3Rlcihjb2RlYy0+Y2FyZC0+c25kX2NhcmQsCi0JCQkJCQkgICAgamFjay0+amFj
ayk7CisJCWxpc3RfZm9yX2VhY2hfZW50cnkoZ2JhX2phY2ssICZtb2R1bGUtPmphY2tfbGlzdCwg
bGlzdCkgeworCQkJamFjayA9ICZnYmFfamFjay0+amFjazsKKwkJCXNuZF9kZXZpY2VfcmVnaXN0
ZXIoY29kZWMtPmNhcmQtPnNuZF9jYXJkLAorCQkJCQkgICAgamFjay0+amFjayk7CiAJCX0KICNl
bmRpZgogCX0KQEAgLTk2Miw3ICs5NjcsOCBAQCB2b2lkIGdiYXVkaW9fdW5yZWdpc3Rlcl9tb2R1
bGUoc3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSkKIHsKIAlzdHJ1Y3Qgc25kX3Nv
Y19jb2RlYyAqY29kZWMgPSBnYmNvZGVjLT5jb2RlYzsKIAlzdHJ1Y3Qgc25kX2NhcmQgKmNhcmQg
PSBjb2RlYy0+Y2FyZC0+c25kX2NhcmQ7Ci0Jc3RydWN0IHNuZF9zb2NfamFjayAqamFjaywgKm5l
eHRfajsKKwlzdHJ1Y3QgZ2JhdWRpb19qYWNrICpnYmFfamFjaywgKm47CisJc3RydWN0IHNuZF9z
b2NfamFjayAqamFjazsKIAlpbnQgbWFzazsKIAogCWRldl9kYmcoY29kZWMtPmRldiwgIlVucmVn
aXN0ZXIgJXMgbW9kdWxlXG4iLCBtb2R1bGUtPm5hbWUpOwpAQCAtOTc1LDIxICs5ODEsMjEgQEAg
dm9pZCBnYmF1ZGlvX3VucmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZv
ICptb2R1bGUpCiAJbXV0ZXhfdW5sb2NrKCZnYmNvZGVjLT5sb2NrKTsKIAogI2lmZGVmIENPTkZJ
R19TTkRfSkFDSwotCS8qIGZyZWUgamFjayBkZXZpY2VzIGZvciB0aGlzIG1vZHVsZSBmcm9tIGNv
ZGVjLT5qYWNrX2xpc3QgKi8KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoamFjaywgbmV4dF9q
LCAmY29tcG9uZW50LT5jYXJkLT5qYWNrX2xpc3QsCi0JCQkJIGxpc3QpIHsKLQkJaWYgKGphY2sg
PT0gJm1vZHVsZS0+aGVhZHNldF9qYWNrKQorCS8qIGZyZWUgamFjayBkZXZpY2VzIGZvciB0aGlz
IG1vZHVsZSBqYWNrX2xpc3QgKi8KKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoZ2JhX2phY2ss
IG4sICZtb2R1bGUtPmphY2tfbGlzdCwgbGlzdCkgeworCQlpZiAoZ2JhX2phY2sgPT0gJm1vZHVs
ZS0+aGVhZHNldCkKIAkJCW1hc2sgPSBHQkNPREVDX0pBQ0tfTUFTSzsKLQkJZWxzZSBpZiAoamFj
ayA9PSAmbW9kdWxlLT5idXR0b25famFjaykKKwkJZWxzZSBpZiAoZ2JhX2phY2sgPT0gJm1vZHVs
ZS0+YnV0dG9uKQogCQkJbWFzayA9IEdCQ09ERUNfSkFDS19CVVRUT05fTUFTSzsKIAkJZWxzZQog
CQkJbWFzayA9IDA7CiAJCWlmIChtYXNrKSB7CisJCQlqYWNrID0gJmdiYV9qYWNrLT5qYWNrOwog
CQkJZGV2X2RiZyhtb2R1bGUtPmRldiwgIlJlcG9ydCAlcyByZW1vdmFsXG4iLAogCQkJCWphY2st
PmphY2stPmlkKTsKIAkJCXNuZF9zb2NfamFja19yZXBvcnQoamFjaywgMCwgbWFzayk7CiAJCQlz
bmRfZGV2aWNlX2ZyZWUoY29kZWMtPmNhcmQtPnNuZF9jYXJkLCBqYWNrLT5qYWNrKTsKLQkJCWxp
c3RfZGVsKCZqYWNrLT5saXN0KTsKKwkJCWxpc3RfZGVsKCZnYmFfamFjay0+bGlzdCk7CiAJCX0K
IAl9CiAjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2Nv
ZGVjLmggYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5oCmluZGV4IGNiNWQy
NzFkYTFhNS4uYWY5MTk1ZWNlYjNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1
cy9hdWRpb19jb2RlYy5oCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVj
LmgKQEAgLTEwNiw2ICsxMDYsMTEgQEAgZW51bSBnYmF1ZGlvX21vZHVsZV9zdGF0ZSB7CiAJR0JB
VURJT19NT0RVTEVfT04sCiB9OwogCitzdHJ1Y3QgZ2JhdWRpb19qYWNrIHsKKwlzdHJ1Y3Qgc25k
X3NvY19qYWNrIGphY2s7CisJc3RydWN0IGxpc3RfaGVhZCBsaXN0OworfTsKKwogc3RydWN0IGdi
YXVkaW9fbW9kdWxlX2luZm8gewogCS8qIG1vZHVsZSBpbmZvICovCiAJc3RydWN0IGRldmljZSAq
ZGV2OwpAQCAtMTMwLDggKzEzNSw4IEBAIHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZvIHsKIAlp
bnQgamFja19tYXNrOwogCWludCBidXR0b25fbWFzazsKIAlpbnQgYnV0dG9uX3N0YXR1czsKLQlz
dHJ1Y3Qgc25kX3NvY19qYWNrIGhlYWRzZXRfamFjazsKLQlzdHJ1Y3Qgc25kX3NvY19qYWNrIGJ1
dHRvbl9qYWNrOworCXN0cnVjdCBnYmF1ZGlvX2phY2sgaGVhZHNldDsKKwlzdHJ1Y3QgZ2JhdWRp
b19qYWNrIGJ1dHRvbjsKIAogCS8qIGNvbm5lY3Rpb24gaW5mbyAqLwogCXN0cnVjdCBnYl9jb25u
ZWN0aW9uICptZ210X2Nvbm5lY3Rpb247CkBAIC0xNTUsNiArMTYwLDcgQEAgc3RydWN0IGdiYXVk
aW9fbW9kdWxlX2luZm8gewogCXN0cnVjdCBsaXN0X2hlYWQgd2lkZ2V0X2xpc3Q7CiAJc3RydWN0
IGxpc3RfaGVhZCBjdGxfbGlzdDsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHdpZGdldF9jdGxfbGlzdDsK
KwlzdHJ1Y3QgbGlzdF9oZWFkIGphY2tfbGlzdDsKIAogCXN0cnVjdCBnYl9hdWRpb190b3BvbG9n
eSAqdG9wb2xvZ3k7CiB9OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVk
aW9fbW9kdWxlLmMgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19tb2R1bGUuYwppbmRl
eCAzMDBhMmI0ZjNmYzcuLmNkZDRiNmJlNWU5YyAxMDA2NDQKLS0tIGEvZHJpdmVycy9zdGFnaW5n
L2dyZXlidXMvYXVkaW9fbW9kdWxlLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVk
aW9fbW9kdWxlLmMKQEAgLTIxLDggKzIxLDEwIEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19yZXF1ZXN0
X2phY2soc3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSwKIAkJCQlzdHJ1Y3QgZ2Jf
YXVkaW9famFja19ldmVudF9yZXF1ZXN0ICpyZXEpCiB7CiAJaW50IHJlcG9ydDsKLQlzdHJ1Y3Qg
c25kX2phY2sgKmphY2sgPSBtb2R1bGUtPmhlYWRzZXRfamFjay5qYWNrOwotCXN0cnVjdCBzbmRf
amFjayAqYnRuX2phY2sgPSBtb2R1bGUtPmJ1dHRvbl9qYWNrLmphY2s7CisJc3RydWN0IHNuZF9z
b2NfamFjayAqaHMgPSAmbW9kdWxlLT5oZWFkc2V0LmphY2s7CisJc3RydWN0IHNuZF9zb2NfamFj
ayAqYnRuID0gJm1vZHVsZS0+YnV0dG9uLmphY2s7CisJc3RydWN0IHNuZF9qYWNrICpqYWNrID0g
aHMtPmphY2s7CisJc3RydWN0IHNuZF9qYWNrICpidG5famFjayA9IGJ0bi0+amFjazsKIAogCWlm
ICghamFjaykgewogCQlkZXZfZXJyX3JhdGVsaW1pdGVkKG1vZHVsZS0+ZGV2LApAQCAtMzgsMTIg
KzQwLDEwIEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19yZXF1ZXN0X2phY2soc3RydWN0IGdiYXVkaW9f
bW9kdWxlX2luZm8gKm1vZHVsZSwKIAlpZiAocmVxLT5ldmVudCA9PSBHQl9BVURJT19KQUNLX0VW
RU5UX1JFTU9WQUwpIHsKIAkJbW9kdWxlLT5qYWNrX3R5cGUgPSAwOwogCQlpZiAoYnRuX2phY2sg
JiYgbW9kdWxlLT5idXR0b25fc3RhdHVzKSB7Ci0JCQlzbmRfc29jX2phY2tfcmVwb3J0KCZtb2R1
bGUtPmJ1dHRvbl9qYWNrLCAwLAotCQkJCQkgICAgbW9kdWxlLT5idXR0b25fbWFzayk7CisJCQlz
bmRfc29jX2phY2tfcmVwb3J0KGJ0biwgMCwgbW9kdWxlLT5idXR0b25fbWFzayk7CiAJCQltb2R1
bGUtPmJ1dHRvbl9zdGF0dXMgPSAwOwogCQl9Ci0JCXNuZF9zb2NfamFja19yZXBvcnQoJm1vZHVs
ZS0+aGVhZHNldF9qYWNrLCAwLAotCQkJCSAgICBtb2R1bGUtPmphY2tfbWFzayk7CisJCXNuZF9z
b2NfamFja19yZXBvcnQoaHMsIDAsIG1vZHVsZS0+amFja19tYXNrKTsKIAkJcmV0dXJuIDA7CiAJ
fQogCkBAIC02MSw3ICs2MSw3IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19yZXF1ZXN0X2phY2soc3Ry
dWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSwKIAkJCQkgICAgIG1vZHVsZS0+amFja190
eXBlLCByZXBvcnQpOwogCiAJbW9kdWxlLT5qYWNrX3R5cGUgPSByZXBvcnQ7Ci0Jc25kX3NvY19q
YWNrX3JlcG9ydCgmbW9kdWxlLT5oZWFkc2V0X2phY2ssIHJlcG9ydCwgbW9kdWxlLT5qYWNrX21h
c2spOworCXNuZF9zb2NfamFja19yZXBvcnQoaHMsIHJlcG9ydCwgbW9kdWxlLT5qYWNrX21hc2sp
OwogCiAJcmV0dXJuIDA7CiB9CkBAIC03MCw3ICs3MCw4IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19y
ZXF1ZXN0X2J1dHRvbihzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlLAogCQkJCSAg
c3RydWN0IGdiX2F1ZGlvX2J1dHRvbl9ldmVudF9yZXF1ZXN0ICpyZXEpCiB7CiAJaW50IHNvY19i
dXR0b25faWQsIHJlcG9ydDsKLQlzdHJ1Y3Qgc25kX2phY2sgKmJ0bl9qYWNrID0gbW9kdWxlLT5i
dXR0b25famFjay5qYWNrOworCXN0cnVjdCBzbmRfc29jX2phY2sgKmJ0biA9ICZtb2R1bGUtPmJ1
dHRvbi5qYWNrOworCXN0cnVjdCBzbmRfamFjayAqYnRuX2phY2sgPSBidG4tPmphY2s7CiAKIAlp
ZiAoIWJ0bl9qYWNrKSB7CiAJCWRldl9lcnJfcmF0ZWxpbWl0ZWQobW9kdWxlLT5kZXYsCkBAIC0x
MjQsNyArMTI1LDcgQEAgc3RhdGljIGludCBnYmF1ZGlvX3JlcXVlc3RfYnV0dG9uKHN0cnVjdCBn
YmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUsCiAKIAltb2R1bGUtPmJ1dHRvbl9zdGF0dXMgPSBy
ZXBvcnQ7CiAKLQlzbmRfc29jX2phY2tfcmVwb3J0KCZtb2R1bGUtPmJ1dHRvbl9qYWNrLCByZXBv
cnQsIG1vZHVsZS0+YnV0dG9uX21hc2spOworCXNuZF9zb2NfamFja19yZXBvcnQoYnRuLCByZXBv
cnQsIG1vZHVsZS0+YnV0dG9uX21hc2spOwogCiAJcmV0dXJuIDA7CiB9CkBAIC0yNTgsNiArMjU5
LDcgQEAgc3RhdGljIGludCBnYl9hdWRpb19wcm9iZShzdHJ1Y3QgZ2JfYnVuZGxlICpidW5kbGUs
CiAJSU5JVF9MSVNUX0hFQUQoJmdibW9kdWxlLT53aWRnZXRfbGlzdCk7CiAJSU5JVF9MSVNUX0hF
QUQoJmdibW9kdWxlLT5jdGxfbGlzdCk7CiAJSU5JVF9MSVNUX0hFQUQoJmdibW9kdWxlLT53aWRn
ZXRfY3RsX2xpc3QpOworCUlOSVRfTElTVF9IRUFEKCZnYm1vZHVsZS0+amFja19saXN0KTsKIAln
Ym1vZHVsZS0+ZGV2ID0gZGV2OwogCXNucHJpbnRmKGdibW9kdWxlLT5uYW1lLCBOQU1FX1NJWkUs
ICIlcy4lcyIsIGRldi0+ZHJpdmVyLT5uYW1lLAogCQkgZGV2X25hbWUoZGV2KSk7Ci0tIAoyLjcu
NAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZ3JleWJ1
cy1kZXYgbWFpbGluZyBsaXN0CmdyZXlidXMtZGV2QGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6Ly9s
aXN0cy5saW5hcm8ub3JnL21haWxtYW4vbGlzdGluZm8vZ3JleWJ1cy1kZXYK
