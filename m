Return-Path: <greybus-dev-bounces@lists.linaro.org>
X-Original-To: lists+greybus-dev@lfdr.de
Delivered-To: lists+greybus-dev@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 6F1C42007AF
	for <lists+greybus-dev@lfdr.de>; Fri, 19 Jun 2020 13:22:01 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 93932665BA
	for <lists+greybus-dev@lfdr.de>; Fri, 19 Jun 2020 11:22:00 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 889F3665BE; Fri, 19 Jun 2020 11:22:00 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,DKIM_ADSP_CUSTOM_MED,
	FREEMAIL_FROM,MAILING_LIST_MULTI,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H3,
	RCVD_IN_MSPIKE_WL,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 275CB665BF;
	Fri, 19 Jun 2020 11:21:20 +0000 (UTC)
X-Original-To: greybus-dev@lists.linaro.org
Delivered-To: greybus-dev@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 3BBE666597
 for <greybus-dev@lists.linaro.org>; Fri, 19 Jun 2020 11:21:15 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 27D5C6659D; Fri, 19 Jun 2020 11:21:15 +0000 (UTC)
Received: from mail-pl1-f194.google.com (mail-pl1-f194.google.com
 [209.85.214.194])
 by lists.linaro.org (Postfix) with ESMTPS id 0E5EF665AA
 for <greybus-dev@lists.linaro.org>; Fri, 19 Jun 2020 11:21:09 +0000 (UTC)
Received: by mail-pl1-f194.google.com with SMTP id y18so3818883plr.4
 for <greybus-dev@lists.linaro.org>; Fri, 19 Jun 2020 04:21:09 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=pYKrTComeg+Oo3Wy1rljPQJE8T9/luMNyxvEGNhHFi4=;
 b=b9/m3neMJESwnlLaf2zcV9FWAhS5dq05DFlg7H8KcnZ6BycBmTgdT5O+BuETdXmw/n
 u7J5bsglS7kZLnMShu642OD2Ho9aECrdvLnXTxxZtnAxc5k1mH3WhnjgSVfJwcxAK8S4
 7ptILL1Fgb89sBL9HWySDfKNGo1Gtavl+gl2s+vmqw/BgOsrUv9S/cksQuU3Oq/8bbfc
 63+tiOOVOGIkvDujL1bSg/0as8AvTt3oA0GdH+GVGFAs/1LFJDiRZZteH8P5ih0qZEY7
 Q80XUvaplhabaI9TnPSgL0Kq7eeheO7Ni+IyVXAd0y0uTdrxNiOVtey+s2c0VeTSX+VR
 yPxg==
X-Gm-Message-State: AOAM531RU2XX9awEamuqbVRdc3bHKP+6uU3zd1RdraN0/EQ27z2IIQlb
 KWiWA+fG5qdJKc92aM57bjY=
X-Google-Smtp-Source: ABdhPJxQZUF4bNloz6C+FNo6rVg1+l0UGfBzn6s9jUIck6yZDPPXzoUUz/e/pVwxLZ3PeLmC+nhemg==
X-Received: by 2002:a17:90a:de95:: with SMTP id
 n21mr3100494pjv.100.1592565668000; 
 Fri, 19 Jun 2020 04:21:08 -0700 (PDT)
Received: from cvds-vagarw7.iind.intel.com ([192.55.55.41])
 by smtp.googlemail.com with ESMTPSA id d9sm4974293pgg.74.2020.06.19.04.21.00
 (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);
 Fri, 19 Jun 2020 04:21:07 -0700 (PDT)
From: Vaibhav Agarwal <vaibhav.sr@gmail.com>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Alex Elder <elder@kernel.org>, Johan Hovold <johan@kernel.org>,
 Mark Greer <mgreer@animalcreek.com>
Date: Fri, 19 Jun 2020 16:50:22 +0530
Message-Id: <04735c1f53760c49012da0a42bcd7dee781c2eaf.1592537217.git.vaibhav.sr@gmail.com>
X-Mailer: git-send-email 2.26.2
In-Reply-To: <cover.1592537217.git.vaibhav.sr@gmail.com>
References: <cover.1592537217.git.vaibhav.sr@gmail.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: devel@driverdev.osuosl.org,
 Alexandre Belloni <alexandre.belloni@bootlin.com>,
 linux-kernel@vger.kernel.org, greybus-dev@lists.linaro.org,
 Dan Carpenter <dan.carpenter@oracle.com>
Subject: [greybus-dev] [PATCH v3 2/6] staging: greybus: audio: Maintain jack
	list within GB Audio module
X-BeenThere: greybus-dev@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: Greybus Development Mail List <greybus-dev.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/greybus-dev/>
List-Post: <mailto:greybus-dev@lists.linaro.org>
List-Help: <mailto:greybus-dev-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/greybus-dev>,
 <mailto:greybus-dev-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: greybus-dev-bounces@lists.linaro.org
Sender: "greybus-dev" <greybus-dev-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

QXMgcGVyIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIGZvciBHQiBjb2RlYyBkcml2ZXIsIGEg
amFjayBsaXN0IGlzCm1haW50YWluZWQgZm9yIGVhY2ggbW9kdWxlLiBBbmQgaXQgZXhwZWN0cyB0
aGUgbGlzdCB0byBiZSBwb3B1bGF0ZWQgYnkKdGhlIHNuZF9zb2NfamFjayBzdHJ1Y3R1cmUgd2hp
Y2ggd291bGQgcmVxdWlyZSBtb2RpZmljYXRpb25zIGluCm1haW5zdHJlYW0gY29kZS4KCkhvd2V2
ZXIsIHRoaXMgaXMgbm90IGEgbmVjZXNzYXJ5IHJlcXVpcmVtZW50IGFuZCB0aGUgbGlzdCBjYW4g
YmUgZWFzaWx5Cm1haW50YWluZWQgd2l0aGluIGdiYXVkaW9fbW9kdWxlX2luZm8gYXMgd2VsbC4g
VGhpcyBwYXRjaCBwcm92aWRlcyB0aGUKcmVsZXZhbnQgY2hhbmdlcyBmb3IgdGhlIHNhbWUuCgpT
aWduZWQtb2ZmLWJ5OiBWYWliaGF2IEFnYXJ3YWwgPHZhaWJoYXYuc3JAZ21haWwuY29tPgpSZXZp
ZXdlZC1ieTogRGFuIENhcnBlbnRlciA8ZGFuLmNhcnBlbnRlckBvcmFjbGUuY29tPgotLS0KIGRy
aXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMgIHwgNzQgKysrKysrKysrKysrKy0t
LS0tLS0tLS0tLS0KIGRyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmggIHwgMTAg
KysrLQogZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fbW9kdWxlLmMgfCAxNSArKystLS0K
IDMgZmlsZXMgY2hhbmdlZCwgNTMgaW5zZXJ0aW9ucygrKSwgNDYgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYyBiL2RyaXZlcnMv
c3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMKaW5kZXggNWQzYTVlNmE4ZmU2Li42ZGM0ZWUy
YmZiMzcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlvX2NvZGVjLmMK
KysrIGIvZHJpdmVycy9zdGFnaW5nL2dyZXlidXMvYXVkaW9fY29kZWMuYwpAQCAtNzEyLDYgKzcx
Miw3IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0IGdiYXVkaW9fbW9kdWxl
X2luZm8gKm1vZHVsZSwKIAkJCSAgICAgc3RydWN0IHNuZF9zb2NfY2FyZCAqY2FyZCkKIHsKIAlp
bnQgcmV0OworCXN0cnVjdCBnYmF1ZGlvX2phY2sgKmphY2ssICpuOwogCXN0cnVjdCBzbmRfc29j
X2phY2tfcGluICpoZWFkc2V0LCAqYnV0dG9uOwogCiAJaWYgKCFtb2R1bGUtPmphY2tfbWFzaykK
QEAgLTcyNiwxNCArNzI3LDE2IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0
IGdiYXVkaW9fbW9kdWxlX2luZm8gKm1vZHVsZSwKIAogCWhlYWRzZXQtPnBpbiA9IG1vZHVsZS0+
amFja19uYW1lOwogCWhlYWRzZXQtPm1hc2sgPSBtb2R1bGUtPmphY2tfbWFzazsKLQogCXJldCA9
IHNuZF9zb2NfY2FyZF9qYWNrX25ldyhjYXJkLCBtb2R1bGUtPmphY2tfbmFtZSwgbW9kdWxlLT5q
YWNrX21hc2ssCi0JCQkJICAgICZtb2R1bGUtPmhlYWRzZXRfamFjaywgaGVhZHNldCwgMSk7CisJ
CQkJICAgICZtb2R1bGUtPmhlYWRzZXQuamFjaywgaGVhZHNldCwgMSk7CiAJaWYgKHJldCkgewog
CQlkZXZfZXJyKG1vZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIGNyZWF0ZSBuZXcgamFja1xuIik7CiAJ
CXJldHVybiByZXQ7CiAJfQogCisJLyogQWRkIHRvIG1vZHVsZSdzIGphY2sgbGlzdCAqLworCWxp
c3RfYWRkKCZtb2R1bGUtPmhlYWRzZXQubGlzdCwgJm1vZHVsZS0+amFja19saXN0KTsKKwogCWlm
ICghbW9kdWxlLT5idXR0b25fbWFzaykKIAkJcmV0dXJuIDA7CiAKQEAgLTc0MiwyMCArNzQ1LDIy
IEBAIHN0YXRpYyBpbnQgZ2JhdWRpb19pbml0X2phY2soc3RydWN0IGdiYXVkaW9fbW9kdWxlX2lu
Zm8gKm1vZHVsZSwKIAlidXR0b24gPSBkZXZtX2t6YWxsb2MobW9kdWxlLT5kZXYsIHNpemVvZigq
YnV0dG9uKSwgR0ZQX0tFUk5FTCk7CiAJaWYgKCFidXR0b24pIHsKIAkJcmV0ID0gLUVOT01FTTsK
LQkJZ290byBmcmVlX2hlYWRzZXQ7CisJCWdvdG8gZnJlZV9qYWNrczsKIAl9CiAKIAlidXR0b24t
PnBpbiA9IG1vZHVsZS0+YnV0dG9uX25hbWU7CiAJYnV0dG9uLT5tYXNrID0gbW9kdWxlLT5idXR0
b25fbWFzazsKLQogCXJldCA9IHNuZF9zb2NfY2FyZF9qYWNrX25ldyhjYXJkLCBtb2R1bGUtPmJ1
dHRvbl9uYW1lLAotCQkJCSAgICBtb2R1bGUtPmJ1dHRvbl9tYXNrLCAmbW9kdWxlLT5idXR0b25f
amFjaywKKwkJCQkgICAgbW9kdWxlLT5idXR0b25fbWFzaywgJm1vZHVsZS0+YnV0dG9uLmphY2ss
CiAJCQkJICAgIGJ1dHRvbiwgMSk7CiAJaWYgKHJldCkgewogCQlkZXZfZXJyKG1vZHVsZS0+ZGV2
LCAiRmFpbGVkIHRvIGNyZWF0ZSBidXR0b24gamFja1xuIik7Ci0JCWdvdG8gZnJlZV9oZWFkc2V0
OworCQlnb3RvIGZyZWVfamFja3M7CiAJfQogCisJLyogQWRkIHRvIG1vZHVsZSdzIGphY2sgbGlz
dCAqLworCWxpc3RfYWRkKCZtb2R1bGUtPmJ1dHRvbi5saXN0LCAmbW9kdWxlLT5qYWNrX2xpc3Qp
OworCiAJLyoKIAkgKiBDdXJyZW50bHksIG1heCA0IGJ1dHRvbnMgYXJlIHN1cHBvcnRlZCB3aXRo
IGZvbGxvd2luZyBrZXkgbWFwcGluZwogCSAqIEJUTl8wID0gS0VZX01FRElBCkBAIC03NjUsNTYg
Kzc3MCw1NCBAQCBzdGF0aWMgaW50IGdiYXVkaW9faW5pdF9qYWNrKHN0cnVjdCBnYmF1ZGlvX21v
ZHVsZV9pbmZvICptb2R1bGUsCiAJICovCiAKIAlpZiAobW9kdWxlLT5idXR0b25fbWFzayAmIFNO
RF9KQUNLX0JUTl8wKSB7Ci0JCXJldCA9IHNuZF9qYWNrX3NldF9rZXkobW9kdWxlLT5idXR0b25f
amFjay5qYWNrLCBTTkRfSkFDS19CVE5fMCwKKwkJcmV0ID0gc25kX2phY2tfc2V0X2tleShtb2R1
bGUtPmJ1dHRvbi5qYWNrLmphY2ssIFNORF9KQUNLX0JUTl8wLAogCQkJCSAgICAgICBLRVlfTUVE
SUEpOwogCQlpZiAocmV0KSB7CiAJCQlkZXZfZXJyKG1vZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIHNl
dCBCVE5fMFxuIik7Ci0JCQlnb3RvIGZyZWVfYnV0dG9uOworCQkJZ290byBmcmVlX2phY2tzOwog
CQl9CiAJfQogCiAJaWYgKG1vZHVsZS0+YnV0dG9uX21hc2sgJiBTTkRfSkFDS19CVE5fMSkgewot
CQlyZXQgPSBzbmRfamFja19zZXRfa2V5KG1vZHVsZS0+YnV0dG9uX2phY2suamFjaywgU05EX0pB
Q0tfQlROXzEsCisJCXJldCA9IHNuZF9qYWNrX3NldF9rZXkobW9kdWxlLT5idXR0b24uamFjay5q
YWNrLCBTTkRfSkFDS19CVE5fMSwKIAkJCQkgICAgICAgS0VZX1ZPSUNFQ09NTUFORCk7CiAJCWlm
IChyZXQpIHsKIAkJCWRldl9lcnIobW9kdWxlLT5kZXYsICJGYWlsZWQgdG8gc2V0IEJUTl8xXG4i
KTsKLQkJCWdvdG8gZnJlZV9idXR0b247CisJCQlnb3RvIGZyZWVfamFja3M7CiAJCX0KIAl9CiAK
IAlpZiAobW9kdWxlLT5idXR0b25fbWFzayAmIFNORF9KQUNLX0JUTl8yKSB7Ci0JCXJldCA9IHNu
ZF9qYWNrX3NldF9rZXkobW9kdWxlLT5idXR0b25famFjay5qYWNrLCBTTkRfSkFDS19CVE5fMiwK
KwkJcmV0ID0gc25kX2phY2tfc2V0X2tleShtb2R1bGUtPmJ1dHRvbi5qYWNrLmphY2ssIFNORF9K
QUNLX0JUTl8yLAogCQkJCSAgICAgICBLRVlfVk9MVU1FVVApOwogCQlpZiAocmV0KSB7CiAJCQlk
ZXZfZXJyKG1vZHVsZS0+ZGV2LCAiRmFpbGVkIHRvIHNldCBCVE5fMlxuIik7Ci0JCQlnb3RvIGZy
ZWVfYnV0dG9uOworCQkJZ290byBmcmVlX2phY2tzOwogCQl9CiAJfQogCiAJaWYgKG1vZHVsZS0+
YnV0dG9uX21hc2sgJiBTTkRfSkFDS19CVE5fMykgewotCQlyZXQgPSBzbmRfamFja19zZXRfa2V5
KG1vZHVsZS0+YnV0dG9uX2phY2suamFjaywgU05EX0pBQ0tfQlROXzMsCisJCXJldCA9IHNuZF9q
YWNrX3NldF9rZXkobW9kdWxlLT5idXR0b24uamFjay5qYWNrLCBTTkRfSkFDS19CVE5fMywKIAkJ
CQkgICAgICAgS0VZX1ZPTFVNRURPV04pOwogCQlpZiAocmV0KSB7CiAJCQlkZXZfZXJyKG1vZHVs
ZS0+ZGV2LCAiRmFpbGVkIHRvIHNldCBCVE5fMFxuIik7Ci0JCQlnb3RvIGZyZWVfYnV0dG9uOwor
CQkJZ290byBmcmVlX2phY2tzOwogCQl9CiAJfQogCiAJLyogRklYTUUKIAkgKiB2ZXJpZnkgaWYg
dGhpcyBpcyByZWFsbHkgcmVxdWlyZWQKIAlzZXRfYml0KElOUFVUX1BST1BfTk9fRFVNTVlfUkVM
RUFTRSwKLQkJbW9kdWxlLT5idXR0b25famFjay5qYWNrLT5pbnB1dF9kZXYtPnByb3BiaXQpOwor
CQltb2R1bGUtPmJ1dHRvbi5qYWNrLmphY2stPmlucHV0X2Rldi0+cHJvcGJpdCk7CiAJKi8KIAog
CXJldHVybiAwOwogCi1mcmVlX2J1dHRvbjoKLQlzbmRfZGV2aWNlX2ZyZWUoY2FyZC0+c25kX2Nh
cmQsIG1vZHVsZS0+YnV0dG9uX2phY2suamFjayk7Ci0JbGlzdF9kZWwoJm1vZHVsZS0+YnV0dG9u
X2phY2subGlzdCk7Ci0KLWZyZWVfaGVhZHNldDoKLQlzbmRfZGV2aWNlX2ZyZWUoY2FyZC0+c25k
X2NhcmQsIG1vZHVsZS0+aGVhZHNldF9qYWNrLmphY2spOwotCWxpc3RfZGVsKCZtb2R1bGUtPmhl
YWRzZXRfamFjay5saXN0KTsKK2ZyZWVfamFja3M6CisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZl
KGphY2ssIG4sICZtb2R1bGUtPmphY2tfbGlzdCwgbGlzdCkgeworCQlzbmRfZGV2aWNlX2ZyZWUo
Y2FyZC0+c25kX2NhcmQsIGphY2stPmphY2suamFjayk7CisJCWxpc3RfZGVsKCZqYWNrLT5saXN0
KTsKKwl9CiAKIAlyZXR1cm4gcmV0OwogfQpAQCAtODI0LDcgKzgyNyw3IEBAIGludCBnYmF1ZGlv
X3JlZ2lzdGVyX21vZHVsZShzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlKQogCWlu
dCByZXQ7CiAJc3RydWN0IHNuZF9zb2NfY29kZWMgKmNvZGVjOwogCXN0cnVjdCBzbmRfY2FyZCAq
Y2FyZDsKLQlzdHJ1Y3Qgc25kX3NvY19qYWNrICpqYWNrID0gTlVMTDsKKwlzdHJ1Y3QgZ2JhdWRp
b19qYWNrICpqYWNrID0gTlVMTDsKIAogCWlmICghZ2Jjb2RlYykgewogCQlkZXZfZXJyKG1vZHVs
ZS0+ZGV2LCAiR0IgQ29kZWMgbm90IHlldCBwcm9iZWRcbiIpOwpAQCAtODY5LDExICs4NzIsOSBA
QCBpbnQgZ2JhdWRpb19yZWdpc3Rlcl9tb2R1bGUoc3RydWN0IGdiYXVkaW9fbW9kdWxlX2luZm8g
Km1vZHVsZSkKIAkJICogcmVnaXN0ZXIgamFjayBkZXZpY2VzIGZvciB0aGlzIG1vZHVsZQogCQkg
KiBmcm9tIGNvZGVjLT5qYWNrX2xpc3QKIAkJICovCi0JCWxpc3RfZm9yX2VhY2hfZW50cnkoamFj
aywgJmNvZGVjLT5qYWNrX2xpc3QsIGxpc3QpIHsKLQkJCWlmICgoamFjayA9PSAmbW9kdWxlLT5o
ZWFkc2V0X2phY2spIHx8Ci0JCQkgICAgKGphY2sgPT0gJm1vZHVsZS0+YnV0dG9uX2phY2spKQot
CQkJCXNuZF9kZXZpY2VfcmVnaXN0ZXIoY29kZWMtPmNhcmQtPnNuZF9jYXJkLAotCQkJCQkJICAg
IGphY2stPmphY2spOworCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KGphY2ssICZtb2R1bGUtPmphY2tf
bGlzdCwgbGlzdCkgeworCQkJc25kX2RldmljZV9yZWdpc3Rlcihjb2RlYy0+Y2FyZC0+c25kX2Nh
cmQsCisJCQkJCSAgICBqYWNrLT5qYWNrLmphY2spOwogCQl9CiAjZW5kaWYKIAl9CkBAIC05NTcs
NyArOTU4LDcgQEAgdm9pZCBnYmF1ZGlvX3VucmVnaXN0ZXJfbW9kdWxlKHN0cnVjdCBnYmF1ZGlv
X21vZHVsZV9pbmZvICptb2R1bGUpCiB7CiAJc3RydWN0IHNuZF9zb2NfY29kZWMgKmNvZGVjID0g
Z2Jjb2RlYy0+Y29kZWM7CiAJc3RydWN0IHNuZF9jYXJkICpjYXJkID0gY29kZWMtPmNhcmQtPnNu
ZF9jYXJkOwotCXN0cnVjdCBzbmRfc29jX2phY2sgKmphY2ssICpuZXh0X2o7CisJc3RydWN0IGdi
YXVkaW9famFjayAqamFjaywgKm47CiAJaW50IG1hc2s7CiAKIAlkZXZfZGJnKGNvZGVjLT5kZXYs
ICJVbnJlZ2lzdGVyICVzIG1vZHVsZVxuIiwgbW9kdWxlLT5uYW1lKTsKQEAgLTk3MCwyMCArOTcx
LDE5IEBAIHZvaWQgZ2JhdWRpb191bnJlZ2lzdGVyX21vZHVsZShzdHJ1Y3QgZ2JhdWRpb19tb2R1
bGVfaW5mbyAqbW9kdWxlKQogCW11dGV4X3VubG9jaygmZ2Jjb2RlYy0+bG9jayk7CiAKICNpZmRl
ZiBDT05GSUdfU05EX0pBQ0sKLQkvKiBmcmVlIGphY2sgZGV2aWNlcyBmb3IgdGhpcyBtb2R1bGUg
ZnJvbSBjb2RlYy0+amFja19saXN0ICovCi0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGphY2ss
IG5leHRfaiwgJmNvbXBvbmVudC0+Y2FyZC0+amFja19saXN0LAotCQkJCSBsaXN0KSB7Ci0JCWlm
IChqYWNrID09ICZtb2R1bGUtPmhlYWRzZXRfamFjaykKKwkvKiBmcmVlIGphY2sgZGV2aWNlcyBm
b3IgdGhpcyBtb2R1bGUgamFja19saXN0ICovCisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGph
Y2ssIG4sICZtb2R1bGUtPmphY2tfbGlzdCwgbGlzdCkgeworCQlpZiAoamFjayA9PSAmbW9kdWxl
LT5oZWFkc2V0KQogCQkJbWFzayA9IEdCQ09ERUNfSkFDS19NQVNLOwotCQllbHNlIGlmIChqYWNr
ID09ICZtb2R1bGUtPmJ1dHRvbl9qYWNrKQorCQllbHNlIGlmIChqYWNrID09ICZtb2R1bGUtPmJ1
dHRvbikKIAkJCW1hc2sgPSBHQkNPREVDX0pBQ0tfQlVUVE9OX01BU0s7CiAJCWVsc2UKIAkJCW1h
c2sgPSAwOwogCQlpZiAobWFzaykgewogCQkJZGV2X2RiZyhtb2R1bGUtPmRldiwgIlJlcG9ydCAl
cyByZW1vdmFsXG4iLAotCQkJCWphY2stPmphY2stPmlkKTsKLQkJCXNuZF9zb2NfamFja19yZXBv
cnQoamFjaywgMCwgbWFzayk7Ci0JCQlzbmRfZGV2aWNlX2ZyZWUoY29kZWMtPmNhcmQtPnNuZF9j
YXJkLCBqYWNrLT5qYWNrKTsKKwkJCQlqYWNrLT5qYWNrLmphY2stPmlkKTsKKwkJCXNuZF9zb2Nf
amFja19yZXBvcnQoJmphY2stPmphY2ssIDAsIG1hc2spOworCQkJc25kX2RldmljZV9mcmVlKGNv
ZGVjLT5jYXJkLT5zbmRfY2FyZCwgamFjay0+amFjay5qYWNrKTsKIAkJCWxpc3RfZGVsKCZqYWNr
LT5saXN0KTsKIAkJfQogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1
ZGlvX2NvZGVjLmggYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19jb2RlYy5oCmluZGV4
IGNiNWQyNzFkYTFhNS4uYWY5MTk1ZWNlYjNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL3N0YWdpbmcv
Z3JleWJ1cy9hdWRpb19jb2RlYy5oCisrKyBiL2RyaXZlcnMvc3RhZ2luZy9ncmV5YnVzL2F1ZGlv
X2NvZGVjLmgKQEAgLTEwNiw2ICsxMDYsMTEgQEAgZW51bSBnYmF1ZGlvX21vZHVsZV9zdGF0ZSB7
CiAJR0JBVURJT19NT0RVTEVfT04sCiB9OwogCitzdHJ1Y3QgZ2JhdWRpb19qYWNrIHsKKwlzdHJ1
Y3Qgc25kX3NvY19qYWNrIGphY2s7CisJc3RydWN0IGxpc3RfaGVhZCBsaXN0OworfTsKKwogc3Ry
dWN0IGdiYXVkaW9fbW9kdWxlX2luZm8gewogCS8qIG1vZHVsZSBpbmZvICovCiAJc3RydWN0IGRl
dmljZSAqZGV2OwpAQCAtMTMwLDggKzEzNSw4IEBAIHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZv
IHsKIAlpbnQgamFja19tYXNrOwogCWludCBidXR0b25fbWFzazsKIAlpbnQgYnV0dG9uX3N0YXR1
czsKLQlzdHJ1Y3Qgc25kX3NvY19qYWNrIGhlYWRzZXRfamFjazsKLQlzdHJ1Y3Qgc25kX3NvY19q
YWNrIGJ1dHRvbl9qYWNrOworCXN0cnVjdCBnYmF1ZGlvX2phY2sgaGVhZHNldDsKKwlzdHJ1Y3Qg
Z2JhdWRpb19qYWNrIGJ1dHRvbjsKIAogCS8qIGNvbm5lY3Rpb24gaW5mbyAqLwogCXN0cnVjdCBn
Yl9jb25uZWN0aW9uICptZ210X2Nvbm5lY3Rpb247CkBAIC0xNTUsNiArMTYwLDcgQEAgc3RydWN0
IGdiYXVkaW9fbW9kdWxlX2luZm8gewogCXN0cnVjdCBsaXN0X2hlYWQgd2lkZ2V0X2xpc3Q7CiAJ
c3RydWN0IGxpc3RfaGVhZCBjdGxfbGlzdDsKIAlzdHJ1Y3QgbGlzdF9oZWFkIHdpZGdldF9jdGxf
bGlzdDsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGphY2tfbGlzdDsKIAogCXN0cnVjdCBnYl9hdWRpb190
b3BvbG9neSAqdG9wb2xvZ3k7CiB9OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9zdGFnaW5nL2dyZXli
dXMvYXVkaW9fbW9kdWxlLmMgYi9kcml2ZXJzL3N0YWdpbmcvZ3JleWJ1cy9hdWRpb19tb2R1bGUu
YwppbmRleCAzMDBhMmI0ZjNmYzcuLjE2ZjYwMjU2YWRiMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9z
dGFnaW5nL2dyZXlidXMvYXVkaW9fbW9kdWxlLmMKKysrIGIvZHJpdmVycy9zdGFnaW5nL2dyZXli
dXMvYXVkaW9fbW9kdWxlLmMKQEAgLTIxLDggKzIxLDggQEAgc3RhdGljIGludCBnYmF1ZGlvX3Jl
cXVlc3RfamFjayhzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlLAogCQkJCXN0cnVj
dCBnYl9hdWRpb19qYWNrX2V2ZW50X3JlcXVlc3QgKnJlcSkKIHsKIAlpbnQgcmVwb3J0OwotCXN0
cnVjdCBzbmRfamFjayAqamFjayA9IG1vZHVsZS0+aGVhZHNldF9qYWNrLmphY2s7Ci0Jc3RydWN0
IHNuZF9qYWNrICpidG5famFjayA9IG1vZHVsZS0+YnV0dG9uX2phY2suamFjazsKKwlzdHJ1Y3Qg
c25kX2phY2sgKmphY2sgPSBtb2R1bGUtPmhlYWRzZXQuamFjay5qYWNrOworCXN0cnVjdCBzbmRf
amFjayAqYnRuX2phY2sgPSBtb2R1bGUtPmJ1dHRvbi5qYWNrLmphY2s7CiAKIAlpZiAoIWphY2sp
IHsKIAkJZGV2X2Vycl9yYXRlbGltaXRlZChtb2R1bGUtPmRldiwKQEAgLTM4LDExICszOCwxMSBA
QCBzdGF0aWMgaW50IGdiYXVkaW9fcmVxdWVzdF9qYWNrKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9p
bmZvICptb2R1bGUsCiAJaWYgKHJlcS0+ZXZlbnQgPT0gR0JfQVVESU9fSkFDS19FVkVOVF9SRU1P
VkFMKSB7CiAJCW1vZHVsZS0+amFja190eXBlID0gMDsKIAkJaWYgKGJ0bl9qYWNrICYmIG1vZHVs
ZS0+YnV0dG9uX3N0YXR1cykgewotCQkJc25kX3NvY19qYWNrX3JlcG9ydCgmbW9kdWxlLT5idXR0
b25famFjaywgMCwKKwkJCXNuZF9zb2NfamFja19yZXBvcnQoJm1vZHVsZS0+YnV0dG9uLmphY2ss
IDAsCiAJCQkJCSAgICBtb2R1bGUtPmJ1dHRvbl9tYXNrKTsKIAkJCW1vZHVsZS0+YnV0dG9uX3N0
YXR1cyA9IDA7CiAJCX0KLQkJc25kX3NvY19qYWNrX3JlcG9ydCgmbW9kdWxlLT5oZWFkc2V0X2ph
Y2ssIDAsCisJCXNuZF9zb2NfamFja19yZXBvcnQoJm1vZHVsZS0+aGVhZHNldC5qYWNrLCAwLAog
CQkJCSAgICBtb2R1bGUtPmphY2tfbWFzayk7CiAJCXJldHVybiAwOwogCX0KQEAgLTYxLDcgKzYx
LDcgQEAgc3RhdGljIGludCBnYmF1ZGlvX3JlcXVlc3RfamFjayhzdHJ1Y3QgZ2JhdWRpb19tb2R1
bGVfaW5mbyAqbW9kdWxlLAogCQkJCSAgICAgbW9kdWxlLT5qYWNrX3R5cGUsIHJlcG9ydCk7CiAK
IAltb2R1bGUtPmphY2tfdHlwZSA9IHJlcG9ydDsKLQlzbmRfc29jX2phY2tfcmVwb3J0KCZtb2R1
bGUtPmhlYWRzZXRfamFjaywgcmVwb3J0LCBtb2R1bGUtPmphY2tfbWFzayk7CisJc25kX3NvY19q
YWNrX3JlcG9ydCgmbW9kdWxlLT5oZWFkc2V0LmphY2ssIHJlcG9ydCwgbW9kdWxlLT5qYWNrX21h
c2spOwogCiAJcmV0dXJuIDA7CiB9CkBAIC03MCw3ICs3MCw3IEBAIHN0YXRpYyBpbnQgZ2JhdWRp
b19yZXF1ZXN0X2J1dHRvbihzdHJ1Y3QgZ2JhdWRpb19tb2R1bGVfaW5mbyAqbW9kdWxlLAogCQkJ
CSAgc3RydWN0IGdiX2F1ZGlvX2J1dHRvbl9ldmVudF9yZXF1ZXN0ICpyZXEpCiB7CiAJaW50IHNv
Y19idXR0b25faWQsIHJlcG9ydDsKLQlzdHJ1Y3Qgc25kX2phY2sgKmJ0bl9qYWNrID0gbW9kdWxl
LT5idXR0b25famFjay5qYWNrOworCXN0cnVjdCBzbmRfamFjayAqYnRuX2phY2sgPSBtb2R1bGUt
PmJ1dHRvbi5qYWNrLmphY2s7CiAKIAlpZiAoIWJ0bl9qYWNrKSB7CiAJCWRldl9lcnJfcmF0ZWxp
bWl0ZWQobW9kdWxlLT5kZXYsCkBAIC0xMjQsNyArMTI0LDcgQEAgc3RhdGljIGludCBnYmF1ZGlv
X3JlcXVlc3RfYnV0dG9uKHN0cnVjdCBnYmF1ZGlvX21vZHVsZV9pbmZvICptb2R1bGUsCiAKIAlt
b2R1bGUtPmJ1dHRvbl9zdGF0dXMgPSByZXBvcnQ7CiAKLQlzbmRfc29jX2phY2tfcmVwb3J0KCZt
b2R1bGUtPmJ1dHRvbl9qYWNrLCByZXBvcnQsIG1vZHVsZS0+YnV0dG9uX21hc2spOworCXNuZF9z
b2NfamFja19yZXBvcnQoJm1vZHVsZS0+YnV0dG9uLmphY2ssIHJlcG9ydCwgbW9kdWxlLT5idXR0
b25fbWFzayk7CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTI1OCw2ICsyNTgsNyBAQCBzdGF0aWMgaW50
IGdiX2F1ZGlvX3Byb2JlKHN0cnVjdCBnYl9idW5kbGUgKmJ1bmRsZSwKIAlJTklUX0xJU1RfSEVB
RCgmZ2Jtb2R1bGUtPndpZGdldF9saXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmZ2Jtb2R1bGUtPmN0
bF9saXN0KTsKIAlJTklUX0xJU1RfSEVBRCgmZ2Jtb2R1bGUtPndpZGdldF9jdGxfbGlzdCk7CisJ
SU5JVF9MSVNUX0hFQUQoJmdibW9kdWxlLT5qYWNrX2xpc3QpOwogCWdibW9kdWxlLT5kZXYgPSBk
ZXY7CiAJc25wcmludGYoZ2Jtb2R1bGUtPm5hbWUsIE5BTUVfU0laRSwgIiVzLiVzIiwgZGV2LT5k
cml2ZXItPm5hbWUsCiAJCSBkZXZfbmFtZShkZXYpKTsKLS0gCjIuMjYuMgoKX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KZ3JleWJ1cy1kZXYgbWFpbGluZyBs
aXN0CmdyZXlidXMtZGV2QGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6Ly9saXN0cy5saW5hcm8ub3Jn
L21haWxtYW4vbGlzdGluZm8vZ3JleWJ1cy1kZXYK
